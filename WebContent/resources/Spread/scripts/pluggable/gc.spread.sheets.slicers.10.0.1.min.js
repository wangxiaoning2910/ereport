/*!
 * 
 * Spread.Sheets Library 10.0.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/spreadjs/eula/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Slicers=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){var d=c(1);c(8),d.SR={},d.SR.en=c(9),a.exports=d},function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb=c(2),gb=c(3),hb=c(4),ib=c(5),jb=c(6),kb=c(7),lb=gb.D,mb={},nb=function(){return gb.C(mb.SR)()},ob=gb.k,pb=fb.GC$,qb=fb.To,rb=fb.Commands,sb=fb.Ul.Nl,tb=fb.Ul.Pl,ub=fb.Ul.Ol,vb=ob.ac,wb=pb.extend,xb=document,yb=void 0,zb=null,Ab="normal 11pt calibri",Bb=parseFloat;wb(fb.Worksheet.prototype,{t4:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(e===yb&&(e=3),f=this,g=f.tables)for(h=0;h<c;h++)for(i=0;i<d;i++)j=h+a,k=i+b,l=g.find(j,k),3===e&&l&&l.Aq()&&(m=l.dataRange(),m.contains(j,k)&&(n=l.getSlicerData(),n&&n.onDataChanged([{columnName:l.getColumnName(k-m.col),row:j-m.row,data:{value:f.getValue(j,k),text:f.getText(j,k)}}])))}}),d={priority:900,init:function(){var a=this;a.slicers=new db(a)},setHost:function(){var a=this;a.bind("tableRemoved",function(b,c){var d,e,f,g=c.tables;for(d=0;d<vb(g);d++)e=a.slicers,f=Nc(e,g[d].name()),f&&Mc(e,f)})},toJson:function(a){var b=this.slicers.toJSON();b.length>0&&(a.slicers=b)},fromJson:function(a){a&&a.slicers&&this.slicers.fromJSON(a.slicers)},preProcessMouseWheel:function(a){var b=this.slicers;b&&b.W3(a.e)&&(a.r=!0)}},fb.Worksheet.$n("slicer",d),e=function(a){var b="unfilterSlicerByKey",c="filterSlicer",d="unfilterSlicer",e="changeSlicerProperty";a.register(b,rb[b],67,!1,!1,!0,!1),a.register(c,rb[c]),a.register(d,rb[d]),a.register(e,rb[e])},f={init:function(){e(this.commandManager())}},fb.Workbook.$n("slicer",f),g="name",h="style",i="Style",j="light",k="dark",l="white",m="black",n="solid",o="color",p="Color",q="background-color",r="width",s="Width",t="height",u="font",v="setBorders",w="back"+p,x="fore"+p,y="border",z=y+"Width",A=y+i,B=y+p,C=y+"Left",D=y+"Top",E=y+"Right",F=y+"Bottom",G="textDecoration",H="WithData"+i,I="WithNoData"+i,J="electedItem",K="hovered",L="wholeSlicer"+i,M="header"+i,N="s"+J+H,O="s"+J+I,P="unS"+J+H,Q="unS"+J+I,R=K+"S"+J+H,S=K+"S"+J+I,T=K+"UnS"+J+H,U=K+"UnS"+J+I,V="div",W="px",X="default",Y="cursor",Z="position",$="absolute",_="padding",aa="top",ba="margin-"+aa,ca="left",da="right",ea="text-align",fa="overflow",ga="hidden",ha="auto",ia="text-overflow",ja="ellipsis",ka="white-space",la="nowrap",ma="unselectable",na="on",oa="font-weight",pa="font-size",qa="border-radius",ra="box-sizing",sa="content-box",ta="button",ua="\u2717",va="mark",wa="itemValue",xa="Accent ",ya="Slicer"+i,za="#999999",Aa="#828282",Ba="#CCCCCC",Ca="gc-slicer-",Da="container",Ea=Ca+Da,Fa="header",Ga=Ca+Fa,Ha=Ca+"header-borderDiv",Ia=Ca+"caption",Ja="clearfilter",Ka=Ca+Ja,La="body",Ma=Ca+La,Na=Ca+"table",Oa=Ca+"tr",Pa=Ca+"td1",Qa=Ca+"td2",Ra="itemscontainer",Sa=Ca+Ra,Ta="item",Ua=Ca+Ta,Va="gc-no-user-select",Wa=function(){var a,b,c,d=[w,x,u,C,D,E,F,G];function e(a,b,c,e,f,g,h,i){for(var j=0,k=vb(d);j<k;j++)this[d[j]](arguments[j])}for(a={constructor:e,setBorders:function(a){var b=this;b[C](a)[D](a)[E](a)[F](a)},fromJSON:function(a){if(a&&!pb.isEmptyObject(a)){var b=this;d.forEach(function(c){var d,e=a[c];ub(e)&&(c.indexOf(y)>=0?(d=Db(),d.fromJSON(e),b[c](d,!1)):b[c](e,!1))})}},toJSON:function(){var a=this,b={};return d.forEach(function(c){var d=a[c]();a[c].isDefault(d)||(b[c]=d&&d.toJSON?d.toJSON():d)}),b}},b=0,c=vb(d);b<c;b++)a[d[b]]=tb(d[b]);return e.prototype=a,e}();function Cb(a){var b,c;return a&&0!==vb(a)?0===a.indexOf(j)?(c=parseInt(a.replace(j,"")),b=$a[j+c]()):0===a.indexOf(k)?(c=parseInt(a.replace(k,"")),b=$a[k+c]()):$a[a]&&(b=$a[a]()):b=new Wa,b}Xa=function(){var a,b,c,d=[z,A,B],e=vb(d);function f(a,b,c){for(var f=0;f<e;f++)this[d[f]](arguments[f])}for(a=function(a,b,c){return tb(a,b,c,function(b){var c=typeof b;return a===z?"number"===c&&b>=0:"string"===c})},b={constructor:f,fromJSON:function(a){var b,c;if(a&&!pb.isEmptyObject(a))for(b=0;b<e;b++)c=d[b],ub(a[c])&&this[c](a[c],!1)},toJSON:function(){var a,b,c,f={};for(a=0;a<e;a++)f[d[a]]=this[d[a]]();b={};for(c in f)f[c]!==yb&&f[c]!==zb&&(b[c]=f[c]);return b}},c=0;c<e;c++)b[d[c]]=a(d[c],yb,yb);return f.prototype=b,f}();function Db(a,b,c){return new Xa(a,b,c)}function Eb(){var a=new Xa(0,"",""),b=new Wa(l,m,Ab);return b.setBorders(a),b}function Fb(a){var b,c=17,d=16,e="Slicer"+i;return a.indexOf(e+"Light")>-1&&vb(a)===c&&(b=parseInt(a[c-1])),a.indexOf(e+"Dark")>-1&&vb(a)===d&&(b=parseInt(a[d-1])),b>=1&&b<=6}Ya=function(){var a,b,c,d;function e(a,b,c,d){return tb(a,b,c,d)}function f(){var a=this;a[g](""),a[L](Eb(),!1)}for(a=[g,L,M,N,O,P,Q,R,S,T,U],b={constructor:f,name:e(g,""),fromJSON:function(b){var c,d,e,f;if(b&&!pb.isEmptyObject(b))return c=this,d=b.name,ub(d)&&(c.name(d,!1),Fb(d))?(e=d.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),f=Cb(e),void a.forEach(function(a){c[a](f[a](),!1)})):void a.forEach(function(a){var d,e=b[a];a!==g&&ub(e)&&(d=Cb(),d.fromJSON(e),c[a](d,!1))})},toJSON:function(){var a,b,c,d=this;a=Fb(d.name())?{name:d.name()}:d.toJSONInternal(),b={};for(c in a)a[c]===zb||a[c]===yb||fb.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},toJSONInternal:function(){var b,c,d,e=this,f={},h="toJSON";for(f[g]=e.name(),b=1,c=vb(a);b<c;b++)d=a[b],f[d]=e[d]()?e[d]()[h]():zb;return f}},c=1,d=vb(a);c<d;c++)b[a[c]]=e(a[c]);return f.prototype=b,f}();function Gb(){return new Ya}Za=function(a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,x,y,z){var A,B,G=Gb(),H=ya+a+b;return G[g](H),A=Cb(),A[u](c)[w](d)[v](e),G[L](A),B=Cb(),B[C](f)[D](f)[E](f)[F](h),G[M](B),G[N](Ib(i,j,k)),G[O](Ib(l,m,n)),G[P](Ib(o,p,q)),G[Q](Ib(r,s,t)),Hb(G,Ib(x,y,z)),G};function Hb(a,b){a[R](b)[S](b)[T](b)[U](b)}function Ib(a,b,c){var d=Cb();return d[x](a)[w](b)[v](c),d}function Jb(a){var b=xa+a;return Za("Light",a,Ab,l,Db(1,n,b),Db(0,"",""),Db(1,n,b),m,b+",Lighter 60%",Db(1,n,za),Aa,b+",Lighter 80%",Db(1,n,Ba),m,l,Db(1,n,Ba),Aa,l,Db(1,n,"#E0E0E0"),m,"#F9E36F",Db(1,n,za))}function Kb(a){var b=xa+a;return Za("Dark",a,Ab,l,Db(1,n,b),Db(0,"",""),Db(1,n,b),l,b,Db(1,n,b),b+",Darker 25%",b+",Lighter 60%",Db(1,n,b+",Lighter 60%"),m,"#C0C0C0",Db(1,n,"#C0C0C0"),"#959595","#DFDFDF",Db(1,n,"#DFDFDF"),m,"#F9E36F",Db(1,n,za))}$a=function(){function a(){}for(var b=1;b<=6;b++)a["light"+b]=function(a){var b=a;return function(){return Jb(b)}}(b),a["dark"+b]=function(a){var b=a;return function(){return Kb(b)}}(b);return a.other1=function(){return Za("Other",1,Ab,l,Db(1,n,"#808080"),Db(0,"",""),Db(1,n,"#A6A6A6"),m,"#BFBFBF",Db(1,n,za),m,"#D9D9D9",Db(1,n,Ba),m,l,Db(1,n,Ba),"#959595",l,Db(1,n,"#E0E0E0"),m,"#F9E36F",Db(1,n,za))},a.other2=function(){return Za("Other",2,Ab,l,Db(1,n,"#4F81BD"),Db(0,"",""),Db(1,n,"#4F81BD"),m,"#A9C1E3",Db(1,n,za),Aa,"#D5E2F6",Db(1,n,Ba),m,l,Db(1,n,Ba),Aa,l,Db(1,n,"#E0E0E0"),m,"#F9E36F",Db(1,n,za))},a}();function Lb(a,b){var c,d,e,f,g,i,j=a.KW,k=a._caption,l=Pb(a.slicerData),m=a.zoomFactor();if(b){b[L]&&(Rb(a.xo,b[L],l,k,m),oc(a,Da)),c=a.LW,d=Nb(b[L],b[M]),Sb(b)?(e=d[F],f=e&&e[z]||0,c[h][t]=(a.MW-f)*Tb(b)*m+W,Qb(c,e,l,F),d[C]=d[D]=d[E]=d[F]=zb):(c[h][F+r]=0+W,c[h][t]=j[h][t]),Rb(j,d,l,k,m),oc(a,Fa);for(g in a.NW)lb(a.NW,g)&&(i=parseInt(g),lc(a,i))}}function Mb(a,b,c){var d,e,f={};if(b&&c&&vb(b)===vb(c)){for(d=0,e=vb(b);d<e;d++)f[b[d]]=c[d];pb(a).css(f)}}function Nb(a,b){var c={},d;if(b)for(d in b)lb(b,d)&&(c[d]=b[d]);if(a)for(d in a)c[d]===yb&&a[d]!==yb&&(c[d]=a[d]);return c}function Ob(a,b){if(!b)return a;var c;return a&&b&&b.getColor&&(c=b.getColor(a)),c}function Pb(a){var b=a&&a.OW&&a.OW();return b&&b.currentTheme()}function Qb(a,b,c,d){if(a){var e=b&&b[z]||0,f=b&&b[A]||"",g=b&&b[B]||"";a[h][d+s]=e+W,a[h][d+i]=f,a[h][d+p]=Ob(g,c)}}function Rb(a,b,c,d,e){var f,g,i,j;a&&b&&(f=b[x]||m,g=b[w]||l,i=b[u]||Ab,a[h][q]=Ob(g,c),a[h][o]=Ob(f,c),a[h][u]=qb.No(i,e)[u],Qb(a,b[C],c,C),Qb(a,b[D],c,D),Qb(a,b[E],c,E),Qb(a,b[F],c,F),j=qb.So(b[G]),gb.u.Bb(a.className,Ga)?d[h][G]=j:gb.u.Bb(a.className,Ua)&&(a[h][G]=j))}function Sb(a){var b,c=a[M];return!c||!(c[C]||c[D]||c[E]||c[E])||(b=Nb(a[L],c),!(!(b[F]&&b[F][z]>0)||b[C]&&0!==b[C][z]||b[D]&&0!==b[D][z]||b[E]&&0!==b[E][z]))}function Tb(a){var b,c,d,e,f,g,h,i,j;return a?(b=Nb(a[L],a[M]),b&&b[u]?(c=b[u],d=1,e=qb.Ko,f=qb.Jo,g=e(f(Ab)).fontSize,h=e(f(c)).fontSize,g&&h&&(i=Bb(g),j=Bb(h),isNaN(j)||(d=j/i)),d):1):1}function Ub(a){var b,c,d,e,f,g=0,i=0;return a&&(b=a[h],c=b[C+s],d=b[D+s],e=b[E+s],f=b[F+s],c&&(g+=Bb(c)),d&&(i+=Bb(d)),e&&(g+=Bb(e)),f&&(i+=Bb(f))),{widthOffset:g,heightOffset:i}}function Vb(a){var b,c,d=[];if(a)for(c=0;c<vb(a);c++)b=a[c]===yb||a[c]===zb||""===a[c]?nb().Blank:a[c]+"",d.push(b);return d}function Wb(a){var b=sb(V);return Mb(b,[Z,_,ra,fa],[$,6*a.zoomFactor(),sa,ga]),pb(b).addClass(Ea),oc(a,Da),pb(b).append(Xb(a)).append(Yb(a)),b}function Xb(a){var b,c,d,e,f,g,h,i,j=sb(V),k=sb(V),l=sb("span"),m=sb(V),n=a.zoomFactor(),o=a.style();return Mb(j,[r,Z,aa,ca,da,ra,fa],[ha,$,0,0,0,sa,ga]),pb(j).addClass(Ga),a.KW=j,b=a.PW*n,Mb(k,[r,Z,ca,da,ra,fa],[ha,$,b,b,sa,ga]),pb(k).addClass(Ha),a.LW=k,pb(j).append(k),c=a.QW*Tb(o)*n,d=_b(a)*n,Mb(l,[ra,Z,aa,fa,r,ia,ka],[sa,$,c,ga,d,ja,la]),pb(l).text(a.captionName()).attr(ma,na).addClass(Ia+" "+Va),a._caption=l,e=a.RW*n,f=a.SW*n,g=a.TW*Tb(o)*n,h=a.UW*n,i=a.VW*n+W,Mb(m,[r,t,Y,Z,aa,da,ea,ra,oa,qa,fa,pa],[e,f,X,$,g,h,"center",sa,"normal",2,ga,i]),pb(m).attr("title","Clear Filter (Alt+C)").attr(ma,na).text(ua).addClass(Ka+" "+Va),a.WW=m,oc(a,Fa),pb(k).append(l).append(m),j}function Yb(a){var b,c=sb(V),d=sb("table"),e=sb("tr"),f=sb("td"),g=sb("td"),h=(a.MW-a.PW+a.XW)*Tb(a.style())*a.zoomFactor();return Mb(c,[r,fa,ba,ra],[ha,ga,h,sa]),pb(c).attr(ma,na).addClass(Ma+" "+Va),a.YW=c,Mb(d,[ra,"border-spacing"],[sa,0+W]),pb(d).attr(ma,na).addClass(Na+" "+Va),a.ZW=d,pb(e).css(ra,sa).addClass(Oa),a.$W=e,Mb(f,[_,ra],[0,sa]),pb(f).addClass(Pa),a._W=f,Mb(g,[_,ra,Y],[0,sa,X]),pb(g).addClass(Qa),a.aX=g,pb(f).append(Zb(a)),b=fc(a),pb(g).append(b),a.bX=b,pb(e).append(f).append(g),pb(d).append(e),pb(c).append(d),c}function Zb(a){var b,c,d,e,f,g,h,i=sb(V),j=a.zoomFactor();for(a.cX=i,c=ac(a),a.dX=c,b=bc(a),a.eX=b,Mb(i,[r,t,pa],[b*j,c*j,a.VW*j+W]),pb(i).attr(ma,na).addClass(Sa+" "+Va),d=ec(a),a.fX=d,e=Math.min(dc(a),vb(d)),f=0;f<e;f++)g=d[f],h=$b(a,g,f),pb(i).append(h),a._items.push(h),a.NW[a.gX.indexOf(g)]=h;return i}function $b(a,b,c){var d=b,e=sb(ta),f=a.zoomFactor(),g=a.hX*f+W;return Mb(e,[ea,ka,ba,Y,ra,qa,_,fa,ia,q],[ca,la,g,X,sa,5,"1px 6px",ga,ja,l]),pb(e).attr("type",ta).attr(ma,na).text(d).addClass(Ua+" "+Va),(c+1)%a.columnCount()!==0&&pb(e).css("margin-right",a.hX*f+W),oc(a,Ta,e),e}function _b(a){var b,c,d=a.xo,e=a.KW,f=1,g=1,h=0,i=0,j=function(a){return a?Bb(a):0},k=y+"Left"+s,l=y+"Right"+s;return d&&(b=d.style,f=j(b[k]),g=j(b[l])),e&&(c=e.style,h=j(c[k]),i=j(c[l])),a.width()-(f+g)-2*a.PW-(h+i)-a.RW}function ac(a){var b=Ub(a.xo),c=a.height()-2*a.PW-b.heightOffset;return a.showHeader()?c-a.MW*Tb(a.style())-a.XW:c}function bc(a){var b=Ub(a.xo),c=a.width()-2*a.PW-b.widthOffset-1;return a.iX()?c-a.jX:c}function cc(a,b){var c=a.columnCount();return(b-(c-1)*a.hX)/c}function dc(a){return Math.ceil(a.dX/(a.itemHeight()+2*(a.kX+a.lX)+a.hX))*a.columnCount()}function ec(a){var b,c,d,e,f,g,h=a.gX,i=a.mX(h.slice(0),a.sortState()),j=a.slicerData.getFilteredOutIndexes(a.columnName,2);if(a.showNoDataItems()){if(a.visuallyNoDataItems()&&a.showNoDataItemsInLast()){for(b=[],d=vb(i),e=0;e<d;e++)f=i[e],ob.Bb(j,h.indexOf(f))||b.push(f);for(e=0;e<d;e++)f=i[e],ob.Bb(j,h.indexOf(f))&&b.push(f);i=b}}else for(b=i.concat(),c=0;c<vb(b);c++)ob.Bb(j,h.indexOf(b[c]))&&ob.Fb(i,b[c]);return g=nb().Blank,ob.Bb(i,g)&&(ob.Fb(i,g),i.push(g)),i}function fc(a){var b,c=new fb.hv((!1));return a.nX=c,b=c.Bv(),pb(b).bind("scroll.gcScrollbar",function(b,c){var d,e=c.scrollEventType,f=c.scrollOrientation;b.data=a,1===f&&(d=[0,1,2,3,5],d.indexOf(e)>=0&&a.Bw(b,c))}),b}function gc(a){var b=a.slicerData;a.data=b.getData(a.columnName),a.exclusiveDatas=b.getExclusiveData(a.columnName),a.oX=Vb(a.data),a.gX=Vb(a.exclusiveDatas),a.fX=ec(a),nc(a),kc(a)}function hc(a,b){var c,d=a.style(),e=a.xo;e&&(b!==yb&&b!==a.zoomFactor()&&(a.zoomFactor(b),Lb(a,d)),pb(e).css(_,6*b),oc(a,Da),ic(a),c=a.showHeader()?(a.MW+a.XW-a.PW)*Tb(d)*b:0,pb(a.YW).css(ba,c),jc(a),nc(a))}function ic(a){var b,c,d,e,f,g,h,i,j,k=a.zoomFactor(),l=a.KW,m=a.YW,n=a._caption,o=a.WW,p=a.style();a.showHeader()?(a.xo.firstChild!==l&&(pb(l).insertBefore(m),pb(m).css(ba,(a.MW+a.XW)*Tb(p)*k)),pb(l).css(t,a.MW*Tb(p)*k),b=a.PW*k,Mb(a.LW,[ca,da],[b,b]),n.innerHTML!==a.captionName()&&pb(n).text(a.captionName()),c=a.QW*Tb(p)*k,d=_b(a)*k,Mb(n,[aa,r,oa],[c,d,"bold"]),e=a.pX,f=e&&vb(e)>0?1:0,yc(a,f),g=a.RW*k,h=g,i=a.TW*Tb(p)*k,j=a.UW*k,Mb(o,[r,t,aa,da],[g,h,i,j]),oc(a,Fa)):pb(l).remove()}function jc(a){var b,c=a.zoomFactor(),d=ac(a);a.dX=d,b=bc(a),a.eX=b,Mb(a.cX,[r,t,pa],[b*c,d*c,a.VW*c]),kc(a)}function kc(a){var b,c,d,e,f,g,h,i,j=a.fX;if(j){for(b=a._items,b&&vb(b)>0&&pb(b).remove(),a._items=[],b=a._items,a.NW={},c=Math.min(dc(a),vb(j)),d=a.iX()?a.nX.value()*a.columnCount():0,e=Math.min(d+c,vb(j)),f=d;f<e;f++)g=j[f],h=$b(a,g,f),pb(a.cX).append(h),b.push(h),a.NW[a.gX.indexOf(g)]=h;if(0!==vb(b))for(i in a.NW)lb(a.NW,i)&&lc(a,parseInt(i))}}function lc(a,b){var c=a.qX,d=c?a.gX.indexOf(c[wa]):-1,e=a.pX,f=a.rX,g=a.NW[b],h=0;b===d&&(h|=1),h|=ob.Bb(e,b)?4:2,h|=ob.Bb(f,b)&&a.visuallyNoDataItems()?16:8,mc(a,g,h)}function mc(a,b,c){var d=a.style(),e;if(b&&d){switch(c){case 10:e=N;break;case 18:e=O;break;case 12:e=P;break;case 20:e=Q;break;case 11:e=R;break;case 19:e=S;break;case 13:e=T;break;case 21:e=U}Rb(b,Nb(d[L],d[e]),Pb(a.slicerData),a._caption,a.zoomFactor()),oc(a,Ta,b)}}function nc(a){var b,c,d,e,f,g=a.bX,h=a.aX;a.iX()?(g||(g=fc(a)),h.firstChild!==g&&(pb(h).append(g),jc(a)),b=a.zoomFactor(),c=a.dX,d=Math.floor(c/(a.itemHeight()+2*a.kX+a.hX)),e=a.nX,e.value(a.sX),e.Vo(a.jX*b,!1),e._v(c*b,!1),e.bw(0),e.cw(Math.ceil(vb(a.gX)/a.columnCount())-d),e.dw(d),e.qB(1),e.rB(d-1),e.ew()):(h.firstChild===g&&(f=g.parentElement,f&&f.removeChild(g),jc(a)),a.sX=0)}function oc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.zoomFactor();switch(b){case Da:g=a.xo,h=Ub(g),i=a.PW,d=(a.width()-2*i)*n-h.widthOffset,e=(a.height()-2*i)*n-h.heightOffset,f=g;break;case Fa:j=a.KW,k=Ub(j),l=a.MW*Tb(a.style())*n-k.heightOffset,pb(j).css(t,l),d=a.RW*n,e=a.SW*n,f=a.WW;break;case Ta:m=Ub(c),d=cc(a,a.eX)*n-2*a.tX-m.widthOffset,e=a.itemHeight()*n-m.heightOffset,f=c}Mb(f,[r,t],[d,e])}function pc(a){var b=a.xo,c=".slicer",d="mouse",e="wheel",f="DOMMouseScroll";b&&(pb(b).bind(d+"down"+c,function(b){a.AD(b)}).bind(d+"up"+c,function(b){a.CD(b)}).bind(d+"move"+c,function(b){a.BD(b)}).bind(d+"out"+c,function(b){a.uX(b)}),b.addEventListener(d+e,function(b){a.Rw(b)},!1),b.addEventListener(f,function(b){a.Rw(b)},!1),pb(xb).bind(d+"up"+c,function(b){xc(a,b)}).bind("keydown"+c,function(b){a.nm(b)}).bind("keyup"+c,function(b){a.om(b)}),xb.addEventListener(d+e,function(b){a.Rw(b)},!1),xb.addEventListener(f,function(b){a.Rw(b)},!1))}function qc(a){var b=a.xo;b&&pb(b).unbind(".slicer")}function rc(a,b){var c,d,e,f=a.exclusiveDatas,g=a.pX,h=vc(a,b[wa]),i=a.vX,j=a.wX;for(ob.Bb(i,h)?ob.Fb(i,h):i.push(h),c=0;c<vb(f);c++)ob.Bb(g,c)||j.push(c);for(d=0;d<vb(i);d++)ob.Bb(j,i[d])?ob.Fb(j,i[d]):j.push(i[d]);if(0===vb(j))for(e=0;e<vb(a.gX);e++)j.push(e);a.xX=h}function sc(a,b){var c,d,e,f,g,h,i,j,k=a.fX,l=a.gX,m=l[a.xX];for(uc(a),c=k.indexOf(m),d=k.indexOf(b[wa]),e=Math.min(c,d),f=Math.max(c,d),g=e;g<=f;g++)h=l.indexOf(k[g]),i=a.vX,j=a.wX,i.indexOf(h)===-1&&i.push(h),j.indexOf(h)===-1&&j.push(h)}function tc(a,b){uc(a);var c=vc(a,b[wa]);lc(a,c),a.vX.push(c),a.wX.push(c),a.xX=c}function uc(a){var b,c,d,e,f,g,h=a._items;if(h&&0!==vb(h))for(b=a.rX,c=0,d=vb(h);c<d;c++)e=h[c],f=a.gX.indexOf(h[c].innerHTML),g=ob.Bb(b,f)?20:12,mc(a,e,g)}function vc(a,b){var c,d,e=a.gX;if(e)for(c=0,d=vb(e);c<d;c++)if(e[c]===b)return c;return-1}function wc(a,b){var c,d,e=a.pX,f=a.rX;for(c=0;c<vb(b);c++)d=0,d|=a.yX?ob.Bb(e,b[c])?2:4:2,d|=ob.Bb(f,b[c])&&a.visuallyNoDataItems()?16:8,mc(a,a.NW[b[c]],d)}function xc(a,b){var c=a.qX;a.CD(b),c=c?new ab(c[va],c[wa]):zb,a.qX=zb,zc(a,c)}function yc(a,b){var c,d,e,f=a.WW;if(f)switch(c=a.style(),d=Nb(c[L],c[M]),e=d&&d[w],e||(e=l),a.zX=e,b){case 0:a.AX=!1,Mb(f,[o,q],[a.BX,e]);break;case 1:a.AX=!0,Mb(f,[o,q],[a.CX,e]);break;case 2:pb(f).css(q,a.DX)}}function zc(a,b){var c,d;if(b)switch(c=a.vX,b[va]){case 4:if(!a.WW)return;a.AX?yc(a,1):yc(a,0);break;case 5:d=a.gX.indexOf(b[wa]),c&&ob.Bb(c,d)?wc(a,c):lc(a,d)}}function Ac(a,b){if(b)switch(b[va]){case 4:if(!a.WW||!a.AX)return;yc(a,2);break;case 5:var c=a.gX.indexOf(b[wa]);lc(a,c);break;case 6:a.cX.style.cursor=X}}function Bc(a,b){var c,d,e=a._items;if(e&&b!==zb)for(c=0;c<vb(e);c++)if(d=e[c],d.innerHTML.toLowerCase()===b.toLowerCase())return d;return zb}function Cc(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=Dc(a,Da),o=zb,p=zb;if(!n)return zb;if(c=b.pageX,d=b.pageY,e=Dc(a,Fa),f=Dc(a,Ja),g=Dc(a,La),h=Dc(a,Ra),e&&e.contains(c,d))o=f&&f.contains(c,d)?4:1;else if(g&&g.contains(c,d))if(i=a._items,h&&h.contains(c,d)&&i){for(j=0;j<vb(i);j++)if(k=Dc(a,Ta,j),k&&k.contains(c,d)){o=5;for(l in a.NW)if(a.NW[l]===i[j]){p=a.gX[l];break}break}j>=vb(i)&&(m=Dc(a,Ta,vb(i)-1),o=d<m.y+a.itemHeight()*a.zoomFactor()?6:7)}else o=8;else o=0;return new ab(o,p)}function Dc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=b===Da?yb:Dc(a,Da),p=a.xo,q=a.EX,r=a.PW,s=a.zoomFactor(),t=a.style(),u=a.showHeader(),v=a.MW,w=a.RW,x=a.gX;switch(b){case Da:d=0,e=0,f=p.offsetWidth,g=p.offsetHeight;do d+=p.offsetLeft,e+=p.offsetTop,p=p.offsetParent;while(p);break;case Fa:if(!o||!u)return zb;d=o.x+q*s,e=o.y+q*s,f=a.width()*s,g=v*Tb(t)*s;break;case Ja:if(!o||!u)return zb;d=o.x+o.width-(q+r+w)*s,e=o.y+q+a.QW*Tb(t)*s,f=w*s,g=a.SW*s;break;case La:if(!o)return zb;h=q+r,i=0,j=v*Tb(t)+a.XW,d=o.x+h*s,e=o.y+i*s+(u?j*s:0),f=(a.width()-2*h)*s,g=o.height-2*i*s-(u?j*s:0);break;case Ra:if(k=Dc(a,La),!k)return zb;if(!a.iX())return k;d=k.x,e=k.y,f=k.width-a.jX*a.zoomFactor(),g=k.height;break;case Ta:if(!o||0===vb(x)||c>=vb(x))return zb;if(l=Dc(a,Ra),!l)return zb;m=a.columnCount(),n=a.hX,f=(l.width-(m-2)*n*s)/m,g=a.itemHeight()*s+2*a.lX,d=l.x+c%m*(f+n*s),e=l.y+Math.floor(c/m)*(g+n*s)}return new fb.Rect(d,e,f,g)}function Ec(a){return a>0}_a=function(){var a,b,c,d;function e(){hc(this)}function f(){var a=this;a.fX=ec(a),hc(a)}function i(a,b,c,d){return c||(c=e),fb.Ul.Pl(a,b,c,d)}function j(a,b,c){var d=this;d.name(a,!1),d.xo=zb,d.PW=6,d.EX=1,d.VW=14,d.KW=zb,d.MW=27,d.XW=5,d._caption=zb,d.WW=zb,d.RW=28,d.SW=25,d.TW=3,d.UW=0,d.AX=!1,d.QW=3,d.YW=zb,d.ZW=zb,d.$W=zb,d._W=zb,d.aX=zb,d.cX=zb,d.eX=0,d.dX=0,d.bX=zb,d.FX=2,d._items=[],d.NW={},d.lX=1,d.kX=1,d.tX=6,d.hX=2,d.jX=17,d.sX=0,d.zX=l,d.DX="#F9E578",d.CX="red",d.BX="#B0ADB0",d.GX=!1,d.HX=!1,d.vX=[],d.wX=[],d.xX=0,d.fX=[],d.pX=[],d.rX=[],d.gX=[],d.oX=[],d.slicerData=b,d.columnName=c,d.data=b.getData(c),d.exclusiveDatas=b.getExclusiveData(c),d.slicerData.attachListener(d),d.IX()}for(j.getDefaultStyle=function(){var a=function(a,b,c,d,e,f,g,h){var i={};return i[w]=a,i[x]=b,i[u]=c,i[C]=d,i[D]=e,i[E]=f,i[F]=g,i[G]=h,i},b=function(a,b,c){var d={};return d[z]=a,d[A]=b,d[B]=c,d},c=b(1,n,"#808080"),d=b(0,"",""),e=b(1,n,"#999999"),f=b(1,n,"#CCCCCC"),g=b(1,n,"#E0E0E0"),h=a("#F9E36F",m,Ab,e,e,e,e),i={};return i[L]=a(l,m,Ab,c,c,c,c),i[M]=a(l,m,"bold 11pt calibri",d,d,d,b(1,n,"#A6A6A6")),i[N]=a("#BFBFBF",m,Ab,e,e,e,e),i[O]=a("#D9D9D9",m,Ab,f,f,f,f),i[P]=a(l,m,Ab,f,f,f,f),i[Q]=a(l,"#959595",Ab,g,g,g,g),i[R]=h,i[S]=h,i[T]=h,i[U]=h,i},a=[[g],[r,180],[t,210],["captionName",""],["columnCount",1,zb,Ec],["itemHeight",21,zb,Ec],["showHeader",!0],["sortState",1,f],["showNoDataItems",!0,f],["showNoDataItemsInLast",!0,f],["visuallyNoDataItems",!0,f],[h,j.getDefaultStyle(),function(a){Lb(this,a),hc(this)}],["zoomFactor",1,zb,Ec],["isLocked"],["disableResizingAndMoving"]],b={constructor:j,IX:function(){var a=this;a.oX=Vb(a.data),a.gX=Vb(a.exclusiveDatas),a.xo=Wb(a),a.captionName(a.columnName,!1),pc(a),a.onFiltered(),Lb(a,a.style()),hc(a)},getDOMElement:function(){return this.xo},mX:function(a,b){var c,d,e=[];if(0!==b){for(c=hb.jf.quickSort(a),d=0;d<vb(c);d++)e[d]=c[d].value;return 2===b&&e.reverse(),e}},iX:function(){var a=this,b=a.gX,c=a.showNoDataItems()?vb(b):vb(b)-vb(a.rX),d=Math.ceil(c/a.columnCount())*(a.itemHeight()+2*(a.lX+a.kX)+a.hX);return d>a.dX},Bw:function(a,b){this.JX(a,b)},JX:function(a,b){var c=this,d=b.newValue;d!==c.sX&&d<=c.nX.cw()&&(c.sX=d,nc(c),kc(c))},onDataChanged:function(){gc(this)},onRowsChanged:function(){gc(this)},onColumnNameChanged:function(a,b){var c=this;c.columnName===a&&c._caption&&(c.columnName=b,c.captionName(b,!1),pb(c._caption).text(b))},onColumnRemoved:function(a){var b=this;a===b.columnName&&(b.slicerData.doUnfilter(a),qc(b),pb(b.xo).remove(),b.xo=zb)},onFiltered:function(){var a=this,b=a.slicerData,c=a.columnName;a.fX=ec(a),a.rX=b.getFilteredOutIndexes(c,2),a.pX=b.getFilteredOutIndexes(c,1),hc(a)},AD:function(a){var b=this,c=Cc(b,a);c&&(8===c[va]&&(b.HX=!0),5===c[va]&&(b.wX=[],b.GX=!0,a.ctrlKey?rc(b,c):a.shiftKey?sc(b,c):tc(b,c)),wc(b,b.vX),(5===c[va]||6===c[va]||8===c[va]||4===c[va]&&b.AX)&&a.stopPropagation())},CD:function(a){var b,c,d,e=this,f=Cc(e,a);f&&(b=e.slicerData,c=e.vX,d=!1,4===f[va]?e.AX&&(b.doUnfilter(e.columnName),yc(e,0),d=!0):c&&vb(c)>0&&(e.yX||e.KX||(b.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),d=!0)),e.GX=!1,e.HX=!1,d&&(e.vX=[],e.wX=[]))},BD:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.qX,q=p?new ab(p[va],p[wa]):zb,r=Cc(o,a),s=o.gX,t=o.wX;if(r&&(!q||q[va]!==r[va]||5===q[va]&&q[wa]!==r[wa])){if(!o.GX)return o.qX=r,zc(o,q),void Ac(o,r);if(5===r[va])if(b=s.indexOf(r[wa]),c=o.rX,ob.Bb(t,b)){for(h=o.fX,i=h.indexOf(s[o.xX]),j=h.indexOf(r[wa]),k=Math.min(i,j),l=Math.max(i,j),m=[],d=0,e=vb(t);d<e;d++)n=t[d],f=h.indexOf(s[n]),(f>l||f<k)&&m.push(n);for(d=0,e=vb(m);d<e;d++)f=m[d],g=Bc(o,s[f]),ob.Bb(c,f)?mc(o,g,20):mc(o,g,12),ob.Fb(t,f)}else g=Bc(o,s[b]),ob.Bb(c,b)?mc(o,g,18):mc(o,g,10),ob.Sb(t,b);o.qX=r}},uX:function(){var a=this,b=a.qX,c=b?new ab(b[va],b[wa]):zb;a.qX=zb,zc(a,c)},Rw:function(a){var b=Cc(this,a);return 8===b[va]&&(a.stopPropagation(),!0)},nm:function(a){var b=this;17!==a.keyCode||b.yX||(b.yX=!0),16!==a.keyCode||b.KX||(b.KX=!0)},om:function(a){var b=this,c=b.slicerData;17===a.keyCode&&b.yX&&(b.yX=!1),16===a.keyCode&&b.KX&&(b.KX=!1),!b.yX&&!b.KX&&vb(b.vX)>0&&(c.doFilter(b.columnName,{exclusiveRowIndexes:b.wX}),b.vX=[],b.wX=[])}},c=0,d=vb(a);c<d;c++)b[a[c][0]]=i(a[c][0],a[c][1],a[c][2],a[c][3]);return pb.extend(j.prototype,b),j}(),ab=function(){function a(a,b){var c=this;c[va]=a===yb?zb:a,c[wa]=b===yb?zb:b}return a}();function Fc(a,b,c){var d,e,f,g,h=a.sj,i=h.OW(),j=h.dataRange(),k=j.row+j.rowCount-1,l=j.col+j.colCount-1;for(d=j.row;d<=k;d++)for(e=[],b.push(e),f=j.col;f<=l;f++)e.push({value:i.getValue(d,f),text:i.getText(d,f)});for(f=0;f<j.colCount;f++)g=h.getColumnName(f)||"",c.push(g)}function Gc(a,b){var c,d,e=a.kj,f=a.sj.rowFilter();for(e.suspendPaint(),c=f&&f.Je||[],d=0;d<vb(c);d++)Hc(a,b,[c[d]]);e.resumePaint()}function Hc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(d=0;d<c.length;d++){if(e=a.sj,f=a.xr,g=c[d]-e.range().col,h=e.dataRange(),i=g+h.col,j=a.columnNames[g],k=[],l={},ob.Bb(f.Je,i)){for(m=[],n=h.row;n<h.row+h.rowCount;n++)f.WY(n,i)||m.push(n);for(o=0;o<vb(m);o++)p=m[o]-h.row,q=a.getExclusiveRowIndex(j,p),l[q]||(l[q]=!0,k.push(q))}else for(r=vb(a.getExclusiveData(j)),s=0;s<r;s++)k.push(s);Ic(Jc(a,j),k)||(b.prototype.doFilter.call(a,j,{exclusiveRowIndexes:k}),a.onFiltered(),a.kj.$p())}}function Ic(a,b){var c,d=gb.j.Fa;if(d(a)&&d(b))return!0;if(d(a)&&!d(b)||!d(a)&&d(b)||!d(a)&&!d(b)&&(!(a instanceof Array)||!(b instanceof Array))||a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function Jc(a,b){var c,d=a.getExclusiveData(b),e=a.getFilteredOutIndexes(b,1),f=[];for(c=0;c<vb(d);c++)ob.Bb(e,c)&&f.push(c);return f}bb=function(a){pb.inherit(b,a);function b(b){var c=this,d=[],e=[],f=b.rowFilter();c.sj=b,c.kj=b.OW(),c.xr=f,c.MX=zb,Fc(c,d,e),a.call(c,d,e),Gc(c,a),f&&(f.filterHandler=function(b){Hc(c,a,b.columns)})}var c={constructor:b,OW:function(){return this.kj},getTable:function(){return this.sj},doFilter:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=y.kj,A=y.sj,B=y.xr,C=c.ranges,D=c.exclusiveRowIndexes,E=!!D,F=y.getColumnIndex(b);if(!(F<0||!E&&!C))if(d)a.prototype.doFilter.call(y,b,c,d);else{if(e=E?y.getExclusiveData(b):y.getData(b),f=[],E)f=D;else for(g=y.ef(),h=y.ff(),g[F]||y.We(F),i=g[F],j=0;j<vb(C);j++)for(k=C[j],l=y.Xe(i,k),m=l.start;m<=l.end;m++)f.push(h[F][m]);if(z.suspendPaint(),n=A.startColumn()+F,o=A.dataRange().row,B&&(B.NX(n),B.OX(n)),z.AR(),p=[],kb)for(q=0;q<vb(f);q++)r=new kb.$V(2,0,e[f[q]]),B&&B.addFilterItem(n,r),p.push(r);if(a.prototype.hf.call(y,b,c),s=[],t={},y.gf(b,s,t),B){for(u=0;u<vb(f);u++)if(v=E?f[u]:y.getExclusiveRowIndex(b,f[u]),t[v])if(B.PX(p[u]),E)for(w=y.getRowIndexes(b,f[u]),x=0;x<vb(w);x++)B.QX(w[x]+o,n);else B.QX(f[u]+o,n);B.RX(n,!0),B.onFilter(B.SX(0,[n]))}y.onFiltered(),z.resumePaint()}},doUnfilter:function(b){var c,d=this,e=d.sj,f=d.getColumnIndex(b),g=d.xr;f!==-1&&(c=e.startColumn()+f,g.removeFilterItems(c),a.prototype.if.call(d,b),g.OX(c),g.RX(c,!1),g.onFilter(g.SX(0,[c])),d.onFiltered(),d.kj.$p())},refresh:function(){var a=this,b=[],c=[];Fc(a,b,c),a.bf(b,c),a.cf()},onColumnNameChanged:function(b,c){var d=this;a.prototype.onColumnNameChanged.call(d,b,c),d.kj.slicers.all().forEach(function(a){a.columnName(c)})},onRowsAdded:function(b,c){var d,e,f=this,g=f.kj,h=f.sj,i=h.dataRange();for(a.prototype.onRowsAdded.call(f,b,c,!0),d=b;d<b+c;d++)for(e=0;e<vb(f.columnNames);e++)f.data[d][e]={value:g.getValue(i.row+d,i.col+e),text:g.getText(i.row+d,i.col+e)};f.bf(f.data,f.columnNames),f.cf(b,c,!0,"onRowsChanged")},onRowsRemoved:function(b,c){a.prototype.df.call(this,b,c,!1)},onColumnsAdded:function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.sj,j=i.dataRange(),k=g.data,l=g.columnNames;for(c=0;c<vb(k);c++)for(d=a;d<a+b;d++)k[c].splice(d,0,{value:h.getValue(j.row+c,j.col+d),text:h.getText(j.row+c,j.col+d)});for(e=a;e<a+b;e++)f=i.getColumnName(e)||"",l.splice(e,0,f);g.bf(k,l)},onColumnsRemoved:function(b,c){var d,e,f=this,g=f.kj,h=f.sj.name(),i=f.columnNames,j=[];for(d=b;d<b+c;d++)j.push(i[d]);a.prototype.onColumnsRemoved.call(f,b,c),e=g&&g.slicers,j.forEach(function(a){e.all(h,a).forEach(function(a){e.remove(a.name())})})},onTableRemoved:function(a){var b,c,d,e=this;a&&a===e.sj&&(e.MX=[],b=e.kj,c=b.slicers,d=a.name(),c.all(d).forEach(function(a){e.MX.push(a),c.remove(a.name())}),c&&Mc(c,e),e.Ze=[])},onTableAdded:function(a){var b,c=this,d=c.kj,e=d.slicers;e&&a&&a.Aq()&&Lc(e,a.getSlicerData()),b=c.MX||[],b.forEach(function(a){e.Cz(a)})}};return pb.extend(b.prototype,c),b}(hb.GeneralSlicerData),jb&&pb.extend(jb.Table.prototype,{getSlicerData:function(){var a=this;return a.ZX||(a.ZX=new bb(a)),a.ZX}});function Kc(a){var b=a.sj,c=b.OW(),d=b&&b.rowFilter();return!c.options.isProtected||d&&d.TX(c)}cb=function(a){pb.inherit(b,a);function b(b,c,d){a.call(this,b,c,d),this.isSelected(!1)}var c={constructor:b,isSelected:tb("isSelected",!1),sheet:tb("sheet"),slicer:tb("slicer"),IX:function(){var b=this,c=b.slicerData;c&&c instanceof bb&&(b.sheet(c.OW()),b.sj=c.getTable()),a.prototype.IX.call(this)},onColumnRemoved:function(a){var b,c=this,d=c.sheet(),e=c.sj,f=c.slicerData;a===c.columnName&&(b=f.getFilteredOutIndexes(a,1),0!==vb(b)&&f.doUnfilter(a),d&&e&&d.wr.Fb(c.name()))},mX:function(a,b){var c,d,e,f,g,h,i=this,j=i.slicerData,k=j.getColumnIndex(i.columnName),l=i.sj,m=l.dataRange(),n=[];if(0===b)return a;for(c=[],d=j.OW(),e=0;e<vb(a);e++)f=j.getRowIndexes(i.columnName,e),c.push(d.getValue(m.row+f[0],m.col+k));for(g=hb.jf.quickSort(c),h=0;h<vb(g);h++)n[h]=a[g[h].index];return 2===b&&n.reverse(),n},Bw:function(b,c){var d,e,f=this,g=f.sheet(),h=f.slicer();for(h&&g.ER(h)||(c.newValue=c.oldValue),d=Sc(h),e=0;e<vb(d);e++)a.prototype.JX.call(d[e],b,c)},AD:function(b){var c,d,e,f=this,g=f.sheet(),h=f.slicer();if(h&&g.ER(h)){if(c=Cc(f,b),!Kc(f)&&(5===c[va]||6===c[va]||8===c[va]))return void b.stopPropagation();for(d=Sc(h),e=0;e<vb(d);e++)a.prototype.AD.call(d[e],b)}},CD:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.sheet(),r=p.slicer();if(r&&q.ER(r)&&Kc(p)&&(b=Cc(p,a))){for(c=p.slicerData,d=p.vX,e=p.wX,f=c.getExclusiveData(p.columnName),g=!1,h=zb,4===b[va]||5===b[va]&&vb(e)===vb(f)&&!p.yX&&!p.KX?(i=c.getFilteredIndexes(p.columnName),h=q.wu().execute({cmd:"unfilterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,value:i}),g=!0):d&&vb(d)>0&&(p.yX||p.KX||(j=c.getFilteredIndexes(p.columnName),k=e.concat(),h=q.wu().execute({cmd:"filterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,oldValue:j,newValue:k}),g=!0)),l=Sc(r),m=0,n=vb(l);m<n;m++)o=l[m],o.GX=!1,o.HX=!1,g&&(o.vX=[],o.wX=[]);return!!h}},BD:function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&!e.HX&&f.ER(g))for(c=Sc(g),d=0;d<vb(c);d++)a.prototype.BD.call(c[d],b)},uX:function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&f.ER(g))for(c=Sc(g),d=0;d<vb(c);d++)a.prototype.uX.call(c[d],b)},Rw:function(b){var c,d,e,f,g=this;return!!a.prototype.Rw.call(this,b)||(c=g.sheet(),d=c.slicers,e=d&&d.UX(),f=g.nX,!!(e&&1===vb(e)&&g.isSelected()&&g.iX()&&f)&&(f.sC(b),b.stopPropagation(),!0))},om:function(a){var b,c,d,e,f=this,g=f.slicerData,h=f.sheet(),i=f.wX;17===a.keyCode&&f.yX&&(f.yX=!1),16===a.keyCode&&f.KX&&(f.KX=!1),!f.yX&&!f.KX&&vb(f.vX)>0&&(b=vb(g.getExclusiveData(f.columnName)),vb(i)===b?(c=g.getFilteredIndexes(f.columnName),h.wu().execute({cmd:"unfilterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,value:c})):(d=g.getFilteredIndexes(f.columnName),e=i.concat(),h.wu().execute({cmd:"filterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,oldValue:d,newValue:e})),f.vX=[],f.wX=[])}};return pb.extend(b.prototype,c),b}(_a);function Lc(a,b){var c,d,e=a.VX;if(b){for(c=b.getTable(),d=0;d<vb(e);d++)if(e[d].getTable()===c)return;e.push(b)}}function Mc(a,b){ob.Fb(a.VX,b)}function Nc(a,b){var c,d,e,f=a.VX;for(c=0;c<vb(f);c++)if(d=f[c],e=d.getTable(),d&&e&&e.tableName()===b)return d;return zb}function Oc(a,b,c){var d;return b?lb(Pc(a),b)&&(d=nb().Exp_SlicerNameExist):d=nb().Exp_SlicerNameInvalid,d&&c&&(c.error=Error(d)),!d}function Pc(a){var b,c,d,e=a.kj,f={},g=e&&e.parent&&e.parent.sheets;if(g)for(b=0;b<vb(g);b++){c=g[b].slicers.XX();for(d in c)lb(c,d)&&(f[d]=c[d])}return f}db=function(){function a(a){var b=this;b.kj=a,b.VX=[],b.WX={}}return a.prototype={constructor:a,add:function(a,b,c,d){var e,f=this,g=f.kj,h=g.parent,i=h.jga(b);return i&&i.getColumnIndexInTable(c)!==-1?(g.suspendPaint(),e=new eb(a,i,c),d&&e.style(d),f.Cz(e),g.wr.Sb(e),g.resumePaint(),e):zb},Cz:function(a){var b,c,d=this;if(a){if(b=a.name(),c={},!Oc(d,b,c))throw c.error;d.WX[b]=a,Lc(d,a.YX())}},get:function(a){return a===zb||a===yb?zb:this.WX[a]},remove:function(a){var b,c,d,e=this,f=e.kj,g=e.WX,h=e.get(a);if(h&&lb(g,a)){for(b=h.YX(),c=Sc(h),d=0;d<vb(c);d++)b.detachListener(c[d]);delete e.WX[a],f.wr.Fb(a)}},U3:function(a,b){var c,d=this,e=d.kj,f={};if(!Oc(d,b,f))throw f.error;c=d.WX[a],delete d.WX[a],d.WX[b]=c,e.wr.U3(a,b)},clear:function(){var a=this,b=a.sheet();b.suspendPaint(),pb.each(this.WX,function(b){a.remove(b.name())}),b.resumePaint()},all:function(a,b){var c=[];return pb.each(this.WX,function(d,e){a&&(Rc(e).name()!==a||b&&e.columnName()!==b)||c.push(e)}),c},XX:function(){return this.WX},HS:function(a){var b,c,d,e=Pc(this);if(!lb(e,a))return a;for(b=1,c=" ",d=a.split(c)[0];lb(e,d+c+b);)b++;return d+c+b},UX:function(){var a,b,c,d=this,e=d.WX;if(!e||fb.GC$.isEmptyObject(e))return[];a=[];for(b in e)lb(e,b)&&(c=e[b],c&&c.isSelected()&&a.push(c));return a},W3:function(a){var b,c,d=this,e=d.UX();if(1!==vb(e))return!1;if(b=Sc(e[0]),vb(b)>0){for(c=0;c<vb(b);c++)b[c].Rw(a);return!0;
}return!1},toJSON:function(){var a,b=this,c=[],d=b.WX;if(d&&!fb.GC$.isEmptyObject(d))for(a in d)lb(d,a)&&c.push(d[a].toJSON());return c},fromJSON:function(a){var b,c,d,e,f,g,h,i;if(a&&0!==vb(a))for(b=this,c=b.kj,d=c.parent,b.WX={},e=0;e<vb(a);e++)f=a[e].tableName,g=a[e].columnName,f&&g&&(h=d.jga(f),h&&h.getColumnIndexInTable(g)!==-1&&(i=new eb(a[e].name,h,g),i.sheet(c),i.fromJSON(a[e]),c.slicers.Cz(i),c.wr.Sb(i)))}},a}();function Qc(a,b,c){var d,e,f=a.ZX;f&&(d=f.OW(),e=d.slicers,e.all().forEach(function(d){d===a&&(e.U3(b,c),a.onPropertyChanged(g,c))}))}function Rc(a){return a.ZX.getTable()}function Sc(a){return a.$X}eb=function(a){var b,c,d,e,f,g="name",h="width",i="height",j="nameInFormula",k="captionName",l="columnCount",m="columnName",n="itemHeight",o="showHeader",p="sortState",q="disableResizingAndMoving",r="showNoDataItems",s="showNoDataItemsInLast",t="visuallyNoDataItems",u="isSelected",v="dynamicMove",w="dynamicSize",x="tableName",y="style",z="Slicer",A=100,B=100,C=192,D=250;pb.inherit(H,a),b=[];function E(a,c,d,e){return b.push(a),tb(a,c,function(b,c){d.call(this,a,b,c)},e)}function F(a){var b,c,d,e,f;if(!a)return!1;if(b=this,c=b.ZX,a===b.name())return!1;if(c&&(d=c.OW(),e=d&&d.slicers,e&&(f={},!Oc(e,a,f))))throw f.error;return!0}function G(a,b){var c,d,e=this,f=e.$X||[];for(c=0;c<vb(f);c++)f[c][a]&&("style"===a?f[c][a](b.toJSONInternal()):f[c][a](b));d=e.sheet(),e.Wq({sheet:d,sheetName:d?d.Cj:"",slicer:e,propertyName:a})}function H(b,c,d){a.call(this,b,A,B,C,D);var e=this,f,g;e.typeName=z,c&&(f=c.OW(),e.sheet(f),g=Nc(f.slicers,c.tableName())),g||(g=c.getSlicerData()),e.ZX=g,e[m](d),e.$X=[],e._X=d,e[j](z+"_"+d),e[k](d),e[w](!1),e[v](!1)}for(c=[[g,"",function(a,b,c){Qc(this,c,b)},F],[k,"",G],[l,1,G,Ec],[n,21,G,Ec],[o,!0,G],[p,1,G],[q,!1,function(a,b){var c=this;c.allowMove(!b,!1),c.allowResize(!b,!1),G.call(c,q,b)}],[r,!0,G],[s,!0,G],[t,!0,G],[y,$a.light1(),G],[m,"",function(a,b){this._X=b,this.captionName(b,!1)}]],d={constructor:H,sourceName:function(){return this._X},nameInFormula:E(j,"",G),onPropertyChanged:G,cloneContent:function(){var a=this,b=a.sheet(),c=a.ZX,d=new cb(a.name(),c,a.columnName());return d[h](a[h](),!1)[i](a[i](),!1)[k](a[k]())[l](a[l]())[n](a[n]())[o](a[o]())[p](a[p]()).isLocked(a.isLocked())[q](a[q]())[r](a[r]())[s](a[s]())[t](a[t]())[y](a[y]().toJSONInternal()).zoomFactor(b._zoomFactor)[u](a[u]()).slicer(a),d.sheet()!==b&&d.sheet(b),a.$X.push(d),d.getDOMElement()},YX:function(){return this.ZX},hga:function(){return!1},refresh:function(a){var b,c=this.$X;for(b=0;b<vb(c);b++)hc(c[b],a)},refreshContent:function(a){var b=this,c=b.sheet().zoom();c!==b.MP&&(b.MP=c,b.refresh(c))},clone:function(a){var b,c=this;return!c.sheet()&&a&&c.sheet(a,!1),b=new H(c.name(),Rc(c),c.columnName()),b.sheet(c.sheet(),!1),b.fromJSON(c.toJSON(),!1,c.ZX),b},fromJSON:function(c,d,e){var f,g,j,k,l,n,o,p,q=this,r=c.tableName,s=c[m];c&&!pb.isEmptyObject(c||!r||!s)&&(a.prototype.fromJSON.call(this,c),f=q.sheet(),g=f.slicers,j=f.parent,k=e?e:Nc(g,r),k||(l=j.jga(r),k=l.getSlicerData(),Lc(g,k)),q.ZX=k,q[m](s),n=c.x!==yb?c.x:A,o=c.y!==yb?c.y:B,q.position(new fb.Point(n,o),!1),q[h](c[h]!==yb?c[h]:C,!1),q[i](c[i]!==yb?c[i]:D,!1),c.sourceName!==yb&&(q._X=c.sourceName),b.forEach(function(a){var b=c[a];b!==yb&&q[a](b,!1)}),c.style!==yb&&(p=Gb(),p.fromJSON(c.style),q.style(p,!1)))},toJSON:function(){var a,c,d,e=this,f={},g=["x","y",h,i,v,w,"isLocked","fixedPosition"];return g.forEach(function(a){var b=e[a]();e[a].isDefault(b)&&a!==v&&a!==w||(f[a]=b)}),a=e._X,a&&(f.sourceName=a),e[y]()&&(f[y]=e[y]().toJSON()),c=e.ZX,d=c.getTable(),d[x]&&(f[x]=d[x]()),b.forEach(function(a){var b=e[a]();a===y||e[a].isDefault(b)||(f[a]=b)}),f},Wq:function(a){var b=this.sheet();b&&b.Wq(fb.Events.SlicerChanged,a)}},e=0,f=vb(c);e<f;e++)d[c[e][0]]=E(c[e][0],c[e][1],c[e][2],c[e][3]);return pb.extend(H.prototype,d),H}(ib.FloatingObject),mb={ItemSlicer:_a,SlicerStyleInfo:Wa,SlicerBorder:Xa,SlicerStyle:Ya,SlicerStyles:$a,TableSlicerData:bb,Slicer:eb,SlicerCollection:db},a.exports=mb},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Slicers},function(a,b){a.exports=GC.Spread.Sheets.FloatingObjects},function(a,b){a.exports=GC.Spread.Sheets.Tables},function(a,b){a.exports=GC.Spread.Sheets.ConditionalFormatting},function(a,b,c){var d=c(2),e=d.Commands,f=d.GC$,g=e.ActionBase,h=function(a){f.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicerData},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doFilter(c.columnName,{exclusiveRowIndexes:c.newValue}),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicerData},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doFilter(c.columnName,{exclusiveRowIndexes:c.oldValue}),b.Mz(a,!0),!0)}};return f.extend(b.prototype,c),b}(g),i=function(a){f.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicerData},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doUnfilter(c.columnName),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicerData},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicerData.doFilter(c.columnName,{exclusiveRowIndexes:c.value}),b.Mz(a,!0),!0)}};return f.extend(b.prototype,c),b}(g),j=function(a){f.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicer},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.newValue),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicer},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.oldValue),b.Mz(a,!0),!0)}};return f.extend(b.prototype,c),b}(g),k=e.h4;e.filterSlicer={canUndo:!0,execute:function(a,b,c){return k(a,h,b,c)}},e.unfilterSlicer={canUndo:!0,execute:function(a,b,c){return k(a,i,b,c)}},e.changeSlicerProperty={canUndo:!0,execute:function(a,b,c){return k(a,j,b,c)}},e.unfilterSlicerByKey={canUndo:!1,execute:function(a,b){var c,d,f,g=e.bT(a,b),h=g.slicers.UX();if(1===h.length&&(c=h[0],d=c.YX()))return f=d.getFilteredIndexes(c.columnName()),g.wu().execute({cmd:"unfilterSlicer",sheetName:g.name(),slicerData:d,columnName:c.columnName(),value:f})}}},function(a,b){a.exports={Blank:"(blank)",Exp_SlicerNameInvalid:"The slicer name is not valid.",Exp_SlicerNameExist:"The slicer name is already in use, please enter a unique name."}}]);