/*!
 * 
 * Spread.Sheets Library 10.0.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/spreadjs/eula/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FormulaTextBox=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){var b=c(1);c(5),c(6),c(7),c(8),b.SR={},b.SR.en=c(9),a.exports=b},function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=c(2),s=c(3),t=r.CalcEngine,u=c(4),v={},w=null,x=void 0,y=Math.max,z=Math.min,A=r.GC$,B=A.extend,C=r.Ul.Nl,D=window,E=document,F=u.u,G=r.Ul,H=G.nl,I=G.Ml,J=F.Nb,K="formulatextbox",L=function(){return u.C(v.SR)()};function M(a){return a.getActiveSheet()}function N(){var a=[];return A.each(u.C(s.SR)()._h,function(b,c){c.name=b,a.push(c)}),a}function O(a){var b=[],c;return A.each(a,function(a,d){c=d.description(),c&&(c.name=a,b.push(c))}),b}function P(a,b){if(!a)return!1;var c=!1,d=!1;if(1===b.rowCount){if(a.hasHeadersRow()&&b.row===a.startRow())return!0;if(a.hasTotalsRow()&&b.row===a.endRow())return!0}else a.hasHeadersRow()&&b.row===a.startRow()&&(b.rowCount===a.dataRange().rowCount+1&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1+1&&(c=!0)),b.row===a.dataRange().row&&(b.rowCount===a.dataRange().rowCount&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1&&(c=!0));return b.col+b.colCount<=a.startColumn()+a.dataRange().colCount&&(d=!0),c&&d}function Q(a){var b=a.name();return/^\d+$/.test(b)||b.indexOf(" ")>-1||b.indexOf("'")>-1||b.indexOf("%")>-1||b.indexOf('"')>-1||b.indexOf("(")>-1||b.indexOf(")")>-1?"'"+b+"'":b}function R(a,b){var c,d,e,f,g,h,i,j,k,l;return b?(c=a.Jl,d=a.Kl,e=a.parent,f=e&&1===e.options.referenceStyle,g=15,a.Cw&&a.Cw.Nfa&&(g=0),b.row<0&&b.col<0&&(b=new r.Range(0,(-1),a.getRowCount(),(-1))),h=a.tables,i=h&&h.find(b.row,b.col),j=v.G0.H0,P(i,b)?(j&&j._text&&j.kj!==a&&(c=d=-1),t.rangeToFormulaWithStructReference(a,b,c,d,g,f,i)):(k=t.rangeToFormula(b,c,d,g,f),(j&&j._text||a.Cw&&a.Cw.V4)&&(l=Q(a),k=l+"!"+k),k)):w}v.C2=R,r.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",r.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",D.Yl.km.push(function(a,b){var c,d=b&&"gcAttachedFormulaTextBox"===b.getAttribute("gcUIElement"),e=v.G0;!b&&a.endEdit&&!d&&e&&(c=e.H0,c&&c.I0&&a.Cw&&(a.Cw&&a.Cw.destroy(),a.Cw=w,c.$b()))});function S(a,b){var c,d,e,f,g,h=a.parent,i=h&&h.options;b&&i&&i.allowUserEditFormula&&i.enableFormulaTextbox&&(a.Cw&&a.Cw.destroy(),a.Cw=new q(b,null,h),c=a.Cw.text(),d=a.getFormulaInformation(a.Jl,a.Kl),d&&d.hasFormula||"="===c[0]&&(c="'"+c,a.Cw.text(c)),e=a.Cw,f=a.mm,g=a.yl,e.bind("AppendStarted",function(){e.close();var b=a.Px;1!==b&&(a.Px=1,a.Cu(b,1))}),e.bind("AppendEnded",function(){g.uH()}),e.bind("TextChanged",function(b,c){if(!a.Js){if(c&&"input"!==c.type){f.Qw(c);var d=a.Jl,h=a.Kl,i=a.getCellType(d,h);a.Wq(r.Events.EditChange,{sheet:a,sheetName:a.Cj,row:d,col:h,editingText:i.getEditorValue(a.BF)})}g.uH(),a.Wq(r.Events.FormulaTextBoxTextChanged,{sheet:a,sheetName:a.Cj,text:e.text()})}}),e.bind("CaretChanged",function(){g.uH(),a.Wq(r.Events.FormulaTextBoxCaretChanged,{sheet:a,sheetName:a.Cj,caret:e.caret()})}),e.add(N()),e.add(O(s.Functions.ci)),e.add(O(a.Su).concat(O(h.Su))),g.uH())}v.J0=S;function T(a){a.Cw&&(a.Cw.destroy(),a.Cw=w,a.yl.uH());var b=a.parent&&a.parent.CF;E.activeElement===(b&&b.qo)&&a.mm.Qq()}v.K0=T;function U(a,b){if(!b)return w;var c=a.Jl,d=a.Kl;try{return t.formulaToRange(a,b,c,d)}catch(a){}return w}v.L0=U,B(r.DC.prototype,{bE:function(a){return!(a&&a.Cw&&a.Cw.M0())}}),r.Worksheet.$n(K,{startEdit:function(a){S(this,a.element)},endEdit:function(){T(this)}}),d=r.DC,e=d.prototype,f=e.dE,d.$n(K,{preProcessMouseDbClick:function(a){var b=M(this.OC),c=b.Cw,d=c&&c.M0(),e=v.G0.H0;d?a.r=!1:e&&e.I0&&e.$b()}}),e.dE=function(){var a=M(this.OC),b=a.Cw,c=v.G0.H0,d=c&&c._text;return f.call(this)&&!d&&!b},g=".gcFormulaTextBoxInternal",h=".gcFormulaTextBox",i="TextChanged",j="CaretChanged",k="AppendStarted",l="AppendEnded",m={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},n=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],o='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',p='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVDhPY3hILqBYZ/eqVxDUuvRl/cKXZbNf5E59ntT3DIgi2p/6NT5xq35iV/YYiCyLHkG0IHQuOvR/1t6/03b+mbD1d/eGXy2rf9Yu/wFE5Yu+Fc79mjXza+rUz0BkmHoWogXFTqCFVfNfQmwLa3vqVfsYiBzA9sCRftIJiBaozuYZO+89eAREt+4+AKIbt+9fvXkPiC5du3P28s0T564dOnV579Hz2w6cSaqcDdEC1Vk/ZQtQQ2vv7MaumbUd0+o6ZzT3zmnunQ1kF9T0pZe2J+U3x+U0bNx9MqZ4CkQLVGdB6xKgDaX1/b/+/PnyE4E+ff/z8uPvR29/3X35MzCxfPW2o2HZPRAtUJ2lXSuADkstann/9febz7/ff/3zLDP4Spj9Pjs1oE6gthvPfnpEFS7deDAwrRWiBaozv3kh0D8RadVAlFvZvWLDrjvRrk+bCrdpCS1ZsyOpoMU9ssA5NBeo0zuhDqIFqjO9Zubhk1eA6MT5G+eu3H78/PVFX/OnxQnrNQTuPnyx9+hFoA+B2uav2ecaVQ7RAtUZVzQBKH3g+KXTl24fdjE44mp4yFbtSYrfGg3+yQocQLTryEWgzgVr9zmEFkK0QHWGZbbvPHQOiI6cvnb5wMENhjJPE30eB1k9dFIDaruy/wAwPoA6563eaxOQDdEC1YkG1hvKrNKVuOEA0nYr2Pp5qA1UAglg1wkEW03lF2kI3wy1xaoNCHDqJAjI1fnwIQDHT83/UVFPcQAAAABJRU5ErkJggg==")',q=function(){var a=1;function b(b,d,e){var f,g=this,h=b;g.V4=!1,g.C5=0,g.Nfa=!1,d&&d.rangeSelectMode&&(d.absoluteReference===!0&&(g.Nfa=!0),g.V4=!0,g.D5=!1,g.E5=!1,g.cga=b,h=c(b,g),g.C5=a++),g.ad(e&&e.getHost()||E.body),h&&g.N0(h),e&&(g.O0=!0,g.P0(e),g.OC.Gu(r.Events.FormulatextboxActiveSheetChanging,v.G0.Q0),g.OC.Fu(r.Events.FormulatextboxActiveSheetChanging,v.G0.Q0),g.OC.Gu(r.Events.FormulatextboxActiveSheetChanged,v.G0.R0),g.OC.Fu(r.Events.FormulatextboxActiveSheetChanged,v.G0.R0)),g.S0=g.T0(g.text()),f=g.U0(h),f&&g.V0(g.S0)}function c(a,b){var c,d,e,f,g,h,i,j,k,l=C("table");return A(l).css("border-spacing","0"),A(l).css("width","100%"),A(a).append(l),c=C("tbody"),l.appendChild(c),d=document.createElement("tr"),c.appendChild(d),e=document.createElement("td"),A(e).css("padding-right","0px"),d.appendChild(e),f=document.createElement("td"),A(f).css("width","23px"),A(f).css("padding-right","0px"),d.appendChild(f),g=A(a).width()-A(f).width(),h=C("div"),i=C("div"),A(i).width(g),A(i).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),i.appendChild(h),e.appendChild(i),j=C("div"),f.appendChild(j),A(h).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),A(h).width(g),A(h).attr("contenteditable","true"),A(h).attr("spellcheck","false"),k=A(j),k.css({display:"block",float:"right",width:"23px",height:"23px",background:o,"background-repeat":"no-repeat"}),k.bind("click",function(){b.D5?(b.D5=!1,b.H5(),k.css("background",o),k.css("background-repeat","no-repeat")):(b.D5=!0,b.j5(),k.css("background",p),k.css("background-repeat","no-repeat"))}),h}function d(a){var b=C("textarea"),c=A(b);return c.css({display:"none"}),A(a).append(b),b}return v.W4=d,b.prototype={constructor:b,j5:function(a){var b,c,e,f,g,h,i=this;i.O1(),i.UF(),i.E5=!0,b=d(i.OC.qo),c=i.a1(),c.suspendPaint(),S(c,b),e=c.Cw,e.V4=!0,e.C5=i.C5,e.Nfa=i.Nfa,a&&(i.text(a),i.caret(a.length)),f=i.text(),g=i.caret(),g<=0&&(g=f.length),i.focus(),i.caret(g),i.MH=!0,i.W0=1,h=f.lastIndexOf(",",g),h!==-1&&(i.W0=h+1),f||(i.text("="),f="=",i.caret(1),g=1),e.text(f),e.caret(g),e.MH=i.MH,e.W0=i.W0,c.resumePaint()},H5:function(){var a=this.a1();a.gv(!0,x,!0),a.repaint()},destroy:function(){var a=this;a.D5&&a.H5(),a.MH=!1,a.W0=-1,a.X0(),a.Y0(),A(a.Z0).remove(),A(a.$0).remove(),A(a._0).remove()},bind:function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(h+" "),A(d).bind(a+h,b,c))},unbind:function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(h+" "),A(c).unbind(a+h,b))},unbindAll:function(){var a=this.qo;a&&A(a).unbind(h)},caret:function(a){var b,c,d=this,e=d.qo;if(e)return b=E.activeElement===e,c=A(e),0===arguments.length?b?d.b1(e).end:c.data("caret-before"):void(a!==d.caret()&&(b?(d.c1(e,a),c.data("caret-before",d.b1(e).end)):c.data("caret-before",a),d.Wq(j,{})))},b1:function(a){var b,c,d,e=-1,f=-1,g=this.d1(a),h=this.U0(a);return g?(e=a.selectionStart,f=a.selectionEnd):h&&(b=D.getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.endContainer,c.endOffset),f=(""+d).length,d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.startContainer,c.startOffset),e=(""+d).length,d.detach())),{start:e,end:f}},c1:function(a,b){var c,d,e,f=this.d1(a),g=this.U0(a);f?a.setSelectionRange(b,b):g&&(c=this.e1(a,b),c&&(d=D.getSelection(),e=E.createRange(),e.setStart(c.node.firstChild,c.offset),e.collapse(!0),d.removeAllRanges(),d.addRange(e),this.V4&&(a.parentElement.scrollTop=a.parentElement.scrollHeight)))},text:function(a){var b,c,d,e,f,g=this,h=g.qo,j=g.a1();if(!(!h||j&&j.Js)){if(b=g.d1(h),c=g.U0(h),0===arguments.length)return d="",b?d=h.value:c&&(d=h.textContent),d;null!==a&&void 0!==a||(a=""),a!==g.text()&&(g.S0=g.T0(a),b?h.value=a:c&&g.V0(g.S0),e={},f=v.G0.H0,f&&f._text&&(e={sheet:f.kj,editor:f.I0&&f.I0.firstChild.firstChild,canvasOffset:f.f1}),g.Wq(i,e))}},autoComplete:function(a){return 0===arguments.length?this.g1:void(this.g1=a)},showHelp:function(a){return 0===arguments.length?this.h1:void(this.h1=a)},add:function(a){var b,c;if(a)if(A.isArray(a))for(b=a.length,c=0;c<b;c++)this.Sb(a[c]);else this.Sb(a)},Sb:function(a){var b,c,d,e,f=a&&a.name&&J(a.name);if(f){for(b=this.i1,c=b.length,d=0;d<c;d++){if(e=J(b[d].name),e===f)return;if(e>f)break}b.splice(d,0,a)}},remove:function(a){var b,c,d;if(a)for(a=J(a),b=this.i1,c=b.length,d=0;d<c;d++)if(J(b[d].name)===a){b.splice(d,1);break}},workbook:function(a){var b=this;return 0===arguments.length?b.OC:void(a===w?b.V4&&b.H5():(b.P0(a),b.j1()))},P0:function(a){var b,c;a&&(b=this,b.OC&&b.Y0(),c=b.qo,a&&c&&(b.OC=a))},l1:function(){var a,b,c,d=[],e=this.S0,f=e&&e.length,g=0,h=0;if(f>0)for(c=0;c<f;c++)a=e[c],b=a.text,11===a.type&&d.push({textOffset:g,text:b,ranges:a.ranges,index:h++,allowDrag:a.allowDrag}),g+=b.length;return d},m1:function(){var a,b,c,d,e,f=this.qo,g=this.l1();if(f&&g&&g.length>0)for(a=this.caret(),b=g.length,e=0;e<b;e++){if(c=g[e],d=c.textOffset,d<a&&a<=d+c.text.length)return c;if(d>=a)break}return w},n1:function(a){var b,c,d;return!!a&&(b=this.caret(),c=a.text,d=a.textOffset,d<b&&b<=d+c.length)},o1:function(a){var b,c,d,e,f,g,h,i=this.l1(),j=i.length;if(a<0||j<=a)return"";for(b=[],d=0,e=0;e<j;e++){for(c=i[e],f=!1,g=0;g<b.length;g++)if(b[g].text.replace(/\s+/g,"").toUpperCase()===c.text.replace(/\s+/g,"").toUpperCase()){f=!0;break}if(f){if(a===e){d=g;break}}else if(b.push(c),a===e){d=b.length-1;break}}return h=n,h[d%h.length]},M0:function(){var a,b,c;return!!this.MH||(!!this.V4||(a=this.s1(this.caret()),!!a&&(b=a.type,c=a.text,1===b||8===b||7===b&&"%"!==c||5===b||9===b||15===b)))},t1:function(a){if(!a||!this.MH)return!1;var b=this.W0,c=this.caret(),d=a.textOffset;return b<=d&&d<c},u1:function(){var a,b,c=[],d=this.l1(),e=d.length;if(e>0)for(b=0;b<e;b++)a=d[b],this.t1(a)&&c.push(a);return c},v1:function(a,b,c){var d,e,f,g,h,j,l,m,n,o,p=this,q=p.qo;if(a&&q){if(!p.MH){if(!p.M0())return;b=!1,p.MH=!0,p.W0=p.caret(),p.Wq(k,{})}d=p.W0,e=p.text(),f=p.caret(),e||(e="=",d=p.W0=1,f=1),g=f,c&&(b=!1,e=e.substr(0,d)+e.substr(f),p.S0=p.T0(e),f=d,g=f),h=p.s1(f),b?(j=e.substr(0,f),j=j.substr(0,j.length-h.text.length),j.length>=d&&(h.text=a,g=j.length+a.length)):(l=p.S0,m=u.k.Cb(l,h),f>d?(l.splice(m+1,0,{text:this.w1(),type:8}),l.splice(m+2,0,{text:a,type:11}),a=","+a):p.V4&&l.length>1&&m===l.length-1&&11===h.type?(l.splice(m+1,0,{text:this.w1(),type:8}),l.splice(m+2,0,{text:a,type:11}),a=","+a):l.splice(m+1,0,{text:a,type:11}),g=f+a.length),p.z1(),n={},o=v.G0.H0,o&&o._text&&(n={sheet:o.kj,editor:o.I0&&o.I0.firstChild.firstChild,canvasOffset:o.f1}),p.Wq(i,n),p.caret(g)}},NH:function(){var a=this;a.MH&&(a.MH=!1,a.W0=-1,a.Wq(l,{}))},B1:function(){this.MH=!0,this.W0=this.caret()},C1:function(a){return 0===arguments.length?this.W0:this.W0=a},D1:function(a,b){var c,d,e,f,g,h,j=this,k=j.qo;if(k&&!(a<0)&&b){for(c=!1,d=j.S0,e=d&&d.length,g=0,h=0;h<e;h++)if(f=d[h],11===f.type&&g++===a){d[h]={text:b,type:11},c=!0;break}c&&(j.z1(),j.Wq(i,{}),j.caret(j.text().length))}},j1:function(){var a,b,c,d=this;d.OC&&(a=d.qo,d.OC&&a&&(b=r.Events,a.setAttribute("gcUIElement","gcAttachedFormulaTextBox"),d.V4||(d.OC.CF=d),d.OC.Fu(b.FormulatextboxEditStarted,d,d.E1),d.OC.Fu(b.FormulatextboxEnterCell,d,d.F1),d.OC.Fu(b.FormulatextboxEditEnded,d,d.G1),d.OC.Fu(b.FormulatextboxActiveSheetChanged,d,d.H1),d.OC.Fu(b.FormulatextboxRangeChanged,d,d.I1),d.OC.Fu(b.FormulaTextBoxTextChanged,d,d.J1),d.OC.Fu(b.FormulaTextBoxCaretChanged,d,d.K1),c=M(d.OC),c&&!d.V4&&d.text(d.L1(c,c.Jl,c.Kl)),d.Fu(i,d,d.M1),d.Fu(j,d,d.N1)))},Y0:function(){var a,b=this,c=b.OC;!b.O0&&c&&(a=r.Events,b.V4||(c.CF=null,c.Gu(a.FormulatextboxEditStarted,b.E1),c.Gu(a.FormulatextboxEnterCell,b.F1),c.Gu(a.FormulatextboxEditEnded,b.G1),c.Gu(a.FormulatextboxActiveSheetChanged,b.H1),c.Gu(a.FormulatextboxRangeChanged,b.I1),c.Gu(a.FormulaTextBoxTextChanged,b.J1),c.Gu(a.FormulaTextBoxCaretChanged,b.K1),b.Gu(i,b.M1),b.Gu(j,b.N1)),b.text("")),b.OC=null},O1:function(){var a,b,c=this;c.OG||(c.OG=!0,a=this.OC,b=a&&M(a),b&&!b.isEditing()?(c.V4||b.EF(null,b.Jl,b.Kl,null,null,!1,null),c.Q1=!0):c.Q1=!1,c.OG=!1,c.R1||c.S1())},UF:function(){var a,b,c,d,e,f,g=this,h=g.OC,i=h&&M(h);i&&(a=i.Cw,g.Q1&&a&&(b=a.text(),c=g.text(),c!==b&&(d=g.caret(),e=i.getFormulaInformation(i.getActiveRowIndex(),i.getActiveColumnIndex()),g.text(b),e.isArrayFormula&&(d>=c.length&&(d-=1),d=y(0,d-1)),g.caret(d))),f=i.Px,2!==f&&(i.Px=2,i.Cu(f,2)))},L1:function(a,b,c){var d,e,f,g,h,i="";return a&&(d=a.parent,e=d&&d.options,f=a.getFormulaInformation(b,c),f&&f.hasFormula?(i="="+f.formula,f.isArrayFormula&&(i="{"+i+"}")):(g=a.getActualStyle(b,c),h=a.getValue(b,c),i=G.Il(g,h,a)||"","="===i[0]&&e&&e.allowUserEditFormula&&(i="'"+i))),i},H1:function(a,b){var c,d,e=a.data;e.OG||(c=b.newSheet,e.V4||(e.OG=!0,e.close(),b&&(d=c,e.text(e.L1(d,d.Jl,d.Kl))),e.OG=!1))},E1:function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&M(b),d=c&&c.Cw,d&&e.V4===d.V4&&e.C5===d.C5&&(e.OG=!0,e.text(d.text()),e.OG=!1))},F1:function(a,b){var c=a.data;c.V4||c.OG||(c.OG=!0,b&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1)},I1:function(a,b){var c,d,e,f,g,h=a.data;h.OG||(!b.sheet.Cw||h.V4===b.sheet.Cw.V4&&h.C5===b.sheet.Cw.C5)&&(h.OG=!0,b&&(c=b.sheet,d=b.row,e=b.col,f=b.rowCount,g=b.colCount,new r.Range(d,e,f,g).contains(c.Jl,c.Kl)&&h.text(h.L1(c,c.Jl,c.Kl))),h.OG=!1)},G1:function(a,b){var c=a.data;return c.V4&&c.D5&&c.E5?void(b.ignore=!0):void(c.OG||(c.OG=!0,c.close(),b&&b.sheet.Cw&&c.V4===b.sheet.Cw.V4&&(c.V4?b.sheet.Cw.V4&&c.C5===b.sheet.Cw.C5&&c.text(c.L1(b.sheet,b.row,b.col)):c.text(c.L1(b.sheet,b.row,b.col))),c.OG=!1))},J1:function(a,b){var c,d=a.data;d.OG||(!b.sheet.Cw||d.V4===b.sheet.Cw.V4&&d.C5===b.sheet.Cw.C5)&&(d.OG=!0,b&&(c=d.caret(),d.text(b.text),d.caret(c)),d.OG=!1)},K1:function(a,b){var c=a.data;c.OG||(!b.sheet.Cw||c.V4===b.sheet.Cw.V4&&c.C5===b.sheet.Cw.C5)&&(c.OG=!0,b&&c.caret(b.caret),c.OG=!1)},M1:function(a){var b,c,d,e,f,g,h=a.data;if(!h.OG&&(b=h.OC,c=b&&M(b))){if(h.OG=!0,d=c.Cw,e=c.getCellType(h.rowIndex,h.columnIndex),d){if(h.V4!==d.V4||h.C5!==d.C5)return;f=d.caret(),d.text(h.text()),d.caret(f)}else g={sheet:c,row:h.rowIndex,col:h.columnIndex,sheetArea:3},e.setEditorValue(c.BF,h.text(),g);h.OG=!1}},N1:function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&M(b),c&&c.isEditing()&&(d=c&&c.Cw,(!d||e.V4===d.V4&&e.C5===d.C5)&&(e.OG=!0,d&&(d.caret(e.caret()),e.S1()),e.OG=!1)))},ad:function(a){var b,c,d,e=this;e.T1=!1,e.U1=!1,e.MH=!1,e.W0=-1,e.i1=[],e.g1=!0,e.h1=!0,e.V1=!0,b=C("div"),b.className="gcsj-func-ac-popup",b.style.display="none",b.setAttribute("gcUIElement","gcFuncACPopup"),a.insertBefore(b,w),e.Z0=b,e.R1=!1,c=C("div"),c.className="gcsj-func-help-popup",c.style.display="none",c.setAttribute("gcUIElement","gcFuncHelpPopup"),a.insertBefore(c,w),e.$0=c,e.W1=!1,A(b).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),A(c).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),A(b).bind("scroll",function(){e.X1&&clearTimeout(e.X1),e.X1=setTimeout(function(){e.qo&&e.qo.focus()},100)}),d=C("div"),d.style.display="none",d.setAttribute("gcUIElement","gcFuncHelpDiv"),a.insertBefore(d,w),e._0=d,e.OC=null,e.OG=!1,e.Q1=!1,e.O0=!1},N0:function(a){var b,c,d;a&&(b=this,(b.d1(a)||b.U0(a))&&(c=A(a),b.qo&&b.X0(),b.qo=a,I&&I.msie?(d=parseInt(I.version,10)<10,b.U0(a)||d?(b.Fu("focus",function(){c.data("text-before",b.text())}),b.Fu("click",function(){c.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(a){b.Fu(a,function(){b.Y1()})})):b.Fu("input",function(){b.Z1()})):b.Fu("input",function(){b.Z1()}),b.Fu("keydown",function(a){var c,d,e=a.ctrlKey,f=a.shiftKey,g=a.altKey,h=a.metaKey,i=e||f||g||h,j=a.keyCode;b.U1=!1,!i&&b.R1&&(j===m.down?(b._1(1),H(a)):j===m.up?(b._1(-1),H(a)):j===m.tab&&(b.a2(),H(a))),j===m.esc&&b.close(),b.b2(a),b.V4&&(c=M(b.OC),c.mm.LH(a)&&(d=c.Cw,d&&d.MH&&d.NH()))}),b.Fu("keyup",function(a){if(b.U1&&I&&I.qtMode){var d=b.caret();c.data("caret-before")!==d&&(c.data("caret-before",d),b.Wq(j,{}),b.c2(),b.R1||b.S1())}b.b2(a)}),b.Fu("focus",function(a){var c=I&&I.mozilla;c&&!b.qo.innerText&&(b.qo.innerText=""),b.b2(a),b.V4&&b.D5&&(b.E5=!0,b.j5())}),b.Fu("blur",function(){b.V1&&b.close(),b.V4&&(b.H5(),b.E5=!1)}),b.Fu("mousedown",function(){b.E5=!0,b.O1()}),b.Fu("mouseup",function(){b.UF()}),b.Fu("click",function(a){var c,d,e;b.MH&&b.NH(),c=b.OC,d=c&&M(c),e=d&&d.Cw,e&&e.MH&&(e.V4||e.NH()),b.b2(a)}),b.Fu("compositionstart",function(){b.T1=!0}),b.Fu("compositionend",function(){b.T1=!1,I.edge&&b.Y1()})))},X0:function(){var a,b=this,c=b.qo;c&&(a=A(c),a.removeData("text-before"),a.removeData("caret-before"),b.nu(),b.unbindAll(),b.V4&&(A(b.cga).empty(),b.cga=w),b.qo=w)},Y1:function(){var a=this,b=A(a.qo),c=a.text();b.data("text-before")!==c&&(a.T1||b.data("text-before",c),a.Z1())},b2:function(a){if(I&&I.msie){var b=function(a,b){return function(){a.d2(a,b)}};setTimeout(b(this,a),10)}else this.d2(this,a)},d2:function(a,b){var c,d,e,f,g,h=b.keyCode,i=h===m.left||h===m.right||h===m.home||h===m.end||h===m.pdn||h===m.pup||h===m.tab||h===m.enter;if(a.g1||(i=i||h===m.up||h===m.down),c=void 0!==b.button,i||c){if(d=a.qo,e=A(d),f=a.b1(d),f.start!==f.end)return;g=f.end,e.data("caret-before")!==g&&(e.data("caret-before",g),a.Wq(j,{}),a.S1())}},e2:function(){return this.OC?M(this.OC).Jl:x},f2:function(){return this.OC?M(this.OC).Kl:x},a1:function(){if(this.OC)return M(this.OC)},T0:function(a){var b,c,d=this,e=[];return a&&"="===a[0]?(b=new s.Parser,c=b.parseReferenceExpressionInfos(a,d.a1(),d.e2(),d.f2(),!0),e=d.i2(c)):(e.push({text:a,type:17}),e)},Z1:function(){var a,b=this,c=b.qo,d=A(c);b.U1=!0,b.S0=b.T0(b.text()),b.U0(c)?b.T1||(a=b.caret(),b.V0(b.S0),b.Wq(i,{type:"input"}),b.caret(a)):b.Wq(i,{type:"input"}),a=b.caret(),d.data("caret-before")!==a&&(d.data("caret-before",a),b.Wq(j,{})),b.c2(),b.R1||b.S1()},j2:function(){return u.CultureManager.q4().NumberFormat},h2:function(){var a=this.j2();return a&&a.arrayGroupSeperator||";"},l2:function(){var a=this.j2();return a&&a.arrayListSeparator||","},w1:function(){var a=this.j2();return a&&a.listSeparator||","},g2:function(){var a=this.j2();return a&&a.numberDecimalSeparator||"."},i2:function(a){var b,c,d,e,f=[],g=[],h=this.h2(),i=this.w1(),j=this.l2(),k=!1;for(b=0;b<a.length;b++)b>0&&b<a.length-1&&";"===a[b-1].text&&","===a[b].text&&"ARRAYROW"===a[b+1].text||(c=a[b],d=this.m2(c,g),e=c.text,2===d?f.push({text:e,type:d}):k&&8===d&&","===e?f.push({text:j,type:9}):k&&8===d&&";"===e?f.push({text:h,type:10}):8===d?f.push({text:i,type:d}):3===d?("ARRAY"===e&&(k=!0),f.push({text:"{",type:3})):4===d?"ARRAY"===e?(k=!1,f.push({text:"}",type:4})):f.push({text:e,type:4}):6===d?f.push({text:")",type:d}):13===d?f.push({text:u.o.nb(e),type:d,ranges:c.ranges,allowDrag:c.canDrag}):null!==d&&f.push({text:e,type:d,ranges:c.ranges,allowDrag:c.canDrag}));return f},m2:function(a,b){var c,d=a.type,e=a.subType,f=a.text,g=a.value;if(1===d){if(1===e)return"ARRAY"===f||"ARRAYROW"===f?(b.push(3),3):(b.push(5),"("===g.trim()?5:2);if(2===e){if(")"===g.trim())return 6;if(b.length>0){if(c=b[b.length-1],3===c)return b.pop(),4;if(5===c)return b.pop(),6}}if("="===g.trim())return 1}else if(3===d){if(0===e)return 8}else{if(5===d||6===d||4===d)return 7;if(0===d)return 7===e||0===e?11:5===e?12:4===e?13:3===e?14:6===e?16:14;if(7===d)return 15;if(8===d)return 17}return 17},z1:function(){var a,b,c,d=this,e=d.qo,f=d.S0;if(d.d1(e)){for(a="",b=f&&f.length,c=0;c<b;c++)a+=f[c].text;e.value=a}else d.U0(e)&&d.V0(f)},d1:function(a){var b=a&&a.tagName;return"TEXTAREA"===b||"INPUT"===b},U0:function(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable},bW:function(a){return a&&"="===a[0]},Fu:function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(g+" "),A(d).bind(a+g,b,c))},Gu:function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(g+" "),A(c).unbind(a+g,b))},nu:function(){var a=this.qo;a&&A(a).unbind(g)},Wq:function(a,b){var c=this.qo;c&&A(c).trigger(a,b)},s1:function(a){var b,c,d,e,f;if(a<=0)return w;if(b=this.S0,c=b&&b.length,c>0)for(d=0,f=0;f<c;f++)if(e=b[f],d+=e.text.length,d>=a)return e;return w},n2:function(){var a,b,c=this.OC,d=c&&M(c),e=d&&d.Cw;if(e){for(a=e.i1,b=0;b<a.length;b++)a[b].isFunc=!0;return a.concat(this.o2(c,d)).concat(this.q2(d))}return this.i1},o2:function(a,b){var c,d=[],e=b.getCustomNames();return e&&A.each(e,function(a,b){d.push({name:b.Cj,description:L().Fbx_CustomName_Description+b.Cj})}),c=a.getCustomNames(),c&&A.each(c,function(a,b){d.push({name:b.Cj,description:L().Fbx_CustomName_Description+b.Cj})}),d},q2:function(a){var b,c,d=[],e=a.tables;if(e&&(b=e.all()))for(c=0;c<b.length;c++)d.push({name:b[c].name(),description:L().Fbx_TableName_Description+b[c].name()});return d},s2:function(a,b){var c,d,e,f;for(a=J(a),F.Bb(a,"[")&&(a=a.substr(a.lastIndexOf("[")+1),a=F.Gb(a,"@","")),c=[],d=b&&b.length,f=0;f<d;f++)e=b[f],0===J(e.name).indexOf(a)&&c.push(e);return c},t2:function(){var a,b,c,d,e,f=this.caret();if(f<=0)return"";if(a=this.S0,b=a&&a.length,b>0)for(c=0,e=0;e<b;e++){if(d=a[e],c+d.text.length>=f)return d.text.substring(0,f-c);c+=d.text.length}return""},u2:function(){var a,b,c,d,e,f,g,h,i,j=this.caret(),k=this.S0,l=k&&k.length,m=[],n=0;for(b=0;b<l;b++){if(a=k[b],m.push(a),6===a.type)for(c=0;m.length>0;)if(d=m.pop(),6===d.type&&c++,5===d.type&&c--,0===c){m.length>0&&(d=m[m.length-1])&&2===d.type&&m.pop();break}if(n+=a.text.length,n>=j)break}if(m.length>0){for(e=0;m.length>0;)if(a=m.pop(),8===a.type)e++;else if(2===a.type)break;if(2===a.type)for(f=J(a.text),g=this.n2(),h=g&&g.length,b=0;b<h;b++)if(i=g[b],J(i.name)===f)return{func:i,activeParamterIndex:e,isFunc:i.isFunc}}return w},c2:function(){var a,b,c,d,e,f,g,h,i=this,j=i.v2(),k=i.g1&&i.bW(i.text())&&j&&j.length>0&&!i.MH&&!i.T1;if(k&&!i.V4){for(i.w2(),a=i.Z0,j.length>8?(a.style.height="204px",a.style.overflowY="scroll"):(a.style.height="auto",a.style.overflowY=""),b="",c=j.length,e=0;e<c;e++)d=j[e],b+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+d.isFunc+">"+d.name+"</div><div class='gcsj-func-ac-row-description'>"+(d.description||"")+"</div></div>";f=A(i.Z0),f.html(b).show(),i.R1=!0,g=f.find(".gcsj-func-ac-row"),g.length>0&&(h="gcsj-ac-row-active",A(g[0]).addClass(h),g.bind("mouseover",function(){g.removeClass(h),A(this).addClass(h)}),g.bind("click",function(){i.a2()})),i.SH()}else i.z2()},v2:function(){var a,b,c=this,d=c.s1(c.caret()),e=d&&d.text,f=[],g=c.S0.indexOf(d);if(d&&14===d.type)return f;if(a=c.A2(g),a.length>0){if(f=f.concat(a).concat(L().B2),F.jb(e,"[")||F.jb(e,"[@"))return f}else f=this.n2();return e=c.t2(),b=[],e&&(b=c.s2(e,f)),b},A2:function(a){var b,c,d,e,f,g,h,i,j=[],k=this.S0,l=k&&k.length;if(a<0||a>=k.length)return j;if(b=this.OC,c=b&&M(b),d={},void 0!==a&&a!==w||(a=l),c&&(e=k[a],f=c.tables,g=f&&f.findByName(F.Ib(e.text,"[")),void 0!==g&&g!==w&&!d[g])){for(d[g]=!0,h=0,i="";i!==w;)i=g.getColumnName(h++),i!==w&&j.push({name:i,description:""});if(j.length>0)return j}return j},z2:function(){A(this.Z0).hide(),this.R1=!1},_1:function(a){var b,c,d,e,f,g,h=A(this.Z0).find(".gcsj-func-ac-row"),i=h.length;if(0!==i){if(b="gcsj-ac-row-active",c=0,a)for(d=0;d<i;d++)if(A(h[d]).hasClass(b)){c=d+a;break}e=A(this.Z0).scrollTop(),h.removeClass(b),f=0,i>0&&(f=h[0].offsetHeight),c=y(c,0),c=z(c,i-1),g=h[c],A(g).addClass(b),g.offsetTop+g.offsetHeight>A(this.Z0).scrollTop()+A(this.Z0).height()?A(this.Z0).scrollTop(A(this.Z0).scrollTop()+f):g.offsetTop<A(this.Z0).scrollTop()?A(this.Z0).scrollTop(g.offsetTop):A(this.Z0).scrollTop(e)}},a2:function(){var a,b,c,d,e,f,g,h,j,k,l,m,n,o=this,p=A(o.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),q=p.text(),r="true"===p.attr("isFunc");if(q){for(a=o.caret(),b=o.S0,c=b&&b.length,d=0,e=0,f=0,g=w;f<c&&(g=b[f],e=g.text.length,!(d+e>=a));)f++,d+=e;h=a-d,j=g.text,k=0,l=0,F.Bb(j,"[")?(k=j.lastIndexOf("[",h-1),k===-1?(k=j.indexOf("["),k===-1?g.text=q:g.text=q+j.substr(k),k=0):(k++,"@"===j.charAt(k)&&(k+=1),l=j.indexOf("]",h),l===-1&&(l=j.length),g.text=j.substring(0,k)+q+j.substr(l))):g.text=q,r?g.type=2:g.type=11,m=f+1,n=b[m],!r||n&&5===n.type||b.splice(m,0,{text:"(",type:5}),o.z2(),o.qo.focus(),o.z1(),o.caret(d+q.length+k+(r?1:0)),o.S1(),o.S0=o.T0(o.text()),o.Wq(i,{})}},S1:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;if(r.R1&&r.z2(),a=r.u2(),a===w||a.isFunc!==!0)return void r.w2();if(b=r.w1(),c=r.h1&&r.bW(r.text())&&a&&!r.MH&&!r.T1,c&&!r.V4){for(d=a.func,e=d.parameters,f=e&&e.length,g=z(f-1,a.activeParamterIndex),i="",j=0;j<f;j++)h=e[j],k=h.name,h.repeatable&&(k+=b+"..."),h.optional&&(k="["+k+"]"),l=j===f-1?"":b+" ",k=j===g?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+k+"</span>"+l:"<span class='gcsj-func-help-paramter'>"+k+"</span>"+l,i+=k;m="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+d.name+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+i+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",n="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+L().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(d.description||"")+"</div></div>",o="<div class='gcsj-func-help-section-content'>"+n+"</div>",p="<div class='gcsj-func-help-body'>"+o+"</div>",q=m+p,A(r.$0).html(q).show(),r.W1=!0,r.SH()}else r.w2()},w2:function(){A(this.$0).hide(),this.W1=!1},close:function(){this.z2(),this.w2()},BH:function(a){if(this.MH)return!1;var b=a.ctrlKey||a.shiftKey||a.altKey||a.metaKey,c=a.keyCode;return this.R1&&!b&&(c===m.down||c===m.up||c===m.tab)},SH:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=w;if(p.R1?q=p.Z0:p.W1&&(q=p.$0),q){if(a=A(p.qo),b=A(q),c=v.G0.H0,c&&c.kj)return d=c.kj.getCellRect(c.nT,c.Mk),e=c.f1,void b.css("top",d.y+d.height+e.top).css("left",d.x+e.left);f=a.parent(),g=a.outerHeight(),"TEXTAREA"===p.qo.tagName&&"gcEditingInput"===a.attr("gcUIElement")&&(f=f.parent(),g=f.outerHeight()),h=f.css("top"),i=parseFloat(h),isNaN(i)||(h=i),j=f.css("left"),"auto"===h&&(h=a.offset().top,j=a.offset().left),k=h+g,l=A(E.body).outerHeight(),m=b.outerHeight(),n=k+m,n>l&&(o=h-m,o>=0&&(k=o)),b.css("top",k).css("left",j)}},focus:function(){A(this.qo).focus()},V0:function(a){var b,c,d,e,f=this,g="",h="",i=a&&a.length,j=0;for(c=0;c<i;c++)b=a[c],d="",11===b.type&&(d=" style='color: "+f.o1(j++)+"'"),g+="<span"+d+" class='gcsj-func-color-text'>"+A(f._0).text(b.text).html()+"</span>",h+=b.text;if(h||f.text())if(e=f.qo,g)e.innerHTML="<span class='gcsj-func-color-content'>"+g+"</span>";else for(;e.firstChild;)e.removeChild(e.firstChild)},e1:function(a,b){var c,d,e,f=A(a).find(".gcsj-func-color-content .gcsj-func-color-text"),g=f.length;if(g>0){for(b=y(0,b),e=0;e<g;e++)if(c=f[e],d=c.textContent,b-=d.length,b<=0)return{node:c,offset:d.length+b};return{node:c,offset:d.length}}return w}},b}(),v.FormulaTextBox=q,a.exports=v},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.CalcEngine},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){var d=c(2),e=c(3),f=d.CalcEngine,g=c(1),h=d.kf,i=d.GC$,j=i.extend,k=null,l=Math.max,m=Math.min,n=g.L0,o=g.C2;j(d.iI.prototype,{D2:function(a){var b,c,d,e,f,g,i,j,k,l,m,n,p,q,r,s,t=this,u=t.kj,v=u.Cw;v&&(b=u.frozenRowCount(),c=u.frozenColumnCount(),d=v.MH,d&&t.E2||(t.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),e=u.getRowCount(),f=u.getColumnCount(),g=a.hitTestType,i=a.row,j=a.col,k=t.shift,l=t.ctrl,m=t.E2,n=m.anchorRow,p=m.anchorCol,q=-1,r=-1,0===g?(q=b?u.ar():u.lq,r=c?u.$q():u.qq,s=h(-1,-1,-1,-1),v.v1(o(u,s),k,!l),t.OG=!0):1===g?(q=b?u.ar():u.lq,r=j,s=u.Jx(0,j,e-1,j),k&&p>=0&&(s=u.Jx(0,j,e-1,p)),s=h(-1,s.col,-1,s.colCount),v.v1(o(u,s),k,!l),t.OG=!0):2===g?(q=i,r=c?u.$q():u.qq,s=u.Jx(i,0,i,f-1),k&&n>=0&&(s=u.Jx(i,0,n,f-1)),s=h(s.row,-1,s.rowCount,-1),v.v1(o(u,s),k,!l),t.OG=!0):3===g&&(q=i,r=j,s=u.Jx(i,j,i,j),s=h(s.row,s.col,1,1),k&&n>=0&&p>=0&&(s=u.Jx(i,j,n,p)),v.v1(o(u,s),k,!l),t.OG=!0),t.DG=t.OG,k&&d||(m.anchorRow=q,m.anchorCol=r,m.leadingRow=q,m.leadingCol=r),t.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},t.qG())},F2:function(a){var b,c,e=!1,f=g.G0.H0;if(f&&f.I0)if(b=f.kj,c=a.Cw,c&&b.setFormula(f.nT,f.Mk,c.text()),b!==a){if(d.Commands.Wx.G2(b),!b.endEdit())return;e=!0}else c&&(c.destroy(),a.Cw=k),f.$b();return e},EG:function(){var a,b=this,c=b.rG;c&&b.OG&&(a=c.sG,3===a?b.H2():2===a?b.I2():1===a&&b.J2())},H2:function(){var a,b,c,d,e=this,f=e.E2,g=f.anchorRow,h=f.anchorCol,i=e.fH(),j=e.gH();g>=0&&h>=0&&i>=0&&j>=0&&(a=e.kj,b=a.Jx(i,j,g,h),c=o(a,b),c&&(d=a.Cw,d.v1(c,!0,!1))),e.NG()},I2:function(){var a,b,c,d,e=this,f=e.E2.anchorRow,g=e.fH();f>=0&&g>=0&&(a=e.kj,b=a.Jx(g,0,f,a.getColumnCount()-1),b=h(b.row,-1,b.rowCount,-1),c=o(a,b),c&&(d=a.Cw,d.v1(c,!0,!1))),e.NG()},J2:function(){var a,b,c,d,e=this,f=e.E2.anchorCol,g=e.gH();f>=0&&g>=0&&(a=e.kj,b=a.Jx(0,g,a.getRowCount()-1,f),b=h(-1,b.col,-1,b.colCount),c=o(a,b),c&&(d=a.Cw,d.v1(c,!0,!1))),e.NG()},yH:function(){var a=this;a.RG(),a.rG=k,a.OG=!1,a.DG=!1},iG:function(a){var b,c,d,e,f,g,h,i,j=this,k=j.kj,l=k.Cw,m=a.formulaRangeHitInfo;m&&m.inBorder&&l&&(l.MH&&l.NH(),l.close(),b=m.paramRange,c=b&&b.text,c&&(d=n(k,c),d&&(e=k.Tq(d),f=a.row,g=a.col,f<e.row&&(f=e.row),f>=e.row+e.rowCount&&(f=e.row+e.rowCount-1),g<e.col&&(g=e.col),g>=e.col+e.colCount&&(g=e.col+e.colCount-1),h=f-e.row,i=g-e.col,j.OG=!0,j.FG=!0,j.K2={paramRange:b,fromRange:d,rowOffset:h,colOffset:i},j.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},j.qG())))},GG:function(){var a,b,c,d,e,f,g,i,j,k,n,p,q,r,s,t,u,v,w,x,y,z=this;z.OG&&z.FG&&(a=z.fH(),b=z.gH(),a>=0&&b>=0&&(c=z.K2,d=c.fromRange,e=c.rowOffset,f=c.colOffset,g=c.toRow,i=c.toCol,j=a,k=b,j===g&&k===i||(c.toRow=j,c.toCol=k,n=z.kj,p=n.getRowCount(),q=n.getColumnCount(),r=d.row,s=d.col,t=d.rowCount,u=d.colCount,v=r<0?-1:l(0,m(p-t,a-e)),w=s<0?-1:l(0,m(q-u,b-f)),x=o(n,h(v,w,t,u)),x&&(y=n.Cw,y.D1(c.paramRange.index,x)))),z.NG())},zH:function(){var a=this;a.RG(),a.OG=!1,a.FG=!1,a.K2=k},jG:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this,o=m.kj,p=o.Cw,q=a.formulaRangeHitInfo;if(q&&p&&(p.MH&&p.NH(),b=q.paramRange,c=b&&b.text,b&&c&&(d=n(o,c)))){if(e=d.row,f=d.row<0?-1:d.row+d.rowCount-1,
g=d.col,h=d.col<0?-1:d.col+d.colCount-1,q.inTopLeft)i=f,j=h,k=e,l=g;else if(q.inTopRight)i=f,j=g,k=e,l=h;else if(q.inBottomLeft)i=e,j=h,k=f,l=g;else{if(!q.inBottomRight)return;i=e,j=g,k=f,l=h}m.OG=!0,m.HG=!0,m.L2={paramRange:b,anchorRow:i,anchorCol:j,toRow:k,toCol:l},m.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},m.qG()}},kG:function(a,b){var c=a.Cw;return c&&c.M0()?(this.D2(b),!0):!!this.F2(a)},IG:function(){var a,b,c,d,e,f,g,i,j,k,n,p,q,r,s,t,u,v,w,x,y=this;y.OG&&y.HG&&(a=y.fH(),b=y.gH(),a>=0&&b>=0&&(c=y.L2,d=c.anchorRow,e=c.anchorCol,f=c.toRow,g=c.toCol,i=a,j=b,i===f&&j===g||(c.toRow=i,c.toCol=j,k=y.kj,n=k.getRowCount(),p=k.getColumnCount(),q=d<0?n-1:d,r=e<0?p-1:e,s=m(q,i),t=m(r,j),u=l(q,i)-s+1,v=l(r,j)-t+1,0===s&&u===n&&(s=-1,u=-1),0===t&&v===p&&(t=-1,v=-1),w=o(k,h(s,t,u,v)),w&&(x=k.Cw,x.D1(c.paramRange.index,w)))),y.NG())},AH:function(){var a,b,c=this;c.RG(),c.OG=!1,c.HG=!1,c.L2=k,a=c.kj.Cw,a.V4&&(a.W0=1,b=a.text().lastIndexOf(",",a.caret()),b!==-1&&(a.W0=b+1))},vr:function(a,b,c){var d,e,f,h,i,j,l,m,o,p,q,r,s=this.kj,t=s.Cw,u=t&&t.l1();if(!u||0===u.length)return k;if(d=a.rowViewportIndex,e=a.colViewportIndex,this.qH(d,e,b,c))return k;for(j=u.length-1;j>=0;j--)if(f=u[j],f.allowDrag!==!1&&(l=g.G0.H0,(!l||!l._text)&&(h=n(s,f.text)))){if(i=s.getRangeRect(d,e,h),m=5,o=i.x-2,p=i.x+i.width+1-m,q=i.y-2,r=i.y+i.height+1-m,o+m<=b&&b<p&&(q+1<=c&&c<=q+3||r+1<=c&&c<=r+3))return{paramRange:f,inBorder:!0};if(q+m<=c&&c<r&&(o+1<=b&&b<=o+3||p+1<=b&&b<=p+3))return{paramRange:f,inBorder:!0};if(p<=b&&b<p+m&&r<=c&&c<r+m)return{paramRange:f,inBottomRight:!0};if(o<=b&&b<o+m&&r<=c&&c<r+m)return{paramRange:f,inBottomLeft:!0};if(p<=b&&b<p+m&&q<=c&&c<q+m)return{paramRange:f,inTopRight:!0};if(o<=b&&b<o+m&&q<=c&&c<q+m)return{paramRange:f,inTopLeft:!0}}return k},ly:function(){var a,b,c,d,g,h,i,j,l,m,n,o,p,q,r=this,s=r.kj,t=s.Cw;if(t)if(a=s.Jl,b=s.Kl,c=s.parent,d=c&&1===c.options.referenceStyle,g=new f.SheetParserContext(s,d,e.pf(a,b)),h=new e.Parser,t.MH)for(l=t.u1(),m=0;m<l.length;m++){i=l[m];try{j=h.parse(g,i.text)}catch(a){j=k}j&&1===j.type&&(n=!j.sf,r.M2(j,a,b,n,n),t.D1(i.index,h.unparse(g,j)))}else{if(i=t.m1(),!i)return;try{j=h.parse(g,i.text)}catch(a){j=k}if(!j)return;1!==j.type||j.sf?1===j.type&&(r.N2(j,a,b),t.D1(i.index,h.unparse(g,j))):(o=i.textOffset+i.text.lastIndexOf(":"),p=t.caret()<=o,p?(r.M2(j,a,b,!0,!1),q=h.unparse(g,j),t.D1(i.index,q),t.caret(i.textOffset+q.lastIndexOf(":"))):(r.M2(j,a,b,!1,!0),t.D1(i.index,h.unparse(g,j))))}},M2:function(a,b,c,d,e){var f,g,h=a.rowRelative,i=a.columnRelative;d&&(h&&i?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):h?(a.columnRelative=!0,a.column-=c):i?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)),f=a.endRowRelative,g=a.endColumnRelative,e&&(f&&g?(a.endRowRelative=!1,a.endColumnRelative=!1,a.endRow+=b,a.endColumn+=c):f?(a.endColumnRelative=!0,a.endColumn-=c):g?(a.endRowRelative=!0,a.endColumnRelative=!1,a.endRow-=b,a.endColumn+=c):(a.endColumnRelative=!0,a.endColumn-=c))},N2:function(a,b,c){var d=a.rowRelative,e=a.columnRelative;d&&e?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):d?(a.columnRelative=!0,a.column-=c):e?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)}})},function(a,b,c){var d,e=c(2),f=c(1),g=void 0,h=e.Commands,i=e.kf,j=f.C2,k=f.L0,l=f.K0,m=c(4),n=m.j.Fa;function o(a){var b,c=a.Cw,d=a.mm;return b=c.MH?d.E2:d.E2={anchorRow:a.Jl,anchorCol:a.Kl,leadingRow:a.Qr,leadingCol:a.Rr}}function p(a,b,c,d,e){var f,g,h,k,l,m,p,q,r,s,t,u,v=a.Cw,w=a.parent,x=w&&w.options;if(v&&v.M0()&&x&&x.allowUserEditFormula&&x.enableFormulaTextbox){switch(f=o(a),g=f.anchorRow,h=f.anchorCol,k=f.leadingRow,l=f.leadingCol,n(d)&&(d=g),n(e)&&(e=h),m=a.mm,b){case 3:t=a.iy(d,e,c,k);break;case 4:t=a.hy(d,e,c,k);break;case 1:t=a.HJ(d,e,c,l);break;case 2:t=a.LJ(d,e,c,l);break;case 5:t=a.OJ();break;case 6:t=a.NJ()}t&&(p=t.row,q=t.col,r=t.leadingCellRow?t.leadingCellRow:p,s=t.leadingCellCol?t.leadingCellCol:q,a.IJ(p,q)&&(f.anchorRow=p,f.anchorCol=q,f.leadingRow=r,f.leadingCol=s,u=j(m.kj,new i(p,q,1,1)),u&&v.v1(u,!1,!0),p>=0&&q>=0&&a.Yq(p,q)))}}function q(a,b){if(a){if(2===a.Px)return!1;var c=a.Cw;return c&&c.M0()?(p(a,b,!1),!0):(c&&(a=d.O2(a)),a.yx(b,!1),!0)}return!1}function r(a,b,c,e){if(a){if(2===a.Px)return!1;var f=a.Cw;return f&&f.M0()?(p(a,b,!1,c,e),!0):(f&&(a=d.O2(a)),a.yx(b,!1,c,e),!0)}return!1}function s(a,b,c){var d,e,f,g,h,l,m,n,p=a.Cw,q=a.parent,r=q&&q.options;p&&p.M0()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(d=a.mm,e=o(a),f=e.anchorRow,g=e.anchorCol,p.MH?(l=p.m1(),h=k(a,l.text)):h=i(f,g,1,1),h&&(m=a.UJ(h,b,c,f,g),n=j(d.kj,m),n&&p.v1(n,!0,!1)))}function t(a,b,c){if(a){if(2===a.Px)return!1;var e=a.Cw;return e&&e.M0()?(s(a,b,c),!0):(e&&(a=d.O2(a)),!!a.endEdit()&&(a.Sx(b,c),!0))}return!1}h.Ox=q,h.Qx=r,h.Rx=t,d=function(){function a(){}return a.fv=function(b){return a.O2(b)},a.Xx=function(b){return a.O2(b)},a.Yx=function(b){return a.O2(b)},a.O2=function(b){var c=b,d=f.G0.H0;return d&&d._text&&(c=d.kj,a.G2(c)),c},a.G2=function(a,b){var c,d;void 0===b&&(b=!0),c=a.parent,d=f.G0.H0,d&&d._text&&c.hw(a,b)},a.Zx=function(b,c,d){var e,f,g=!1,h=b.Cw;return h&&h.M0()?(e=o(b),e.anchorRow=c,e.leadingRow=c,f=j(b,i(e.anchorRow,e.anchorCol,1,1)),f&&h.v1(f,!1,!0),b.mq(d),g=!0):h&&(b=a.O2(b)),{sheet:b,r:g}},a._x=function(b,c,d){var e,f,g=!1,h=b.Cw;return h&&h.M0()?(e=o(b),e.anchorRow=c,e.leadingRow=c,f=j(b,i(e.anchorRow,e.anchorCol,1,1)),f&&h.v1(f,!1,!0),b.mq(d),g=!0):h&&(b=a.O2(b)),{sheet:b,r:g}},a.ay=function(b){var c=!1,d=b.Cw,e=b.Jl,f=b.Kl;return d&&d.M0()?(d.MH||(b.mm.E2={anchorRow:e,anchorCol:f,leadingRow:b.Qr,leadingCol:b.Rr}),p(b,5,!1,e,f),c=!0):d&&(b=a.O2(b)),{sheet:b,r:c}},a.by=function(b){var c=!1,d=b.Cw,e=b.Jl,f=b.Kl;return d&&d.M0()?(d.MH||(b.mm.E2={anchorRow:e,anchorCol:f,leadingRow:b.Qr,leadingCol:b.Rr}),p(b,6,!1,e,f),c=!0):d&&(b=a.O2(b)),{sheet:b,r:c}},a.ey=function(b){return a.O2(b)},a.gy=function(b){return a.O2(b)},a.jy=function(b){var c,d,e=f.G0.H0;f&&e&&e._text&&(b=e.kj,c=e.nT,d=e.Mk,a.G2(b,!1),l(b),b.Sr(c,d,g,g,1))},a}(),e.Commands.Wx=d},function(a,b,c){var d=c(2),e=d.GC$,f=c(1),g=null,h=void 0,i=function(){function a(){var a=this;a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.kj=null,a.MH=!1,a.R2=-1,a.I0=null,a.OC=null,a.f1=null}return a.prototype={constructor:a,$b:function(){var a=this;a.S2(),a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.MH=!1,a.R2=-1,a.kj=null,a.OC=null,a.f1=null},S2:function(){var a,b,c=this;c.kj.Js||(a=c.kj.getCellType(c.nT,c.Mk),b={sheet:c.kj,row:c.nT,col:c.Mk,sheetArea:3},c.I0&&c.I0.firstChild&&a.deactivateEditor(c.I0.firstChild.firstChild,b)),e(c.I0).remove(),c.I0=null},T2:function(a){var b=this;a.Cw&&(b._text=a.Cw.text(),b.nT=a.getActiveRowIndex(),b.Mk=a.getActiveColumnIndex(),b.Q2=a.Cw.caret(),b.MH=a.Cw.MH,b.R2=a.Cw.C1(),b.V4=a.Cw.V4,b.C5=a.Cw.C5,b.kj=a,b.OC=a.parent,b.f1=a.mm.bG())},VF:function(a){var b=this;a.Cw&&(b._text=a.Cw.text(),b.Q2=a.Cw.caret(),b.MH=a.Cw.MH,b.R2=a.Cw.C1())},U2:function(a){var b=this;a.Cw&&(a.Cw.V4=b.V4,a.Cw.C5=b.C5,a.Cw.text(b._text),a.Cw.caret(b.Q2),b.MH&&(a.Cw.B1(),a.Cw.C1(b.R2)))},V2:function(a){var b,c=a.oldSheet,d=a.newSheet,e=this,f=c.Cw;if(f)if(f.close(),(!e.kj||e.kj.Js)&&f.M0()||e.C5!==f.C5){e.T2(c),b=c.getValue(c.Jl,c.Kl,3),c.suspendEvent();try{if(!c.endEdit(!0))return}finally{c.resumeEvent()}c.setValue(c.Jl,c.Kl,b,3,!0),c.Px=1,a.needTriggerSheetChange=!1}else e._text&&e.kj===d?(e.VF(c),f.destroy(),c.Cw=g,a.needTriggerSheetChange=!1):e._text&&e.kj!==d&&(e.VF(c),f.destroy(),c.Cw=g,a.needTriggerSheetChange=!1)},W2:function(a){var b,c=a.oldSheet,d=a.newSheet,e=this;d.Js||(e.I0&&""===e._text&&(c.GJ(),e.$b()),e._text&&e.kj===d?(d.Px=0,d.Sr(e.nT,e.Mk,h,h,0),d.suspendEvent(),e.V4?(b=f.W4(d.parent.qo),f.J0(d,b),d.Px=2,d.yl.uH()):d.startEdit(!1),d.resumeEvent(),e.U2(d),e.VK(d,e.nT,e.Mk),c.GJ(),e.$b()):e._text&&!e.I0?(d.Px=1,c.Px=1,e.X2(d),d.EJ()):e._text&&e.kj!==d&&(d.Px=1,c.Px=1,e.X2(d),c.GJ(),d.EJ()))},X2:function(a){var b,c,d,h,i,j,k,l,m,n,o=this,p=o.kj;p.Js||(b=o.nT,c=o.Mk,d=p.getCellType(b,c),h={sheet:p,row:b,col:c,sheetArea:3,canvasOffset:this.f1},i=d.isImeAware(h),i&&(a.Px=1,j=d.a5(h),o.I0&&o.S2(),o.I0=j,e(j).css("position","absolute"),k=p.getCellRect(b,c),e(j).attr("id","across"),l=p.getActualStyle(b,c),d.d5(j,l,k,h),m=o.OC&&o.OC.getHost()||document.body,m.insertBefore(j,g),n=d.getEditingElement(),o.V4&&e(j).css({display:"none"}),f.J0(a,n),j.firstChild&&!o.V4&&d.focus(j.firstChild.firstChild),o.U2(a),d.g5(j,l,k,h)))},VK:function(a,b,c){var d,e=a.getCellType(b,c),f=a.BF,g=a.am(),h=a.getActualStyle(b,c),i=a.getCellRect(b,c);i&&i.width>0&&i.height>0&&i.x>=g.kt&&i.y>=g.nt&&i.x+i.width<=g.lt+g.js&&i.y+i.height<=g.ot+g.gs&&(d={sheet:a,row:b,col:c,sheetArea:3},f&&f.parentNode&&e.g5(f.parentNode.parentNode,h,i,d,!0))}},a}(),j=function(){function a(){}return a.Q0=function(a,b){f.G0.H0||(f.G0.H0=new i),f.G0.H0.V2(b)},a.R0=function(a,b){f.G0.H0.W2(b)},a}();f.G0=j,a.exports=f},function(a,b,c){var d=c(2),e=c(4),f=c(1),g=d.GC$,h=g.extend,i=e.u,j=f.L0;h(d.oJ.prototype,{uH:function(){var a,b,c=this,d=c.kj;d.Xq>0||(a=d.am(),b=c.bm(),c.Mx(a.x,a.y,a.width,a.height),c.Pw(b))}}),d.Worksheet.$n("formulatextboxrender",{paintAdornment:function(a){var b,c,d,e=this,f=a.ctx,g=a.clipRect,h=e.yl,i=e.am(),j=e.Cw;if(j)for(c=0;c<=2;c++)for(d=0;d<=2;d++)b=i.Ft(c,d),b&&0!==b.width&&0!==b.height&&k(h,f,c,d,g)}});function k(a,b,c,d,g){var h,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=a.kj,L=K.mm,M=K.Cw,N=M&&M.l1(),O=N&&N.length;if(!(O<=0)&&(h=a.VI(c,d,g))){for(b.save(),b.rect(h.x,h.y,h.width,h.height),b.clip(),b.beginPath(),k=[],l=L.isFormulaRangeHoving,m=L.tH,n=L.FG,o=L.K2,p=L.HG,q=L.L2,w=0;w<O;w++)if(r=N[w],s=r.text,t=r.ranges&&r.ranges.length>0?r.ranges:[j(K,s)]){if(x=f.G0.H0,x&&x.kj)if(i.Bb(s,"!")){if(y=i.Ib(s,"!"),K.name()!==y&&"'"+K.name()+"'"!==y)continue}else if(z=i.Ib(s,"["),A=K.tables,!(K.getCustomNames()[z]||A&&A.findByName(z)))continue;for(u=a.XI(c,d,t,h),B=0;B<u.length;B++)C=u[B],C&&C.width>0&&C.height>0&&(v=M.o1(w),M.t1(r)?(l&&m.paramRange.index===w&&(b.beginPath(),b.lineWidth=2,b.strokeStyle=v,b.rect(C.x+1,C.y+1,C.width-3,C.height-3),b.stroke()),a.fJ(b,C,v)):l&&m.paramRange.index===w||n&&o.paramRange.index===w||p&&q.paramRange.index===w?(b.beginPath(),b.lineWidth=2,b.strokeStyle=v,b.rect(C.x+1,C.y+1,C.width-3,C.height-3),b.stroke()):(b.beginPath(),b.lineWidth=2,b.strokeStyle=v,b.rect(C.x,C.y,C.width-1,C.height-1),b.stroke()),M.n1(r)&&(D=e.pc.ec(v),D.a=.1,b.beginPath(),b.fillStyle=e.pc.bc(D),b.fillRect(C.x+1,C.y+1,C.width-3,C.height-3)),k.push({rect:C,color:v,allowDrag:r.allowDrag}))}if(k.length>0)for(E=k.length,w=0;w<E;w++)C=k[w].rect,v=k[w].color,F=5,G=C.x-2,H=C.x+C.width+1-F,I=C.y-2,J=C.y+C.height+1-F,k[w].allowDrag!==!1&&(x=f.G0.H0,x&&x._text||(b.beginPath(),b.fillStyle=v,b.fillRect(G,I,F,F),b.fillRect(H,I,F,F),b.fillRect(G,J,F,F),b.fillRect(H,J,F,F)));b.beginPath(),b.restore()}}},function(a,b){function c(a,b){return{name:a,description:b}}a.exports={Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",B2:[c("#All","Returns the entire contents of the table, or specified table columns including column headers, data and total rows."),c("#Data","Returns the data cells of the table or specified table columns."),c("#Headers","Returns the columns headers for the table, or specified table columns."),c("#Totals","Returns the total rows for the table or specified table columns."),c("@","This row.")]}}]);