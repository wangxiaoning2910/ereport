/*!
 * 
 * Spread.Sheets Library 10.0.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/spreadjs/eula/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Comments=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){var d=c(1);c(4),c(5),a.exports=d},function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=c(2),r=q.Commands,s=q.Worksheet,t=null,u=void 0,v=Math.max,w=Math.min,x=Math.floor,y=Math.atan2,z=Math.abs,A="default",B=q.GC$,C=B.extend,D=q.Ul.Nl,E=c(3),F=E.k,G="comment",H=q.Vl,I=q.En,J=q.Ul,K=q.Events,L=J.nl,M=J.Rl,N=parseFloat,O=E.u,P=q.Bn,Q=document,R="mouse",S="move",T=R+"down",U=R+S,V=R+"up",W=R+"wheel",X="DOMMouseScroll",Y="left",Z="top",$="right",_="bottom",aa="width",ba="height",ca="position",da="absolute",ea="overflow",fa="visible",ga="z-index",ha="hidden",ia="box-sizing",ja="content-box",ka="padding",la="px",ma="div",na=".comment",oa=".floatBlockCanvas",pa=".hostContainer",qa=".lineCanvasContainer",ra=".host",sa=".editor",ta="gc-spread-",ua="className",va="cursor",wa="text",xa=701,ya=898,za="gc-no-user-select",Aa=" ",Ba="unselectable",Ca="on",Da="comment_editor",Ea="comment_indicator",Fa="font-family",Ga="font-style",Ha="font-size",Ia="font-weight",Ja="color",Ka="background-"+Ja,La=wa+"-align",Ma=wa+"-decoration",Na="textArea",Oa=".lineCanvas",Pa=".commentDocument",Qa="-resize",Ra="line-height";function Sa(a,b){return new q.Point(a,b)}function Ta(a,b,c,d){return new q.Rect(a,b,c,d)}function Ua(a){return a.height}function Va(a){return a.width}function Wa(a,b){var c=a.options;return!c.isProtected||c.protectionOptions.allowEditObjects||b&&!b.locked()}C(s.prototype,{RP:function(a){var b,c,d,e,f,g=this,h=g.nQ();if(!g.fI)for(b=g.am(),d=0;d<=2;d++)for(e=0;e<=2;e++)c=b.Ft(d,e),c&&0!==Va(c)&&0!==Ua(c)&&(a&&!c.intersectRect(a)||(f=g.comments,h&&f&&h.fT(f)))}}),d=q.CellRange,d.prototype.comment=function(a){var b=this,c=b.sheet,d=b.row,e=b.col;return 0===arguments.length?c.comments.get(d,e):(a instanceof m&&c.comments.Cz(d,e,a),b)},e=function(a,b){var c=b.comments;a.bind(T+na,function(){c.vQ()}).bind(W+na,function(a){f(b,a)}).bind(U+na,function(a){f(b,a)})},f=function(a,b){var c=a.Vs(),d=a.hitTest(b.pageX-c.left,b.pageY-c.top);d&&$a(a,d)},g=function(a){a.unbind(T+na).unbind(W+na).unbind(U+na)},h={init:function(){var a=this;a.comments=new o(a),a.nQ=function(){var b=a.parent;if(b)return b.gT||(b.gT=new p(b.xv())),b.gT.kj=a,a.parent.gT}},dispose:function(){var a,b=this.comments;b&&(a=b.all(),a.forEach(function(a){b.hT(a)})),g(B(this.Ws()))},setHost:function(a){if(a){var b=this,c=".comment";b.bind(K.TopRowChanged+c,function(){b.comments.cQ()}),b.bind(K.LeftColumnChanged+c,function(){b.comments.cQ()}),e(a,b)}},onLayoutChanged:function(a){var b=this,c=b.comments,d=a.changeType,e=a.row,f=a.rowCount,g=a.col,h=a.colCount;"addRows"===d?c.rI(e,f):"deletingRows"===d?c.GR(e,f):"addColumns"===d?c.tI(g,h):"deletingColumns"===d?c.HR(g,h):3===a.sheetArea&&("clear"===d?4===(4&a.type)&&c.clear(new q.Range(e,g,f,h)):"addSpan"===d?Xa.call(b,!0,e,g,f,h):"removeSpan"===d&&Xa.call(b,!1,e,g))},paint:function(a){this.comments.iT()||(Ya.call(this),this.RP(a.clipRect))},paintCell:function(a){a.isPrinting||3!==a.sheetArea||Za.call(this,a.ctx,a.sheetArea,a.cell)},toJson:function(a){var b=this.comments;a.comments=b.toJSON()},fromJson:function(a,b){if(a){var c=b?a.commentManager:a.comments;c&&this.comments.fromJSON(c,b)}},lastNonNullRowAndCol:function(){var a,b,c,d,e=0,f=0,g=this.comments;if(g&&(a=g.jT,a&&a.length>0))for(b=0,c=a.length;b<c;b++)d=a[b],d&&d.kT&&(d.lT>e&&(e=d.lT),d.mT>f&&(f=d.mT));return{lastNonNullRow:e,lastNonNullCol:f}},clearSelection:function(){var a=this.comments;a&&a.vQ()},processKeyDown:function(a){var b=this,c=b.comments&&b.comments.JU();c&&b.mm.LH(a.e)&&(c.commentState(2),a.r=!0)}};function Xa(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.comments;if(a&&m)for(g=m.all(),h=0;h<g.length;h++)f=g[h],i=f.nT,j=f.oT,i===b&&j===c||i>=b&&i<b+d&&j>=c&&j<c+e&&m.remove(i,j);f=m.get(b,c),f&&(k=m.pT(f),k&&k.qT())}function Ya(){var a=this,b=a.nQ();b&&b.rT(a)}function Za(a,b,c){var d=this,e=d.nQ();e&&e.sT(a,b,c)}function $a(a,b){var c,d=-1,e=-1;if(b&&b.rowViewportIndex>=0&&b.colViewportIndex>=0&&(d=b.row,e=b.col),a.parent){if(d<0||e<0)return;c=a.comments.get(d,e),a.comments&&a.comments.tT(c)}}function _a(a,b){return a&&a.getRowHeight(b)}function ab(a,b){return a&&a.getColumnWidth(b)}function bb(a,b){return a&&a.getViewportLeftColumn(b)}function cb(a,b){return a&&a.getViewportTopRow(b)}s.$n("comments",h),i={init:function(){r.uT(this.commandManager())}},q.Workbook.$n("comments",i),K.CommentChanged="CommentChanged",j={active:1,edit:2,normal:3},k={alwaysShown:1,hoverShown:2},l=function(){function a(a,b,c,d){var e=this;arguments.length<=1?e[Z]=e[$]=e[_]=e[Y]=a||0:(e[Z]=a,e[$]=b,e[_]=c,e[Y]=d)}return a.prototype={constructor:a,clone:function(){var b=this;return new a(b[Z],b[$],b[_],b[Y])},toString:function(){var a=this,b="",c=[Z,$,_,Y];return c.forEach(function(c){b+=a[c]+la+Aa}),b.trim()}},a}(),m=function(){var a,b,c;function d(a){var b=this;b.nT=-1,b.oT=-1,b.text(a||""),b.zIndex(ya)}a=[];function e(b,c,d){return a.push(b),q.Ul.Pl(b,c,f(b),d)}function f(a){var b=a;return function(){var a=this,c=a.kj;c&&(c.Xq<=0&&c.RP(),c.Wq(K.CommentChanged,{sheet:c,sheetName:c?c.Cj:"",comment:a,propertyName:b}))}}return b=[[wa,""],["location",Sa(9,-18)],[aa,160,function(a){return a>0}],[ba,100,function(a){return a>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(a){return/^\d+pt$/.test(a)&&parseInt(a)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(a){return"boolean"==typeof a&&this.dynamicMove()}],["dynamicMove",!0,function(a){return a||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(a){return a>=0&&a<=1}],["borderWidth",1,function(a){return a>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1]],c={clone:function(){var b=this,c=new d;return a.forEach(function(a){var d=b[a]();b[a].isDefault(d)||c[a](d&&d.clone?d.clone():d)}),c.kj=b.kj,c.nT=b.nT,c.oT=b.oT,c},toJSON:function(){var b=this,c={rowIndex:b.nT,colIndex:b.oT};return a.forEach(function(a){var d=b[a]();b[a].isDefault(d)||(c[a]=d&&d.clone?d.clone():d)}),c},fromJSON:function(b){if(b){var c=this;a.forEach(function(a){var d=b[a];d!==u&&("location"===a?c.location(new q.Point(d.x,d.y),!1):"padding"===a?c.padding(new l(d.top,d.right,d.bottom,d.left),!1):c[a](d,!1))}),b.rowIndex!==u&&(c.nT=b.rowIndex),b.colIndex!==u&&(c.oT=b.colIndex)}}},b.forEach(function(a){c[a[0]]=e(a[0],a[1],a[2])}),C(d.prototype,c),d}(),n=function(){function a(a,b){var c,d=this,e=a&&a.kj;d.WE=1,d.aS=1,d.kT=a,d.vT(),d._zoomFactor=e._zoomFactor,d.wT=b,d.BF=b.xT,d.ad(),c=d.yT(d.zT(),a.width(),a.height()),d.AT=Sa(c.x,c.y),d.BT(),d.CT()}q.Zn(a);function b(a,b,c,d,e){var f=Ta(b,c,d,d);f.cursor=e,a.push(f)}function c(a,b,c,d){B(a.DT).css(b,c),B(a.ET).css(b,d)}return a.prototype={constructor:a,ad:function(){var b=this,c=b.kT.kj;b.FT=ta+"floatBlockCanvas",b.GT=ta+"host-container",b.HT=ta+"host",b.IT=ta+"lineCanvas",b.JT=D(ma),B(b.JT).addClass(ta+"floatBlockCanvas-container").css([ca,ea,ia],[da,ha,ja]),b.DT=D("canvas"),I.Kn(b.DT,null,c),B(b.DT).addClass(b.FT).css([Y,Z,ca],[0,0,da]),b.ET=D(ma),B(b.ET).addClass(b.GT).css([ca,ia,ea],[da,ja,ha]),b.qo=D(ma),B(b.qo).addClass(b.HT+Aa+za).css([Y,Z,aa,ba,ca,"word-wrap","word-break","white-space",ea,ia,Ba,Ra],[0,0,"100%","100%",da,"break-word","normal","pre-wrap",ha,ja,Ca,"normal"]),B(b.ET).append(b.qo),B(b.JT).append(b.DT).append(b.ET),b.KT=D(ma),B(b.KT).addClass(ta+"lineCanvas-container").css([ca,ea,"pointer-events"],[da,ha,"none"]),b.LT=D("canvas"),I.Kn(b.LT,t,c),B(b.LT).addClass(b.IT).css([Y,$,ca],[0,0,da]),B(b.KT).append(b.LT),b.MT=[],b.NT=7,b.qS=!1,b.kv=!1,a.ao(b,"init",[b.DT,b.qo])},OT:function(){var a=this,b=a.kT.kj;a.PT||b&&(a.PT=b.nQ().PT),a.PT&&(a.PT.appendChild(a.KT),a.QT(),a.PT.appendChild(a.JT),a.RT(a.DT,oa),a.RT(a.ET,pa),a.ST()?a.TT():a.UT(),a.AT=a.zT(),a.VT())},WT:function(){var a=this;a.JT&&a.KT&&a.PT&&(a.XT(a.DT,oa),a.XT(a.ET,pa),a.YT(),a.ZT(),a.$T(),B(a.JT).remove(),B(a.KT).remove())},_T:function(){return this.kT.width()*this._zoomFactor},aU:function(){return this.kT.height()*this._zoomFactor},zT:function(){var a=this,b=a.kT;return b!==a.wT.bU||3!==b.commentState()||b.ignoreDefaultLocation()?a.cU(b.location()):b._3=a.cU(Sa(9,-18))},cU:function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,h=Sa(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==t&&void 0!==b.x&&b.y!==t&&void 0!==b.y&&Va(b)&&Ua(b)&&(c=f.am(),h.x=b.x+Va(b)+a.x*g-c.Br,h.y=b.y+a.y*g-c.Cr)),h},dU:function(a,b,c,d,e){var f,g,h,i=this,j=Ta(0,0,0,0),k=a.am(),l=cb(a,d),m=bb(a,e),n=i._zoomFactor,o=M(a,m,c,!1),p=M(a,l,b,!0);return b>=l?j.y=p:j.y=-p,c>=m?j.x=o:j.x=-o,f=a.getSpan(b,c),f!==u&&f!==t?(j.height=M(a,b,b+f.rowCount,!0),j.width=M(a,c,c+f.colCount,!1)):(j[ba]=_a(a,b)*n,j[aa]=ab(a,c)*n),j.x+=k.Br,j.y+=k.Cr,g=k.hs,h=k.fs,1===d?j.y+=h:2===d&&(j.y+=h+k.jr),1===e?j.x+=g:2===e&&(j.x+=g+k.er),j},eU:function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,h=Sa(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==t&&b.x!==u&&b.y!==t&&b.y!==u&&Va(b)&&Ua(b)&&(c=f.am(),h.x=(a.x-(b.x+Va(b)-c.Br))/g,h.y=(a.y-(b.y-c.Cr))/g)),h},fU:function(){var a=this;a.AT=a.zT(),a.BT(),a.CT(),a.VT()},gU:function(){var a=this;a.AT=a.zT(),a.CT()},hU:function(){var a,b=this,c=b.kT;c.dynamicMove()?c.dynamicSize()?b.iU():(b.jU(),b.CT()):(b.BT(),b.CT(),a=b.eU(b.AT===c._3?b.zT():b.AT),c.location(a))},qT:function(){var a=this;a.AT=a.zT(),a.VT()},jU:function(){var a=this,b=a.kT,c=a.kU();a.AT=c,b.location(a.eU(c),!1),a.VT()},kU:function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=i&&i.kj,k=h._zoomFactor,l=bb(j,h.aS),m=cb(j,h.WE),n=0;for(a=0;a<h.aS;a++)n+=j.getViewportWidth(a);for(b=M(j,l,h.lU,!1),l<h.lU?n+=b:n-=b,c=ab(j,h.lU),c<h.mU&&(h.mU=c),n+=h.mU*k,d=0,e=0;e<h.aS;e++)d+=j.getViewportHeight(e);return f=M(j,m,h.nU,!0),m<h.nU?d+=f:d-=f,g=_a(j,h.nU),g<h.oU&&(h.oU=g),d+=h.oU*k,Sa(n,d)},pU:function(){var a,b,c,d,e=this,f=e.kT,g=f&&f.kj,h=M(g,e.lU,e.mT,!1),i=ab(g,e.lU);i<e.mU&&(e.mU=i),a=ab(g,e.mT),a<e.qU&&(e.qU=a),h=h-e.mU+e.qU,b=M(g,e.nU,e.lT,!0),c=_a(g,e.nU),c<e.oU&&(e.oU=c),d=_a(g,e.lT),d<e.rU&&(e.rU=d),b=b-e.oU+e.rU,f.width(h),f.height(b)},iU:function(){var a=this;a.pU(),a.jU()},BT:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=bb(n,l.aS),b=cb(n,l.WE),0===l.aS?c=l.AT.x:1===l.aS?c=l.AT.x-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y:1===l.WE?d=l.AT.y-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=Sa(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=ab(n,h)*o,!(f+i<e.x)){l.lU=h,l.mU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=_a(n,j)*o,!(g+k<e.y)){l.nU=j,l.oU=(e.y-g)/o;break}g+=k}}},CT:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=bb(n,l.aS),b=cb(n,l.WE),0===l.aS?c=l.AT.x+l._T():1===l.aS?c=l.AT.x+l._T()-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x+l._T()-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y+l.aU():1===l.WE?d=l.AT.y+l.aU()-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y+l.aU()-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=Sa(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=ab(n,h)*o,!(f+i<e.x)){l.mT=h,l.qU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=_a(n,j)*o,!(g+k<e.y)){l.lT=j,l.rU=(e.y-g)/o;break}g+=k}}},rI:function(a,b){var c=this,d=c.kT;a<=c.nU?d.dynamicMove()&&(c.nU+=b,c.lT+=b):a>c.nU&&a<=c.lT&&d.dynamicSize()&&(c.lT+=b),c.iU()},tI:function(a,b){var c=this,d=c.kT;a<=c.lU?d.dynamicMove()&&(c.lU+=b,c.mT+=b):a>c.lU&&a<=c.mT&&d.dynamicSize()&&(c.mT+=b),c.iU()},GR:function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.nU?e<c.nU?d.dynamicMove()&&(c.nU-=b,c.lT-=b):e<c.lT&&d.dynamicMove()&&(d.dynamicSize()?c.lT-=b:c.lT-=c.nU-a+1,c.nU=a,c.oU=0):a<=c.lT&&(e<c.lT?d.dynamicSize()&&(c.lT-=b):d.dynamicSize()&&(c.lT=a,c.rU=0)),c.iU()},HR:function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.lU?e<c.lU?d.dynamicMove()&&(c.lU-=b,c.mT-=b):e<c.mT&&d.dynamicMove()&&(d.dynamicSize()?c.mT-=b:c.mT-=c.lU-a+1,c.lU=a,c.mU=0):a<=c.mT&&(e<c.mT?d.dynamicSize()&&(c.mT-=b):d.dynamicSize()&&(c.mT=a,c.qU=0)),c.iU()},VT:function(){var a=this,b=a.kT,c=b.kj;a.sU()&&(a._zoomFactor!==c._zoomFactor?(a._zoomFactor=c._zoomFactor,a.AT=a.kU()):(a._zoomFactor=c._zoomFactor,a.AT!==b._3||1!==b.displayMode()&&2!==b.commentState()||(a.AT=a.zT())),a.vT(),a.tU(),a.uU(),a.vU(),a.wU(),J.Ml.chrome&&a.xU())},tU:function(){var a=this,b=a.kT.kj,c=b.parent&&b.parent.options.useTouchLayout;c?a.NT=11:a.NT=7},vT:function(){var a=this,b=a.kT,c=b.kj;a.WE=c.Er(b.nT),a.aS=c.Fr(b.oT)},uU:function(){var a=this,b=a.kT,c=2===b.commentState()?a.BF:a.qo;a.yU(),a.zU(c),a.AU(c),a.BU(c),a.CU()},AU:function(a){var b=this,c=b.kT;a===b.qo&&(a.innerHTML=O.Ob(c.text()))},BU:function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kT,u=2===t.commentState()||1===t.displayMode()?s.zT():s.AT,x=s._zoomFactor;u&&(b=s.kv?s.yT(u,t.width(),t.height()):s.yT(u),s.DU(b),d=Va(b)*x,e=Ua(b)*x,f=b.x,g=b.y,h=f+d,i=g+e,j=s.NT,k=s.EU(s.WE,s.aS),f<k.x?(c(s,Y,f-k.x,f+j-k.x),d+=f-k.x,f=k.x):(c(s,Y,0,j),h>k.x+Va(k)&&(d+=k.x+Va(k)-1-h)),d=w(Va(k)-1,d),g<k.y?(c(s,Z,g-k.y,g+j-k.y),e+=g-k.y,g=k.y):(c(s,Z,0,j),i>k.y+Ua(k)&&(e+=k.y+Ua(k)-1-i)),e=w(Ua(k)-1,e),B(s.JT).css({left:f,top:g,width:d,height:e}),l=d,m=e,I.Pn(s.DT,l,m),n=v(0,l-2*(j+t.borderWidth())),o=v(0,m-2*(j+t.borderWidth())),B(s.ET).css({width:n,height:o}),p=n,q=o,r=t.padding(),r&&(p-=Math.ceil(N(r.left)+N(r.right)),q-=Math.ceil(N(r.top)+N(r.bottom))),B(a).css({width:v(0,p),height:v(0,q)}))},DU:function(a){var b,c,d,e,f=this,g=f.kT,h=f.AT;a.x===h.x&&a.y===h.y&&Va(a)===g.width()&&Ua(a)===g.height()||(b=f.eU(Sa(a.x,a.y)),c=Va(a),d=Ua(a),e=g.location(),b.x===e.x&&b.y===e.y||g.location(b,!1),c!==g.width()&&g.width(c,!1),d!==g.height()&&g.height(d,!1),g.dynamicMove()&&(f.AT=Sa(a.x,a.y)))},CU:function(){var a=this,b=a.kT,c=b&&b.kj;Wa(c)?(a.RT(a.DT,oa),a.RT(a.ET,pa),a.QT(),a.UT(),a.TT()):(b.locked()?(a.XT(a.DT,oa),a.FU(a.DT),a.XT(a.ET,pa),a.FU(a.ET),a.DT.style.cursor=A,a.ET.style.cursor=A):(a.RT(a.DT,oa),a.RT(a.ET,pa)),b.lockText()?(a.YT(),a.FU(a.qo),a.$T(),a.FU(a.BF),(b.locked()||1!==b.commentState())&&b.commentState(3),a.qo.style.cursor=b.locked()?A:S):(a.UT(),a.TT()),a.QT())},yU:function(){var a=this,b=a.kT,c=a.wT,d=b&&b.kj;switch(b.commentState()){case 1:c.GU(b),a.ST()&&a.HU(),d.getSelections().length>0&&d.EJ(),H.Zl(d);break;case 2:c.GU(b),a.ST()||a.IU(),d.getSelections().length>0&&d.EJ(),H.Zl(t);break;case 3:b===c.JU()&&(c.vQ(),0===d.getSelections().length&&d.GJ())}},zU:function(a){var b,c,d,e,f;function g(a,b,c){var d,e;return c?(d=E.pc,e=d.ec(a),e.a=b,d.bc(e)):a}b=this,c=b.kT,d=B(a),d.css("font-family",c.fontFamily()).css("font-style",c.fontStyle()).css("font-size",parseInt(c.fontSize())*b._zoomFactor+"pt").css("font-weight",c.fontWeight()),d.css("text-decoration",q.To.So(c.textDecoration())),e={0:"left",1:"center",2:"right",3:"general"},d.css("text-align",e[c.horizontalAlign()]),c.padding()?d.css(ka,""+c.padding()):d.css(ka,"0px"),d.css("background-color",g(c.backColor(),c.opacity(),a===b.qo)).css("color",c.foreColor()),B(b.ET).css("border-width",c.borderWidth()).css("border-style",c.borderStyle()).css("border-color",c.borderColor()),f=b.wT.KU(c),B(b.KT).css(ga,f),B(b.JT).css(ga,f)},xU:function(){var a,b,c,d=this,e=this.kT.kj,f=B(d.ET);e&&f&&(a=e.Vs(),b=a.left-Math.floor(a.left)>=.5?.5:0,c=a.top-Math.floor(a.top)>=.5?.5:0,f.css(Y,N(f.css(Y))+b),f.css(Z,N(f.css(Z))+c))},vU:function(){var a,b,c,d,e,f,g,h,i=this,j=i.kT,k=j.kj,l=i.dU(k,j.nT,j.oT,i.WE,i.aS),m=k.am(),n=l.x+Va(l)-m.Br,o=l.y-m.Cr,p=Sa(n,o),q=t,r=B(i.JT).position(),s=B(i.ET).position(),u=B(i.ET);q=r.left+s.left>p.x?Sa(r.left+s.left,r.top+s.top):r.top+s.top+u.height()<p.y?Sa(r.left+s.left+u.width(),r.top+s.top+u.height()):Sa(r.left+s.left+u.width(),r.top+s.top),a=i.NT,b=z(p.x-q.x)+2*a,c=z(p.y-q.y)+2*a,d=w(p.x,q.x)-a,e=w(p.y,q.y)-a,f=d+b,g=e+c,h=i.EU(i.WE,i.aS),d<h.x&&(b-=h.x-d,d=h.x),f>h.x+Va(h)&&(b-=f-(h.x+Va(h))),b=w(Va(h),b),e<h.y&&(c-=h.y-e,e=h.y),g>h.y+Ua(h)&&(c-=g-(h.y+Ua(h))),c=w(Ua(h),c),B(i.KT).css(Y,d).css(Z,e).css(aa,b).css(ba,c),I.Pn(i.LT,b,c),p.x=p.x-d,p.y=p.y-e,q.x=q.x-d,q.y=q.y-e,i.LU(p,q)},LU:function(a,b){var c,d,e,f=this;f.MU||(f.MU=f.LT.getContext("2d")),c=f.MU,d=f.kT.borderColor(),c.strokeStyle=d,c.clearRect(0,0,I.Nn(f.LT),I.On(f.LT)),c.beginPath(),c.moveTo(a.x,a.y),c.lineTo(b.x,b.y),c.stroke(),c.save(),P.Dn(c,a.x,a.y),c.fillStyle=d,c.beginPath(),e=y(b.y-a.y,b.x-a.x),c.rotate(e),c.moveTo(0,0),c.lineTo(7,-4),c.lineTo(7,4),c.lineTo(0,0),c.fill(),P.Dn(c,-a.x,-a.y),c.closePath(),c.restore()},wU:function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=i.kj;h.NU=h.kT.commentState(),h.OU||(h.OU=h.DT.getContext("2d")),a=h.OU,b=I.Nn(h.DT),c=I.On(h.DT),d=B(h.ET).outerWidth(),e=B(h.ET).outerHeight(),f=h.NT,a.clearRect(0,0,b,c),h.kT.showShadow()&&(h.QU(a,b,c),g=2*(f+2),a.clearRect(f,f,b-g,c-g),h.PU(a,f,d,e)),Wa(j,i)&&h.RU(a,f,b,c,d,e),a.restore()},PU:function(a,b,c,d){a.fillRect(b+2,d+b,c,2),a.fillRect(c+b,b+2,2,d)},QU:function(a,b,c){var d,e,f;switch(this.NU){case 1:for(a.beginPath(),e=0;e<c;e++)for(d=e%2===0?1:3;d<b;)a.moveTo(d,e),a.lineTo(d+1,e+1),d+=4;a.stroke(),a.closePath();break;case 2:for(a.beginPath(),d=0,e=0,f=4;d<b+c;)a.moveTo(d+f,0),a.lineTo(0,e+f),d+=f,e+=f;a.stroke(),a.closePath()}},RU:function(a,c,d,e,f,g){var h=this,i=h.MT;1!==h.NU&&2!==h.NU||(i.splice(0,i.length),b(i,0,0,c,"nw"+Qa),b(i,d-c,0,c,"ne"+Qa),b(i,0,e-c,c,"sw"+Qa),b(i,d-c,e-c,c,"se"+Qa),g>=3*c?(b(i,0,x(e/2-c/2),c,"w"+Qa),b(i,d-c,x(e/2-c/2),c,"e"+Qa)):(i.push(t),i.push(t)),f>=3*c?(b(i,x(d/2-c/2),0,c,"n"+Qa),b(i,x(d/2-c/2),e-c,c,"s"+Qa)):(i.push(t),i.push(t)),a.restore(),a.fillStyle="white",a.strokeStyle="#939393",a.linewidth=1,P.Dn(a,.5,.5),B.each(i,function(){if(h){var b=this,c=b.x,d=b.y,e=Va(b),f=Ua(b);a.beginPath(),a.fillRect(c,d,e-1,f-1),a.strokeRect(c,d,e-1,f-1),a.stroke(),a.closePath()}}),P.Dn(a,-.5,-.5))},SU:function(){var a,b,c,d=this,e=d.EU(d.WE,d.aS);d.TU?B(d.TU).remove():d.TU=D(ma),a=B(d.TU),b=B(d.ET),a.addClass("gc-spread-moveResizeContainer").css([ca,Y,Z,aa,ba,"border"],[da,d.AT.x+d.NT-e.x,d.AT.y+d.NT-e.y,b.outerWidth()-2,b.outerHeight()-2,"gray solid thin"]),d.UU?B(d.UU).remove():d.UU=D(ma),c=B(d.UU),c.bind("mousemove",function(a){d.BD(a)}).bind(V,function(a){d.CD(a)}).css([ca,ea,Z,Y,aa,ba,"background",ga],[da,ha,e.y,e.x,Va(e),Ua(e),"rgba(255,255,255,0.01)",901]),c.append(d.TU),d.PT&&d.PT.appendChild(d.UU)},VU:function(a){var b,c,d,e,f,g,h,i,j,k=this,l=k.NT,m=k._zoomFactor,n=k.wT,o=n.WU;if(o.XU){if(b=k.YU(),c=a.pageX/m-o.x+b.x,d=a.pageY/m-o.y+b.y,0===c&&0===d)return;e=k.EU(k.WE,k.aS),g=B(k.TU),o.ZU<0?(h=o.$U.x+c,i=o.$U.y+d,f=k.cU(Sa(h,i)),g.css([Y,Z],[f.x+l-e.x,f.y+l-e.y])):(j=k._U(c,d,o.ZU),f=k.cU(Sa(j.x,j.y)),g.css([Y,Z,aa,ba],[f.x+l-e.x,f.y+l-e.y,Va(j)*m-2*l-2,Ua(j)*m-2*l-2]))}},IU:function(){var a,b=this,c=b.kT;b.ST()||(a=b.wT.xT,B(b.qo).remove(),b.YT(),B(a).remove(),B(b.ET).append(a),b.aV(a),b.BU(a),B(a).focus(),a.selectionStart=a.value.length,b.TT(),2!==c.commentState()&&c.commentState(2))},HU:function(){var b,c=this,d=c.kT,e=d.kj;c.ST()&&(b=c.wT.xT,B(b).remove(),c.$T(),B(c.ET).append(c.qo),c.aV(c.qo),c.UT(),a.ao(c,"detachEditor",c.qo),2===d.commentState()&&d.commentState(3),B(b).val()!==d.text()&&e.wu().execute({cmd:"changeComment",sheetName:e.name(),comment:d,oldValue:d.text(),newValue:B(b).val(),propertyName:wa}))},bV:function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportHeight(a):1===a&&(d=M(c,c.getViewportBottomRow(0)+1,cb(c,2)+1,!0)),d},cV:function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportWidth(a):1===a&&(d=M(c,c.getViewportRightColumn(0)+1,bb(c,2)+1,!1)),d},EU:function(a,b){var c=this,d=c.kT.kj,e=d.am(),f=e.Ft(a,b);return 0===a&&0===b||0===a&&2===b||2===a&&0===b||2===a&&2===b?f=Ta(0,0,e.hs+e.er+e.js,e.fs+e.jr+e.gs):0===a&&1===b||2===a&&1===b?f=Ta(e.hs,0,e.er,e.fs+e.jr+e.gs):1===a&&0===b||1===a&&2===b?f=Ta(0,e.fs,e.hs+e.er+e.js,e.jr):1===a&&1===b&&(f=Ta(e.hs,e.fs,e.er,e.jr)),f},aV:function(a){var b=this,c=b.kT,d=B(a);a!==b.BF&&a!==b.qo||(a===b.BF?a.value=c.text():a.innerHTML=O.Ob(c.text()),d.css([Fa,Ga,Ha,Ia,Ja,Ka,La,Ma],[c.fontFamily(),c.fontStyle(),c.fontSize(),c.fontWeight(),c.foreColor(),c.backColor(),c.horizontalAlign(),c.textDecoration()]),c.padding()?d.css(ka,""+c.padding()):d.css(ka,"0px"))},sU:function(){return this.JT&&this.JT.parentNode},ST:function(){var a=this;return a.sU()&&a.kT===a.wT.JU()&&B(a.ET).find(Na).length>0},dV:function(){var a,b=this,c=b.kT.kj,d=t;return b.sU()&&(a=c.am(),d=Ta(b.AT.x+a.zr+a.Br,b.AT.y+a.Ar+a.Cr,b._T(),b.aU())),d},eV:function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=h._zoomFactor;return h.sU()&&(a=h.dV())?(f=(h.NT+i.borderWidth())*j,g=f,b=a.x+f,c=a.y+g,d=Va(a)-2*f,e=Ua(a)-2*g,Ta(b,c,d,e)):t},fV:function(a){var b,c=this,d=c.kT,e=d.kj,f=a.target,g=c.wT.WU,h=f.style,i=A;g.XU?f[ua]!==c.HT&&f[ua]!==c.FT&&f[ua]!==c.IT&&f[ua]!==ta+"floatPanel"||(i=g.ZU>=0?"crosshair":S):f[ua]===c.HT?!Wa(e)&&d.lockText()?d.locked()||(i=S):i=wa:f[ua]!==c.FT&&f[ua]!==c.GT||Wa(e,d)&&(b=c.gV(a),i=b>=0&&b<c.MT.length?c.MT[b].cursor:S),h[va]=i},hV:function(b){var c,d=this,e=d.kT,f=e&&e.kj;if(f.endEdit()&&(f.uQ&&f.uQ(),c={e:b,r:t},a.ao(d,"preProcessMouseDownEdit",c),!c.r))return d.wT.GU(e),e.commentState(2),d.CD(b),L(b)},iV:function(b){var c,d,e,f,g,h=this,i=h.kT,j=i&&i.kj,k=h._zoomFactor,l=h.wT,m=l.WU;j.endEdit()&&(j.uQ&&j.uQ(),c={e:b,r:t},a.ao(h,"preProcessMouseDownDragResize",c),c.r||(m.x=b.pageX/k,m.y=b.pageY/k,m.$U=Ta(i.location().x,i.location().y,i.width(),i.height()),m.ZU=h.gV(b),h.tC(),m.XU=!0,h.fV(b),l.GU(i),i.commentState(1),Wa(j,i)&&(h.eS={},h.eS.jV=cb(j,h.WE),h.eS.kV=bb(j,h.aS),h.SU(),m.ZU<0?h.qS=!0:h.kv=!0),d=j.mm,e=j.Vs(),f=Sa(b.pageX-e.left,b.pageY-e.top),g=j.hitTest(f.x,f.y),d.rG={KG:g.rowViewportIndex,MG:g.colViewportIndex,sG:g.hitTestType},d.$F=f,d.qG(),d.lV=!0,b.stopPropagation()))},yT:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,A=this,B=A.kT,C=B&&B.kj,D=A.NT,E=A._zoomFactor,F=A.aS,G=A.WE,H=A.EU(G,F);return 1===arguments.length?(d=A._T(),e=A.aU()):3===arguments.length&&(d=b*E,e=c*E),f=a.x,g=a.y,h=C.am(),i=A.dU(C,0,0,G,F),j=a.x+(0-(i.x-h.Br))+d-D,k=a.y+(0-(i.y-h.Cr))+e-D,0===F?(l=0-D,n=Va(h)-h.Br):1===F?(p=M(C,C.getViewportRightColumn(0)+1,bb(C,1),!1),l=H.x-D-p,q=A.cV(2),n=q):2===F&&(l=0-D,n=0),f<l&&(A.kv?d-=l-f:j+=l-f,f=l),1!==F&&2!==F||(n+=M(C,0,C.getColumnCount(),!1,j)),j>n&&(A.kv?d-=j-n:A.qS?f-=j-n:(r=A.wT.bU&&!B.ignoreDefaultLocation()?9:B.location().x,s=2*z(r)+ab(C,B.oT)+B.width(),t=f-s,t>l?f=t:f<n?d-=j-n:(t=f-s,u=j-s,u>l?t<l?(d-=l-t,f=l):f=t:(t=f-(j-n),t<l?(d-=l-t,f=l):f=t)))),0===G?(m=0-D,o=Ua(h)-h.Cr):1===G?(v=M(C,C.getViewportBottomRow(0)+1,cb(C,1),!0),m=H.y-D-v,w=A.bV(2),o=w):2===G&&(m=0-D,o=0),g<m&&(A.kv?e-=m-g:k+=m-g,g=m),1!==G&&2!==G||(o+=M(C,0,C.getRowCount(),!0,k)),k>o&&(A.kv?e-=k-o:A.qS?g-=k-o:k>o&&(x=k-o,y=g-x,y<m?(e-=m-y,g=m):g=y)),Ta(f,g,d/E,e/E)},YU:function(){var a=this,b=a.kT.kj,c=a.eS,d=c.jV,e=c.kV,f=cb(b,a.WE),g=bb(b,a.aS),h=M(b,d,f,!0),i=M(b,e,g,!1),j=e<g?i:-i,k=d<f?h:-h;return Sa(j,k)},mV:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor,p=l.wT,q=p.WU,s=r.ChangeComment;if(q.XU){if(b=l.YU(),c=a.pageX/o-q.x+b.x,d=a.pageY/o-q.y+b.y,0===c&&0===d)return;q.ZU<0?(h=q.$U.x+c,i=q.$U.y+d,e=l.cU(Sa(h,i)),f=l.yT(e),g=l.eU(Sa(f.x,f.y)),g.x===m.location().x&&g.x===m.location().y||n.wu().execute({cmd:"changeComment",sheetName:n.name(),comment:m,oldValue:m.location().clone(),newValue:g,propertyName:"location"})):(m.autoSize(!1),j=l._U(c,d,q.ZU),e=l.cU(Sa(j.x,j.y)),f=l.yT(e,Va(j),Ua(j)),g=l.eU(Sa(f.x,f.y)),k=[],g.x===m.location().x&&g.y===m.location().y||k.push(new s(n,{cmd:"changeComment",sheetName:n.name(),comment:m,oldValue:m.location().clone(),newValue:g,propertyName:"location"})),Va(f)!==m.width()&&k.push(new s(n,{cmd:"changeComment",sheetName:n.name(),comment:m,oldValue:m.width(),newValue:f.width,propertyName:aa})),Ua(f)!==m.height()&&k.push(new s(n,{cmd:"changeComment",sheetName:n.name(),comment:m,oldValue:m.height(),newValue:f.height,propertyName:ba})),k.length>0&&n.wu().execute({cmd:"changeCommentTransaction",sheetName:n.name(),commands:k}))}},BD:function(b){var c,d,e,f,g,h,i=this,j=i.kT.kj;if(this.fV(b),!(j.getSelections()&&j.getSelections().length>0||(c={e:b,r:t},a.ao(i,"preProcessMouseMove",c),c.r)))return d=i.wT,e=b.target,f=j.mm,g=j.Vs(),h=Sa(b.pageX-g.left,b.pageY-g.top),e&&d.WU.XU&&(i.TU&&i.VU(b),1===i.WE&&(f.$F.y=h.y),1===i.aS&&(f.$F.x=h.x),f.NG()),L(b)},CD:function(b){var c,d,e,f,g=this,h=g.kT.kj;if(!(h.getSelections()&&h.getSelections().length>0||(c={e:b,r:t},a.ao(g,"preProcessMouseUp",c),c.r)))return d=b.target,e=g.wT,f=h.mm,f.lV=!1,f.RG(),d&&(g.mV(b),g.UU&&(B(g.UU).remove(),g.UU=null,g.qS=!1,g.kv=!1),g.uC(),e.WU.XU=!1,g.fV(b)),L(b)},gV:function(a){var b,c,d,e,f,g=this,h=g.MT;if(h.length>0&&(1===g.NU||2===g.NU))for(b=a.target,c=a.pageX-B(b).offset().left,d=a.pageY-B(b).offset().top,e=0;e<h.length;e++)if(f=h[e],f&&f.contains(c,d))return e;return-1},_U:function(a,b,c){var d,e,f=this,g=-1,h=-1;switch(c){case 0:g=0,h=0;break;case 1:g=2,h=0;break;case 2:g=0,h=2;break;case 3:g=2,h=2;break;case 4:g=0,h=1;break;case 5:g=2,h=1;break;case 6:g=1,h=0;break;case 7:g=1,h=2}return d=f.nV(a,g),e=f.oV(b,h),Ta(d.x,e.y,d.w,e.h)},nV:function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=Va(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.x,h>=0?0===b&&(c+=a):0===b?c+=Va(g.$U)-f:2===b&&(c+=h),d=Va(g.$U),1!==b&&(d=z(h)+f),{x:c,w:d}},oV:function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=Ua(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.y,h>=0?0===b&&(c+=a):0===b?c=Ua(g.$U)-f:2===b&&(c+=h),d=Ua(g.$U),1!==b&&(d=z(h)+f),{y:c,h:d}},FU:function(a){var b,c,d=this,e=d.kT.kj;if(a){switch(b=u,a){case d.DT:b=oa;break;case d.ET:b=pa;break;case d.KT:b=qa;break;case d.qo:b=ra;break;case d.BF:b=sa}b&&(B(a).unbind(W+b).unbind(X+b),c=function(a){e.RF(a),L(a)},B(a).bind(W+b,c).bind(X+b,c))}},RT:function(a,b){var c,d=this,e=d.kT,f=e&&e&&e.kj;d.XT(a,b),c=function(a){f&&f.RF(a)},B(a).bind(T+b,function(a){d.iV(a)}).bind(U+b,function(a){d.BD(a)}).bind(V+b,function(a){d.CD(a)}).bind(W+b,c).bind(X+b,c)},XT:function(a,b){B(a).unbind(b)},QT:function(){var a,b,c=this,d=c.kT,e=d&&d.kj,f=c.wT;c.ZT(),e&&(a=e.Vs(),b=function(a){e.RF(a)},B(c.LT).bind(T+Oa,function(b){var d,g,h=e.comments.hitTest(b.pageX-a.left,b.pageY-a.top);h?(d=h.comment,g=f.pT(d),h.area===Da?g.hV(b):h.area===Ea&&g.iV(b),B(g.JT).css(ga,parseInt(B(c.KT).css(ga)+1))):e.OF(b)}).bind(U+Oa,function(b){var d,g,h,i=e.comments.hitTest(b.pageX-a.left,b.pageY-a.top),j=c.LT.style;i?(d=i.comment,g=f.pT(d),g.BD(b),i.area===Da?j.cursor=wa:i.area===Ea&&(j.cursor=S)):(e.PF(b),c.wT.tT(t),h=e.Ws(),h&&(j.cursor=h.style.cursor))}).bind(V+Oa,function(b){var c,d,g=e.comments.hitTest(b.pageX-a.left,b.pageY-a.top);g?(c=g.comment,d=f.pT(c),d.CD(b)):e.QF(b)}).bind("dblclick"+Oa,function(a){e.TF(a)}).bind(W+Oa,b).bind(X+Oa,b))},ZT:function(){var a=this;B(a.LT).unbind(Oa)},UT:function(){var a,b=this,c=b.kT,d=c&&c.kj;2!==c.commentState()&&b.qo&&(b.YT(),a=function(a){d&&d.RF(a)},B(b.qo).bind(T+ra,function(a){b.hV(a)}).bind(U+ra,function(a){b.BD(a)}).bind(V+ra,function(a){b.CD(a)}).bind(W+ra,a).bind(X+ra,a))},YT:function(){var a=this,b=a.kT;2!==b.commentState()&&a.qo&&B(a.qo).unbind(ra)},TT:function(){var a,b=this,c=b.kT,d=c&&c.kj,e=b.BF;2===c.commentState()&&e&&(this.$T(),a=function(a){d&&d.RF(a)},B(e).bind(T+sa,function(a){a.stopPropagation()}).bind(U+sa,function(a){a.stopPropagation()}).bind(V+sa,function(a){a.stopPropagation()}).bind(W+sa,a).bind(X+sa,a).bind("input"+sa,function(){c.autoSize()&&b.pV()}).bind("keydown"+sa,function(a){27!==a.keyCode&&9!==a.keyCode||(c.commentState(1),L(a),H.Zl(d))}))},pV:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.kT,s=r&&r.kj;if(2===r.commentState()?(a=q.BF,b=a.value.split("\n")):(a=q.qo,b=O.Pb(a.innerHTML).split("\n")),c=B(a).height(),d=B(a).width(),g=0,h=a.style,i="",h.font?(g=s.fp(h.font),i+=h.font):(r.fontStyle()&&(i+=Aa+r.fontStyle()),r.fontWeight()&&(i+=Aa+r.fontWeight()),r.fontSize()&&(i+=Aa+r.fontSize()),r.fontFamily()&&(i+=Aa+r.fontFamily()),g=s.fp(i)),j=g,k=5,b&&b.length>0){for(e=v(b.length*g,j),l=0,m=0;m<b.length;m++)n=s.rt(b[m],i),l<n&&(l=n);f=v(l,k)}else e=j,f=k;B(a).css(ba,e).css(aa,f),2===r.commentState()&&r.text(a.value),q.qV=!0,o=e-c,0!==o&&r.height(r.height()+o),p=f-d,0!==p&&r.width(r.width()+p),q.qV=!1},$T:function(){var a=this,b=a.kT,c=a.BF;2===b.commentState()&&c&&B(c).unbind(sa)},tC:function(){var a=this,b=a.wT.WU;b.XU||(B(Q).bind(U+Pa,function(b){a.BD(b)}).bind(V+Pa,function(b){a.CD(b)}),b.XU=!0)},uC:function(){var a=this.wT.WU;a.XU&&(a.XU=!1,B(Q).unbind(Pa))}},a}(),o=function(){function a(a){var b=this;b.kj=a,b.WU={XU:!1,x:0,y:0,$U:t,ZU:-1},b.xT=t,b.bU=t,b.rV=t,b.sV=[],b.jT=[],b.tV(),b.uV()}return a.prototype={constructor:a,add:function(a,b,c){var d,e,f=this,g=f.kj,h=g.getSpan(a,b);return!h||h.row===a&&h.col===b?(d=f.get(a,b),e="string"==typeof c?new m(c):c,f.Cz(a,b,e),g.Bq("comment",a,b,3,d,e),e):t},Cz:function(a,b,c,d){var e,f=this,g=f.kj,h=f.sV;f.vV(a,b),c&&(c.nT=a,c.oT=b,c.kj=g,d||h.forEach(function(a){a.zIndex(a.zIndex()-1)}),h.push(c),e=g.Mp(),e.setValueForKey(a,b,G,c),g.$p())},get:function(a,b){var c=this.kj.Mp();return c.getValueForKey(a,b,G)||t},remove:function(a,b){var c=this,d=c.vV(a,b),e=c.kj;d&&(e.Bq(G,a,b,3,d,u),e.$p())},vV:function(a,b){var c,d=this,e=d.kj,f=d.get(a,b);return f&&(d.hT(f),F.Fb(d.sV,f),F.Fb(d.jT,d.pT(f)),c=e.Mp(),c.setValueForKey(a,b,G,u)),f},clear:function(a){var b,c,d,e,f=this,g=f.kj,h=f.sV;for(g.suspendPaint(),b=h.length-1;b>=0;b--)c=h[b],d=c.nT,e=c.oT,(!a||d>=a.row&&d<a.row+a.rowCount&&e>=a.col&&e<a.col+a.colCount)&&f.remove(d,e);g.resumePaint()},all:function(){return this.sV.concat()},getOuterContainer:function(a){var b=this.pT(a);return b?b.JT:t},tV:function(){var a=D(Na);B(a).addClass("gc-comment-editor").css(Y,0).css(Z,0).css(ca,da).css("margin",0).css(ka,0).css("word-wrap","break-word").css("word-break","normal").css(ea,ha).css("resize","none").css("outline","none").css("border","0px").css(ia,ja).css(Ra,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.xT=a},uV:function(){var a=this,b=a.kj;b&&(b.Fu(K.ColumnChanged,function(b,c){var d=c.propertyName;d!==aa&&"isVisible"!==d||a.wV()}),b.Fu(K.RowChanged,function(b,c){var d=c.propertyName;d!==ba&&"isVisible"!==d||a.wV()}),b.Fu(K.ColumnWidthChanged,function(){a.wV()}),b.Fu(K.RowHeightChanged,function(){a.wV()}),b.Fu(K.CommentChanged,function(b,c){var d,e,f,g;c&&(d=c.propertyName,e=c.comment,f=a.pT(e),f&&(g=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"],"location"===d?f.fU():d===aa||d===ba?f.gU():g.indexOf(d)>=0&&e.autoSize()&&!f.qV&&f.pV()))}))},pT:function(a){var b,c,d=this,e=d.jT;if(a)for(b=0;b<e.length;b++)if(c=e[b],c.kT===a)return c;return t},iT:function(){return 0===this.sV.length},xV:function(){var a,b,c,d=this,e=d.sV;if(e.length>0){for(a=e[0].zIndex(),b=1;b<e.length;b++)c=e[b],a<c.zIndex()&&(a=c.zIndex());return a}return 0},rI:function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.nT&&(d.nT+=b);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.rI(a,b)},tI:function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.oT&&(d.oT+=b);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.tI(a,b)},GR:function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,e>=a&&e<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.nT&&(d.nT-=b);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.GR(a,b)},HR:function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,f>=a&&f<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.oT&&(d.oT-=b);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.HR(a,b)},JU:function(){return this.rV},GU:function(a){
var b=this;a&&a!==b.rV&&(b.vQ(),b.rV=a)},vQ:function(){var a,b=this,c=b.rV;c&&(a=b.pT(c),!a||a.qS||a.kv||(a.ST()&&a.HU(),c.commentState(3),b.rV=t))},Ao:function(a){var b=this,c=b.pT(a),d=!1;c||(d=!0,c=new n(a,b),b.jT.push(c)),c.OT(),d&&a.autoSize()&&!c.qV&&c.pV()},tT:function(a){var b=this,c=b.rV;if(c)if(1===c.displayMode()){if(2===c.commentState())return}else if(2===c.commentState()||1===c.commentState())return;a!==b.bU&&(b.bU&&b.hT(b.bU),a&&2===a.displayMode()?b.WU.XU||a.yV||(b.bU=a,a.yV=setTimeout(function(){b.Ao(a)},200)):b.bU=t)},hT:function(a){var b=this,c=b.pT(a);c&&c.sU()&&(c.WT(),a===b.rV&&b.kj.GJ()),clearTimeout(a.yV),delete a.yV},zV:function(){B(this.kj.nQ().PT).show()},AV:function(){B(this.kj.nQ().PT).hide()},BV:function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.dV()))&&d.contains(b,c)},CV:function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.eV()))&&d.contains(b,c)},hitTest:function(a,b){var c,d,e=this,f=t;for(c=0;c<e.sV.length;c++)d=e.sV[c],Wa(e.kj,d)&&e.BV(d,a,b)&&(f?d.zIndex()>f.zIndex()&&(f=d):f=d);return f?{x:a,y:b,comment:f,area:e.CV(f,a,b)?Da:Ea}:t},KU:function(a){var b=this,c=b.xV();return a===b.bU?c+2:a===b.rV?c+1:a.zIndex()},wV:function(){this.jT.forEach(function(a){a.hU()})},cQ:function(){this.jT.forEach(function(a){a.qT()})},fromJSON:function(a,b){var c,d,e,f=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)d=a[c],e=new m,e.fromJSON(d,b),3!==e.commentState()&&(f.rV=e),f.kj.comments.Cz(e.nT,e.oT,e,!0)},toJSON:function(){var a,b,c=this.sV;if(!c||0===c.length)return u;for(a=[],b=0;b<c.length;b++)a.push(c[b].toJSON());return 0===a.length?u:a}},a}(),p=function(){function a(a){var b=this;b.kj=t,b.oQ=!0,b.PT=b.DV(),a.appendChild(b.PT)}return a.prototype={constructor:a,DV:function(){var a=D(ma);return B(a).addClass("gc-comment-layoutPanel"+Aa+za).css([ca,Y,Z,ba,aa,ea,ga,Ba],[da,0,0,0,0,fa,xa,Ca]),a},rT:function(a){var b,c,d,e=this;a.comments.iT()||(b=a.am(),B(e.PT).css(Y,b.x+b.Br).css(Z,b.y+b.Cr),e.kj!==a&&(e.kj&&(c=e.kj.comments,c&&(d=c.JU(),d&&2===d.commentState()&&d.commentState(1))),e.kj=a))},sT:function(a,b,c){var d,e,f=c.row,g=c.col,h=c.x,i=c.y,j=Va(c),k=Ua(c),l=this;3===b&&l.kj&&(d=l.kj.comments.get(f,g),d&&(e=6,a&&j>0&&k>0&&(a.save(),a.rect(h,i,j,k),a.clip(),a.fillStyle="red",a.beginPath(),a.moveTo(h+j-e,i),a.lineTo(h+j,i),a.lineTo(h+j,i+e),a.lineTo(h+j-e,i),a.fill(),a.restore())))},fT:function(a){var b,c,d,e,f,g,h;if(!this.oQ)return void a.AV();for(a.zV(),b=this.kj,c=a.all(),d=0;d<c.length;d++)e=c[d],f=a.pT(e),this.EV(a,e)?(1===e.displayMode()&&e===a.bU&&(a.bU=t),f&&f.sU()?f.VT():a.Ao(e)):f&&f.sU()&&a.hT(e);g=a.JU(),g&&(h=a.pT(g),h&&h.sU()&&b.getSelections().length>0&&b.Uq.clear())},EV:function(a,b){var c=a.kj;if(c&&ab(c,b.oT)&&_a(c,b.nT))switch(b.displayMode()){case 1:return!0;case 2:if(3!==b.commentState())return a&&b!==a.bU&&(a.bU=b),!0;if(b===a.bU)return!0}return!1}},a}(),a.exports={CommentState:j,DisplayMode:k,Padding:l,Comment:m,GV:n}},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){var d,e,f,g,h,i,j=c(2),k=j.Commands,l=j.GC$,m=j.Events,n=c(1),o=k.ActionBase,p=null,q=void 0,r="deleteComment",s="deleteCommentByKey",t="deactivateComment",u="moveCommentUp",v="moveCommentDown",w="moveCommentLeft",x="moveCommentRight",y="changeComment",z="changeCommentTransaction",A=k.h4;function B(a,b,c){var d,e=!1,f=a.comments.JU();return f?(d=f.location(),a.wu().execute({cmd:y,sheetName:a.name(),comment:f,oldValue:d.clone(),newValue:new j.Point(d.x+b,d.y+c),propertyName:"location"})):e}k[s]={canUndo:!1,execute:function(a,b){var c=k.bT(a,b),d=c.comments.JU();return!!d&&c.wu().execute({cmd:r,sheetName:c.name(),comment:d})}},k[t]={canUndo:!1,execute:function(a,b){var c=k.bT(a,b),d=c.comments;return!!d.JU()&&(d.vQ(),c.GJ(),c.repaint(),!0)}},k[u]={canUndo:!1,execute:function(a,b){var c=k.bT(a,b);return B(c,0,-1)}},k[v]={canUndo:!1,execute:function(a,b){var c=k.bT(a,b);return B(c,0,1)}},k[w]={canUndo:!1,execute:function(a,b){var c=k.bT(a,b);return B(c,-1,0)}},k[x]={canUndo:!1,execute:function(a,b){var c=k.bT(a,b);return B(c,1,0)}},k[r]={canUndo:!0,execute:function(a,b,c){return A(a,e,b,c)}},k[y]={canUndo:!0,execute:function(a,b,c){return A(a,f,b,c)}},k[z]={canUndo:!0,execute:function(a,b,c){return A(a,g,b,c)}},d=function(a){l.inherit(b,a);function b(){a.call(this)}var c={init:function(a,b){this.kj=a,this.VQ=b},canUndo:function(){return!!this.VQ.HV},saveState:function(){this.VQ.HV=this.VQ.comment},clearState:function(){this.VQ.HV=q}};return l.extend(b.prototype,c),b}(o),e=function(a){l.inherit(b,a);function b(b,c){a.call(this),this.init(b,c)}var c={execute:function(){var a,b,c,d,e=this;return!!e.canExecute()&&(e.saveState(),a=e.kj,e.Lz(a,!0),b=e.VQ.comment,c=a.comments,d={sheet:a,sheetName:a.name(),comment:b,cancel:!1},a.Wq(m.CommentRemoving,d),d&&d.cancel===!0?e.clearState():(a.comments.remove(b.nT,b.oT),c.rV=p,a.GJ(),a.Wq(m.CommentRemoved,{sheet:a,sheetName:a.name(),comment:b})),e.Mz(a,!0),!0)},undo:function(){var a,b=this,c=b.VQ.HV;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),a.comments.Cz(c.nT,c.oT,c),a.EJ(),b.Mz(a,!0),!0)}};return l.extend(b.prototype,c),b}(d),f=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={execute:function(){var a,b=this,c=b.VQ,d=c.comment;return!(!b.canExecute()||!d)&&(b.saveState(),a=b.kj,b.Lz(a,!0),d[c.propertyName](c.newValue),b.Mz(a,!0),!0)},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.comment[c.propertyName](c.oldValue),b.Mz(a,!0),!0)}};return l.extend(b.prototype,c),b}(d),k.ChangeComment=f;function C(a,b){var c,d,e;if((b?a.canUndo():a.canExecute())&&(c=a.KV)){for(d=0;d<c.length;d++)e=c[d],e&&(b?e.undo():e.execute());return!0}return!1}g=function(a){l.inherit(b,a);function b(b,c){var d,e,f=this;if(a.call(f),f.KV=[],f.kj=b,f.VQ=c,d=c.commands)for(e=0;e<d.length;e++)f.add(d[e])}var c={execute:function(){return C(this,!1)},undo:function(){return C(this,!0)},add:function(a){this.KV.push(a)}};return l.extend(b.prototype,c),b}(o),h=function(a){a.register(s,k[s],46,!1,!1,!1,!1),a.register(t,k[t],27,!1,!1,!1,!1),a.register(u,k[u],38,!1,!1,!1,!1),a.register(v,k[v],40,!1,!1,!1,!1),a.register(w,k[w],37,!1,!1,!1,!1),a.register(x,k[x],39,!1,!1,!1,!1),a.register(r,k[r]),a.register(y,k[y]),a.register(z,k[z])},k.uT=h,i={CommentDeleteUndoAction:e,CommentPropertyUndoAction:f},l.extend(n,i),a.exports=n},function(a,b,c){var d=c(6);d&&!function(){var a=c(2),b=a.GC$,e=b.extend,f=a.Ul.nl,g=d.jR,h=d.kR;function i(a,b,c){var d,e,f=this,i=f.kT=b.kT;f.yM=new g(f),f.DQ=new h(a,"Comment"+i.nT+i.oT,f.yM,2,200),f.BQ=c,f.CQ=new j(a,b),d=f.CQ,e=f.DQ,e._M=function(){return 3!==f.kT.commentState()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(i.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function j(a,b){var c=this;c.NS=a,c.LV=b,c.kT=b.kT,c.kj=c.kT.kj,c.hQ=new d.TP(c.kj)}e(j.prototype,{OS:function(a){var c,e=new d.oP(a.X,a.Y),f=b(this.NS).offset();return f&&(c=document.body,e.X+=f.left+c.clientLeft||0,e.Y+=f.top+c.clientTop||0),e},jQ:function(a){a.DO=35},lQ:function(a){var b=this,c=b.OS(a.rN);b.LV.iV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},pQ:function(a){var c,d,e=this,f=a.dP.rO,g=e.kj,h=g.parent;1!==f&&h&&h.options.allowUserZoom?(g.mm.lV=!1,c=e.LV,b(c.TU).remove(),e.hQ.PP(f)):(d=e.OS(a.rN),e.LV.BD({target:a.GP,isTouch:!0,button:0,pageX:d.X,pageY:d.Y,stopPropagation:function(){}}))},qQ:function(a){var b,c=this,d=a.dP.rO,e=c.kj,f=e.parent;1!==d&&f&&f.options.allowuserZoom?c.hQ.SP(d):(b=c.OS(a.rN),c.LV.CD({target:a.GP,isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},sQ:function(){var a=this,b=a.kT,c=a.kj;try{c.suspendPaint(),3===b.commentState()?b.commentState(1):1===b.commentState()&&b.commentState(2)}finally{c.resumePaint()}}});function k(a,b,c){var d,e,f=this,i=f.kT=b.kT;f.yM=new g(f),f.DQ=new h(a,"Comment"+i.nT+i.oT,f.yM,2,200),f.BQ=c,f.CQ=new l(a,b),d=f.CQ,e=f.DQ,e._M=function(){return 3!==f.kT.commentState()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(k.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}}),b.inherit(l,j);function l(a,b){j.call(this,a,b)}l.prototype.lQ=function(a){var b=this,c=b.OS(a.rN);b.LV.hV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},c(1).GV.$n("touch",{init:function(a){var b=this,c=b.kT.kj,d=c.parent.BQ;b.wR=new i(a[0],b,d),b.wR.EQ(),b.MV=new k(a[1],b,d),b.MV.EQ()},detachEditor:function(a){var b=this,c=b.kT.kj;b.MV=new k(a,b,c.parent.BQ),b.MV.EQ()},preProcessMouseDownEdit:function(a){var b=a.e,c=this.MV;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseDownDragResize:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.IQ(b)&&(f(b),a.r=!0),e&&!c&&e.IQ(b)&&(f(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.HQ(b)&&(f(b),a.r=!0),e&&!c&&e.HQ(b)&&(f(b),a.r=!0)}})}()},function(a,b){a.exports=GC.Spread.Sheets.Touch}]);