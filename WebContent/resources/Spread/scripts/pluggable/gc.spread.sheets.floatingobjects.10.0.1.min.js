/*!
 * 
 * Spread.Sheets Library 10.0.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/spreadjs/eula/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FloatingObjects=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){var d=c(1);c(5),c(4),c(6),d.SR={},d.SR.en=c(8),a.exports=d},function(a,b,c){var d,e,f,g,h,i,j,k=c(2),l=c(3),m=c(4),n=k.Rect,o=k.Point,p=k.Events,q=k.Rm,r=l.j.Ma,s=k.Ul,t=s.Pl,u=s.Nl,v=s.Rl,w=m.yR,x=document,y=l.D,z=function(){return l.C(a.exports.SR)()},A=k.GC$,B=null,C=void 0,D=Math.ceil,E=Math.floor,F=Math.max,G=Math.min,H=Math.abs,I="div",J="on",K="z-index",L="move",M="unselectable",N=1,O="border",P=9007199254740992,Q="floatingObjects",R=".gcFloatingObject",S="name",T="x",U="y",V="width",W="height",X="start",Y=X+"Row",Z=X+"RowOffset",$=X+"Column",_=X+"ColumnOffset",aa="end",ba=aa+"Row",ca=aa+"RowOffset",da=aa+"Column",ea=aa+"ColumnOffset",fa="isSelected",ga="isLocked",ha="isVisible",ia="canPrint",ja="dynamicSize",ka="dynamicMove",la="fixedPosition",ma="allowResize",na="allowMove",oa=700,pa=701,qa="position",ra="absolute",sa="background",ta="gc-no-user-select",ua="gc-floatingobject-selected",va="gc-floatingobject-unselected",wa="gc-floatingobject-resize-indicator-select",xa="gc-floatingobject-resize-indicator-unSelect",ya="gc-floatingobject-content-container",za="gc-floatingobject-container",Aa="gc-floatingobject-moving-container",Ba="gc-floatingobject-moving-div",Ca=".gc-floatingobject-resize-indicator",Da="gc-floatingobject-resize-indicator",Ea="gc-floatingobject-absolute",Fa="gc-floatingobject-top",Ga="gc-floatingobject-middle",Ha="gcfloatingobject-bottom",Ia="gc-floatingobject-left",Ja="gc-floatingobject-center",Ka="gc-floatingobject-right",La="div."+Da,Ma=La+"."+Fa+"."+Ia,Na=La+"."+Ga+"."+Ia,Oa=La+"."+Ha+"."+Ia,Pa=La+"."+Fa+"."+Ja,Qa=La+"."+Ha+"."+Ja,Ra=La+"."+Fa+"."+Ka,Sa=La+"."+Ga+"."+Ka,Ta=La+"."+Ha+"."+Ka,Ua="content",Va="gc-no-user-select",Wa="100%",Xa="gc-floatingobject-background-cover",Ya=function(){var a=this;a.uQ=function(){var a=this.wr;a&&a.zR().forEach(function(a){a.isSelected(!1)})},a.AR=function(){var a=this,b=a.wr;b&&(b.isNeedToUpdateLayout=!0)},a.BR=function(){var a=this,b=a.parent,c=a.tv,d=b&&b.tv;return c||(c=a.tv=d?d:{fromSheet:B,isCutting:!1}),c},a.ex=function(){var a=this,b=a.BR(),c=b&&b.fromSheet;c&&(c.CR=B),b.fromSheet=B,b.isCutting=!1},a.DR=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.ER=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.isPasteFloatingObject=function(){var a=this,b=a.BR().fromSheet,c=this.CR;return!c&&b&&(c=b.CR),c&&!c.isEmpty()}};Ya.call(k.Worksheet.prototype);function Za(a){var b,c,d,e,f,g,h,i=a.FR;if(i){for(b=0,d=i.length;b<d;b++)if(f=i[b]){for(c=0,e=f.length;c<e;c++)g=f[c],g&&g.no();f.length=0}i.length=0,a.FR=B}h=a.wr,h&&h.no()}function $a(a,b,c){a.zR().forEach(function(a){a.rI(b,c)})}function _a(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){cb(b,-1,b+c-1,a.sheet().getColumnCount(),d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.GR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function ab(a,b,c){a.zR().forEach(function(a){a.tI(b,c)})}function bb(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){cb(-1,b,a.sheet().getRowCount(),b+c-1,d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.HR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function cb(a,b,c,d,e){var f=e[Y](),g=e[$](),h=e[ba](),i=e[da]();return a<=f&&b<=g&&c>=h&&d>=i}d={init:function(){var a=this;a.wr=new f(a),a.pictures=new pb(a,"1"),a.floatingObjects=new pb(a,"0")},dispose:function(){var a=this;Za(a),A(a.Ws()).unbind("mousedown.fos")},setHost:function(a){if(a){var b=this,c=".fos";a.bind("mousedown"+c,function(){b.uQ()}),b.bind(p.TableFiltered+c,function(){b.AR()}),b.bind(p.RangeFiltered+c,function(){b.AR()})}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=this.wr;g&&("addRows"===b?$a(g,c,d):"deleteRows"===b?_a(g,c,d):"addColumns"===b?ab(g,e,f):"deleteColumns"===b&&bb(g,e,f))},paint:function(a){var b=this,c=a.clipRect;b.QP||(b.IR=function(a,c){var d,e;return b.FR||(b.FR=[]),d=b.FR[a],d||(b.FR[a]=[]),e=b.FR[a][c],e||(b.FR[a][c]=new i(b)),e=b.FR[a][c]},b.QP=function(a,b){var c,d,e,f,g,h=this;if(!h.fI&&h.wr)for(c=h.am(),b!==B&&void 0!==b||(b=h._zoomFactor),e=0;e<=2;e++)for(f=0;f<=2;f++)d=c.Ft(e,f),d&&(g=h.IR(e,f),g&&g.yl(e,f,b))}),b.QP(c)},lastNonNullRowAndCol:function(){var a=0,b=0,c=this.wr;return c&&c.zR().forEach(function(c){c&&(c[ba]()>a&&(a=c[ba]()),c[da]()>b&&(b=c[da]()))}),{lastNonNullRow:a,lastNonNullCol:b}},toJson:function(a){var b=this.wr.toJSON();b.length>0&&(a.floatingObjects=b)},fromJson:function(a,b){var c,d,e=this;e.wr=new f(e),c=a&&a.floatingObjectArray,d=b?c&&c.floatingObjects:a.floatingObjects,d&&e.wr.fromJSON(d,b)},preProcessMouseDown:function(){this.uQ()},processKeyDown:function(a){var b,c,d,e,f=this.wr;if(f)for(b=f.zR(),d=b.length,c=0;c<d;c++)if(e=b[c],e.isSelected())return void(a.r=!0)}},k.Worksheet.$n(Q,d),e={init:function(){k.Commands.JR(this.commandManager())}},k.Workbook.$n(Q,e);function db(a,b){var c=this;return b||(b={}),A.each(a,function(a,d){var e=c[d],f=e.call(c);e.isDefault(f)||(b[d]=f)}),b}function eb(a,b){if(b){var c=this;A.each(a,function(a,d){b[d]!==C&&c[d].call(c,b[d],!1)})}}function fb(a){var b=a;return function(a){var c=this,d=c.sheet();b===Ua&&(c.KR=!0),d&&d.$p(),c.onPropertyChanged(b,a)}}function gb(a){var b=a;return function(a){var c=this,d=c.sheet();d&&(ib(c),d.$p()),c.onPropertyChanged(b,a)}}function hb(a){var b=a;return function(a){var c=this,d=c.sheet();d&&(qb(c),d.$p()),c.onPropertyChanged(b,a)}}function ib(a){var b,c,d=a.sheet();function e(b,c,e,f,g){var h=0,i=b.call(a);return h=c.call(a,d,0,i),jb.call(a,b,e,f,!0,g),h+=e.call(a)}d&&(b=e(a[Y],kb,a[Z],d.getRowHeight,Z),c=e(a[$],lb,a[_],d.getColumnWidth,_),a.x()===c&&a.y()===b||(a.x(c,!1),a.y(b,!1),a.onPropertyChanged("location",new n(c,b,a[V](),a[W]()))))}function jb(a,b,c,d,e){var f=this,g=b.call(f),h=c.call(f.sheet(),a.call(f),3),i=f.LR;h>0&&h--,g>h?(i[e]||(i[e]=g),b.call(f,h)):i[e]&&(i[e]<h?(b.call(f,i[e]),i[e]=C):(d&&h<i[e]||!d&&g<i[e])&&b.call(f,h))}function kb(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getRowHeight(e,3),!(f>d));e++);return f}function lb(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getColumnWidth(e,3),!(f>d));e++);return f}function mb(a){var b=a.sheet();function c(b,c,d,e,f){var g=ob(a,b,c),h=g.index;e.call(a,g.offset,!1),g.offset===-1&&(h+=1,e.call(a,0),h===f&&(h=f-1)),d.call(a,h,!1)}b&&(c(!0,a.y(),a[Y],a[Z],b.getRowCount()),c(!1,a.x(),a[$],a[_],b.getColumnCount()))}function nb(a){var b=a.sheet();function c(b,c,d,e){var f=ob(a,b,c);d.call(a,f.index,!1),e.call(a,f.offset,!1)}b&&(c(!0,a.y()+a[W](),a[ba],a[ca]),c(!1,a.x()+a[V](),a[da],a[ea]))}function ob(a,b,c){var d,e=0,f=0,g=a.sheet(),h=b?g.getRowCount():g.getColumnCount(),i=0;for(i=0;i<h;i++){if(d=b?g.getRowHeight(i,3):g.getColumnWidth(i,3),e+=d,f=e-c,f>0){f=f>0?d-f:-1;break}if(0===f){f=0,i+=1;break}}return i>=h&&(i=h-1,f=0),{offset:f,index:i}}function pb(a,b){this.kj=a,this.MR=b}A.extend(pb.prototype,{add:function(a,b,c,d,e,f){var g=this,h;return"1"===g.MR?h=new j.Picture(a,b,c,d,e,f):"0"===g.MR&&(h=a),g.kj.wr.Sb(h),h},get:function(a){return this.kj.wr.NR(a)},remove:function(a){this.kj.wr.Fb(a)},clear:function(){return this.kj.wr.$b(this.MR)},all:function(){return this.kj.wr.zR(this.MR)},zIndex:function(a,b){return this.kj.wr.PR(a,b)}}),f=function(){function a(a){var c=this;c.sheet(a),b(c),c.QR={}}function b(a){var b=a.sheet();b&&(A(x.body).bind("scroll"+R,function(){var a=b.parent.getActiveSheet();a.wr&&b.QP(a.Dr())}),b.Fu(p.ColumnChanged+R,function(b,d){var e=d.propertyName;e!==V&&e!==ha||c(a)}),b.Fu(p.RowChanged+R,function(b,d){var e=d.propertyName;e!==W&&e!==ha||c(a)}),b.Fu(p.ColumnWidthChanged+R,function(){c(a)}),b.Fu(p.RowHeightChanged+R,function(){c(a)}))}function c(a){var b=a.sheet();a.isNeedToUpdateLayout=!0,b.QP&&b.QP(b.Dr())}function d(a,b){if(a.QR[b])throw Error(z().Exp_FloatingObjectHasSameNameError)}var e={sheet:t("sheet",C),Sb:function(a){var b,c=this,e=c.sheet();if(e.suspendPaint(),b=a.name(),!b)throw Error(z().Exp_FloatingObjectNameEmptyError);d(c,b),a.sheet(e),c.QR[b]=a,e.resumePaint()},NR:function(a){return this.QR[a]},Fb:function(a,b){var c,d,e,f=this;return!!a&&(c=f.sheet(),d=f.NR(a),c.suspendPaint(),b?(e={sheet:c,sheetName:c.Cj,floatingObject:d,cancel:!1},c.Wq(p.FloatingObjectRemoving,e),e&&e.cancel===!1&&(delete f.QR[a],c.Wq(p.FloatingObjectRemoved,{sheet:c,sheetName:c.Cj,floatingObject:d}))):delete f.QR[a],c.resumePaint(),!0)},U3:function(a,b){var c,e=this,f=e.sheet();if(f.suspendPaint(),!b)throw Error(z().Exp_FloatingObjectNameEmptyError);d(e,b),c=e.QR[a],delete e.QR[a],e.QR[b]=c,f.resumePaint()},$b:function(a){var b=this,c=b.sheet();c.suspendPaint(),A.each(this.QR,function(c,d){a&&a!==d.typeName||b.Fb(d.name())}),c.resumePaint()},zR:function(a){var b=[];return A.each(this.QR,function(c,d){a&&a!==d.typeName||b.push(d)}),b},PR:function(a,b){var c,d,e,f,g,h,i,j=this.sheet(),k=j.FR;if(k)for(c=0,d=k.length;c<d;c++)if(e=k[c])for(f=0,g=e.length;f<g;f++)if(h=e[f]){if(isNaN(b)){if(i=h.PR(a),i===-1)continue;return i}h.PR(a,b)}if(isNaN(b))return-1},toJSON:function(){var a=[];return this.zR().forEach(function(b){b instanceof g&&b.hga()&&a.push(b.toJSON())}),a},fromJSON:function(a,b){var c,d,e,f,h,i,l=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)d=a[c],e=B,d&&(h=d.floatingObjectType,i=s.Ol(h)?h+"":d.typeName,f="0"===i?g:"1"===i?j.Picture:k.getTypeFromString(i),f&&(e=new f,e.fromJSON(d,b),l.Sb(e)))},no:function(){A(x.body).unbind("scroll"+R);var a=this.sheet();a&&(a.Gu(p.ColumnChanged+R),a.Gu(p.RowChanged+R),a.Gu(p.ColumnWidthChanged+R),a.Gu(p.RowHeightChanged+R))},hitTest:function(a,b){var c=this.sheet(),d=c.am(),e=c._zoomFactor,f=B;return d&&A.each(this.QR,function(g,h){if(c.DR(h)){var i=h.position().x*e+d.zr+d.Br,j=h.position().y*e+d.Ar+d.Cr,k=h[V](),l=h[W]();return a>=i&&a<i+k&&b>=j&&b<j+l?(f={x:a,y:b,floatingObject:h},!1):void 0}}),f},FS:function(){for(var a="FloatingObject",b=1,c=a+b;this.NR(c);)b++,c=a+b;return c}};return A.extend(a.prototype,e),a}();function qb(a){var b,c,d=a.sheet();function e(b,c,e,f,g,h,i){var j,k,l=0,m=b.call(a),n=c.call(a);return l=e.call(a,d,m,n),j=l+f.call(d,n,3),0===j&&a.isVisible()&&(a.isVisible(!1),a.RR=!1),m===n?(jb.call(a,c,h,f,!1,i),l=a[ca]()-a[Z]()):(k=f.call(d,m,3),k>0&&(l-=g.call(a)),jb.call(a,c,h,f,!1,i),l+=h.call(a)),l}d&&(a.RR===!1&&(a.isVisible(!0),a.RR=!0),b=e(a[Y],a[ba],kb,d.getRowHeight,a[Z],a[ca],ca),c=e(a[$],a[da],lb,d.getColumnWidth,a[_],a[ea],ea),c<0&&(c=0),b<0&&(b=0),a[V]()!==c&&(a[V](c,!1),a.onPropertyChanged(V,c)),a[W]()!==b&&(a[W](b,!1),a.onPropertyChanged(W,b)))}g=function(){var a,b=[S,T,U,V,W,ia,fa,ga,ha,ka,ja,la,ma,na],c=[["sheet",B,function(){l(this)}],[S,C,function(a){var b=this;if("string"!=typeof a||""===a)throw Error(z().Exp_FloatingObjectNameEmptyError);b.sheet()&&b.sheet().wr.Sb(b),b.onPropertyChanged("name",a)},function(){var a=this;return a.sheet()&&a.sheet().wr.Fb(a.name()),!0}],[T,0,f(T,!1)],[U,0,f(U,!1)],[W,0,f(W,!0)],[V,0,f(V,!0)],[Y,C,gb(Y)],[Z,0,gb(Z)],[$,C,gb($)],[_,0,gb(_)],[ba,C,hb(ba)],[ca,0,hb(ca)],[da,C,hb(da)],[ea,0,hb(ea)],[fa,!1,fb(fa)],[ga,!0,e(ga)],[ia,!0,e(ia)],[ha,!0,fb(ha)],[ka,!0,function(a,b){e(ka).call(this,a,b)},function(a){return"boolean"==typeof a&&(a||this.dynamicSize(!1,!1),!this.fixedPosition())}],[ja,!0,function(a,b){e(ja).call(this,a,b)},function(a){return"boolean"==typeof a&&this.dynamicMove()&&!this.fixedPosition()}],[la,!1,function(a){var b=this;a&&(b.dynamicMove(!1,!1),b.dynamicSize(!1,!1)),b.onPropertyChanged(la,a)}],[ma,!0,fb(ma)],[na,!0,fb(na)]];function d(a,b,c,d,e){var f=this;f.LR={startRowOffset:C,startColumnOffset:C,endRowOffset:C,endColumnOffset:C},f.RR=!0,f.typeName="0",f.name(a),f.x(b?b:0,!1),f.y(c?c:0,!1),f[V](d?d:0,!1),f[W](e?e:0,!1),f.qo=[],f.KR=!1}function e(a){return function(b){this.onPropertyChanged(a,b)}}function f(a,b){return function(c){var d=this,e=d.sheet();e&&(b&&i(d),j(d),q(d),e.$p()),d.onPropertyChanged(a,c)}}function g(a,b,c,d){var e=this,f=a.call(e),g=b.call(e);c<=f?e.dynamicMove()&&(a.call(e,f+d),b.call(e,g+d)):c>f&&c<g&&e.dynamicSize()&&b.call(e,g+d)}function h(a,b,c,d,e,f,g){var h,i,j=this,k=a.call(j),l=c.call(j);e<=k?g<k?j.dynamicMove()&&(a.call(j,k-f),c.call(j,l-f)):g<l&&(h=g-k+1,i=l-k+1-h,j.dynamicMove()&&(a.call(j,e),b.call(j,0)),j.dynamicSize()&&c.call(j,e+i-1)):e<=l&&(g<l?j.dynamicSize()&&c.call(j,l-f):j.dynamicSize()&&(c.call(j,e),d.call(j,0)))}function i(a){var b=m(a,a[W]()),c=n(a,a[V]());a[V]()>c&&a[V](c,!1),a[W]()>b&&a[W](b,!1)}function j(a){var b,c,d=a.x()+a[V](),e=n(a,d);d>e&&a.x(F(0,e-a[V]()),!1),a.x()<0&&a.x(0,!1),b=a.y()+a[W](),c=m(a,b),b>c&&a.y(F(0,c-a[W]()),!1),a.y()<0&&a.y(0,!1)}function l(a){var b,c,d,e;i(a),j(a),b=a[Y](),c=a[$](),b&&c?ib(a):mb(a),d=a[ba](),e=a[da](),d&&e?qb(a):nb(a)}function m(a,b){var c,d=a.sheet();return d?(c=d.getRowCount(),kb(d,0,c,b)):P}function n(a,b){var c,d=a.sheet();return d?(c=d.getColumnCount(),lb(d,0,c,b)):P}function q(a){mb(a),nb(a)}return a={constructor:d,position:function(a){var b=this,c=b.sheet();return 0===arguments.length?new o(b.x(),b.y()):(r(a,o)&&(b.x()===a.x&&b.y()===a.y||(b.x(a.x,!1),b.y(a.y,!1),j(b),q(b),c&&c.$p(),b.onPropertyChanged("position",a))),b)},content:t(Ua,B,fb(Ua)),cloneContent:function(){var a,b,c=this.content();return c?(c.cloneNode?a=c.cloneNode(!0):(b=u(I),b.innerHTML=c.outerHTML,a=b.firstChild),A(a).removeAttr("id")[0]):B},refreshContent:function(a){var b,c,d,e,f,g,h=this;h.KR&&a&&(b=A(a),b.empty(),c=h.cloneContent(),d=Wa,e=Wa,f="",g="",c&&c.style&&(f=c.style.width,g=c.style.height),""!==f&&(d=f),""!==g&&(e=g),c!==B?(A(c).css({width:d,height:e}).addClass(Xa).addClass(ta).attr(M,J).appendTo(a),b.css(sa,"")):b.css(sa,"#044062"),h.KR=!1)},toJSON:function(){var a=this,c=db.call(a,b);return c.typeName=a.typeName,c[Ua]=A(u(I)).append(a.cloneContent()).html(),c},fromJSON:function(a,c){var d,e;a&&(d=this,d.TR=!0,eb.call(this,b,a,c),q(d),a.content&&(e=u(I),e.innerHTML=a.content,d.content(A(e.firstChild)[0])),d.TR=C)},clone:function(){var a=this,b=k.getTypeFromString(a.typeName),c=b?new b:new d,e=JSON.stringify(a.toJSON());return c.fromJSON(JSON.parse(e)),c.content(a.cloneContent()),c},onPropertyChanged:function(a,b){var c,d=this;d.TR||(c=d.sheet(),d.Wq({sheet:c,sheetName:c?c.Cj:"",floatingObject:d,propertyName:a}))},Wq:function(a){var b,c=this.sheet();c&&(c.Wq(p.FloatingObjectChanged,a),a.propertyName===fa&&(b={sheet:a.sheet,sheetName:a.sheetName,floatingObject:a.floatingObject},c.Wq(p.FloatingObjectSelectionChanged,b)))},rI:function(a,b){var c=this;a=D(a),b=D(b),g.call(c,c[Y],c[ba],a,b)},GR:function(a,b){var c=this,d=a+b-1;h.call(c,c[Y],c[Z],c[ba],c[ca],a,b,d)},tI:function(a,b){var c=this;a=D(a),b=D(b),g.call(c,c[$],c[da],a,b)},HR:function(a,b){var c,d=this;a=D(a),b=D(b),c=a+b-1,h.call(d,d[$],d[_],d[da],d[ea],a,b,c)},getHost:function(){return this.qo.concat()},UR:function(a){var b=this.qo;a&&b.indexOf(a)<0&&b.push(a)},VR:function(a){var b=this.qo,c=b.indexOf(a);c>=0&&b.splice(c,1)},WR:function(){var a,b,c,d,e,f,g=u(I);return A(g).addClass(Va).addClass(ya).attr(M,J).css(qa,ra),a=this.cloneContent(),b=Wa,c=Wa,d="",e="",f=a&&a.style,f&&(d=f.width,e=f.height),""!==d&&(b=d),""!==e&&(c=e),a!==B&&A(a).css({width:b,height:c}).addClass(Xa).addClass(Va).attr(M,J).appendTo(g),this.UR(g),g},hga:function(){return!0}},A.each(c,function(b,c){a[c[0]]=t(c[0],c[1],c[2],c[3])}),d.prototype=a,d}(),h=function(){var a=X+"X",b=X+"Y",c=X+"Width",d=X+"Height",e="end",f=e+"X",g=e+"Y",h=X+"TopRow",i=X+"LeftColumn",j="left",l="center",m="right",r="top",t=r+j,w=r+l,z=r+m,D="middle",P=D+j,Q=D+m,S="bottom",T=S+j,U=S+l,Z=S+m,_="-resize",aa="cursor",ca="mousemove",ea="mouseup";function fa(a,b){this.XR="";var c=this;c.YR=a,c.name=a?a.name():"",c.kj=b,c.RB=!1,c.ZR=!1}k.Zn(fa);function ga(e,f,g){var h=e.$R,i,j,k,l;switch(f){case t:i=G(h[a]+h[c],g.x),j=G(h[b]+h[d],g.y),k=H(g.x-h[a]-h[c]),l=H(g.y-h[b]-h[d]);break;case w:i=h[a],j=G(h[b]+h[d],g.y),k=h[c],l=H(g.y-h[b]-h[d]);break;case z:i=G(h[a],g.x),j=G(h[b]+h[d],g.y),k=H(g.x-h[a]),l=H(g.y-h[b]-h[d]);break;case P:i=G(h[a]+h[c],g.x),j=h[b],k=H(g.x-h[a]-h[c]),l=h[d];break;case Q:i=G(h[a],g.x),j=h[b],k=H(g.x-h[a]),l=h[d];break;case T:i=G(h[a]+h[c],g.x),j=G(h[b],g.y),k=H(g.x-h[a]-h[c]),l=H(g.y-h[b]);break;case U:i=h[a],j=G(h[b],g.y),k=h[c],l=H(g.y-h[b]);break;case Z:i=G(h[a],g.x),j=G(h[b],g.y),k=H(g.x-h[a]),l=H(g.y-h[b])}return new n(i,j,k,l)}function ha(a){var b=A(a),c=b.position();return new n(c.left,c.top,b[V](),b[W]())}function ia(a,b,c,d,e,f){A(a).css([r,j,V,W],[[d-1],[c-1],e,f]).addClass(Ba).appendTo(b)}function ja(a,b){if(!a._R)return B;var c={inMoving:!1};return A(b.target).attr("resizeDirection")||(c.inMoving=!0),c}function ka(a){var b,c,d,e,f,g=a,h=g.kj,i=g.WE,j=g.aS,k=h.frozenTrailingRowCount(),l=h.frozenTrailingColumnCount(),m=h.am(),n=m.Ft(i,j),o=g.YR,p=o[Y](),q=o[$](),r=o[ba](),s=o[da](),t=h.frozenRowCount(),u=h.frozenColumnCount(),v=h.getRowCount(3)-k-1,w=h.getColumnCount(3)-l-1;return i===N?(t>0&&(b=h.getViewportTopRow(i),(p<t||b===t)&&(n.y-=m.fs,n[W]+=m.fs)),k>0&&(c=h.getViewportBottomRow(i),r>v&&c===v&&(n[W]+=m.gs))):i===N-1?(b=h.getViewportTopRow(i+1),(r>=b||b===t)&&(f=m.Ft(i+1,j),n[W]+=f[W])):i===N+1&&(c=h.getViewportBottomRow(i-1),(p<=c||c===v)&&(f=m.Ft(i-1,j),n.y=f.y,n[W]+=f[W])),j===N?(u>0&&(d=h.getViewportLeftColumn(j),(q<u||d===u)&&(n.x-=m.hs,n[V]+=m.hs)),h.frozenTrailingColumnCount()>0&&(e=h.getViewportRightColumn(j),(s>w||e===w)&&(n[V]+=m.js))):j===N-1?(d=h.getViewportLeftColumn(j+1),(s>=d||d===u)&&(f=m.Ft(i,j+1),n[V]+=f[V])):j===N+1&&(e=h.getViewportRightColumn(j-1),(q<=e||e===w)&&(f=m.Ft(i,j-1),n.x=f.x,n[V]+=f[V])),n}function la(a,b,c,d,e){var f=ha(a);A(a).css([r,j,V,W],[f.y+c,f.x+b,f[V]+d,f[W]+e])}function ma(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,p,q=a;if(q.bS){b=q.$F,c=ka(q),d=q.cS,e=q.$R,f=e.direction,b=new o(b.x-c.x,b.y-c.y),g=ga(q,f,b),e.endX=g.x,e.endY=g.y,e.endWidth=g[V],e.endHeight=g[W],h=ha(d),i=g.y-h.y,j=g.x-h.x,k=g[V]-h[V],l=g[W]-h[W],la(d,j,i,k,l),m=q.dS;for(n in m)y(m,n)&&(p=m[n],la(p.moveResizeDiv,j,i,k,l))}}function na(a,b){var c=a.kj;if(c)return c.RF(b),!1}function La(c){var d,e,j,k,l,m,n,o=c,p=o.kj,q=o.eS;if(q){if(d=v(p,q[h],p.getViewportTopRow(o.WE),!0),e=v(p,q[i],p.getViewportLeftColumn(o.aS),!1),j=q[f]-q[a]+(q[f]>q[a]?e:-1*e),k=q[g]-q[b]+(q[g]>q[b]?d:-1*d),0===j&&0===k)return;l=[],l.push(o.YR.name()),m=o.dS;for(n in m)y(m,n)&&l.push(n);p.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function Ua(c){var d,e,j,k,l,m,n,o=c,p=o.kj,q=o.eS,r=p._zoomFactor;if(q){d=v(p,q[h],p.getViewportTopRow(o.WE),!0),e=v(p,q[i],p.getViewportLeftColumn(o.aS),!1),j=q[f]-q[a]+(q[f]>q[a]?e:-1*e),k=q[g]-q[b]+(q[g]>q[b]?d:-1*d),j/=r,k/=r,l=[],l.push(o.YR.name()),m=o.dS;for(n in m)y(m,n)&&l.push(n);p.wu().execute({cmd:"moveFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function Va(c){var d,e,j,k,l,m,n,o,p,q=c,r=q.kj,s=r._zoomFactor,t=q.YR,u=q.$R;if(u){d=v(r,u[h],r.getViewportTopRow(q.WE),!0),e=v(r,u[i],r.getViewportLeftColumn(q.aS),!1),j=u[f]-u[a]+(u[f]>u[a]?e:-1*e),j/=s,k=u[g]-u[b]+(u[g]>u[b]?d:-1*d),k/=s,l=(u.endWidth+e)/s-t[V](),m=(u.endHeight+d)/s-t[W](),n=[],n.push(t.name()),o=q.dS;for(p in o)y(o,p)&&n.push(p);r.wu().execute({cmd:"resizeFloatingObjects",sheetName:r.name(),floatingObjects:n,offsetX:j,offsetY:k,offsetWidth:l,offsetHeight:m})}}function Wa(a,b,c){var d,e,f,g,h,i=a,j=i.cS;if(j){d=c.x-b.x,e=c.y-b.y,Xa(j,d,e),f=i.dS;for(g in f)y(f,g)&&(h=f[g],Xa(h.moveResizeDiv,d,e))}}function Xa(a,b,c){var d=A(a),e=A(a).position();d.css([r,j],[e[r]+c,e[j]+b])}function Ya(a){var b,c,d,e,f,g,h,i,j,k,l,m=a,n=m.eS;n&&(b=m.YR,c=m.kj,d=c.am(),e=d[V]-d.Br-d.zr,f=d[W]-d.Cr-d.Ar,g=n.startX,h=n.startY,i=b.position().x,j=b.position().y,k=b[V](),l=b[W](),i+n.endX-g<0&&(n.endX=g-i),j+n.endY-h<0&&(n.endY=h-j),i+k+n.endX-g>e&&(n.endX=e+g-i-k),j+l+n.endY-h>f&&(n.endY=f+h-j-l),n.startTopRow=c.getViewportTopRow(m.WE),n.startLeftColumn=c.getViewportLeftColumn(m.aS))}function Za(a){var b,c,d,e,f,g=a,h=g.$R;h&&(b=g.kj,c=b.am(),d=c[V]-c.Br-c.zr,e=c[W]-c.Cr-c.Ar,f=new n(h.endX,h.endY,h.endWidth,h.endHeight),f=f.getIntersect(0,0,d,e),h.endX=f.x,h.endY=f.y,h.endWidth=f[V],h.endHeight=f[W],h.startTopRow=b.getViewportTopRow(g.WE),h.startLeftColumn=b.getViewportLeftColumn(g.aS))}function $a(a){var b,c,d,e,f,g,h,i,j=u(I),k=A(j),l=a;return l.gS.fS(),k.addClass(za).addClass(ta).attr(M,J).css(K,oa).bind("mousedown",function(a){l.AD(a)}).bind(ca,function(a){l.BD(a)}).bind(ea,function(a){l.CD(a)}),j.addEventListener("mousewheel",function(a){na(l,a)},!1),j.addEventListener("DOMMouseScroll",function(a){na(l,a)},!1),b=A(u(I)).addClass(Da+" "+Fa+" "+Ia+" "+Ea),c=A(u(I)).addClass(Da+" "+Fa+" "+Ja+" "+Ea),d=A(u(I)).addClass(Da+" "+Fa+" "+Ka+" "+Ea),e=A(u(I)).addClass(Da+" "+Ga+" "+Ia+" "+Ea),f=A(u(I)).addClass(Da+" "+Ga+" "+Ka+" "+Ea),g=A(u(I)).addClass(Da+" "+Ha+" "+Ia+" "+Ea),h=A(u(I)).addClass(Da+" "+Ha+" "+Ja+" "+Ea),i=A(u(I)).addClass(Da+" "+Ha+" "+Ka+" "+Ea),k.append(b).append(c).append(d).append(e).append(f).append(g).append(h).append(i),fa.ao(l,"init",j),j}function _a(a){var b,c,d,e,f,g,h,i,k=a,l=k.hS&&k._R;if(l&&!k.cS){b=k.iS=u(I),k.cS=u(I),k.dS={},k.gS.jS.each(function(a){var b,c=a.YR;c&&c.name()!==k.YR.name()&&c.isSelected()&&!k.dS[c.name()]&&(b=a._R,k.dS[c.name()]={offsetX:b.x-l.x,offsetY:b.y-l.y,height:b[W],width:b[V],moveResizeDiv:u(I)})}),c=ka(k),d=A(b),d.css([K,r,j,V,W,sa],[pa,c.y,c.x,c[V],c[W],"rgba(255,255,255,0.01)"]).addClass(Aa).bind(ca,function(a){k.BD(a)}).bind(ea,function(a){k.CD(a)}),e=l.y-c.y,f=l.x-c.x,ia(k.cS,b,f,e,l[V],l[W]),g=k.dS;for(h in g)y(g,h)&&(i=g[h],ia(i.moveResizeDiv,k.iS,f+i.offsetX,e+i.offsetY,i[V],i[W]));k.Ks&&A(k.Ks).append(k.iS)}}function ab(a){var b=a;b.RB||(A(x).bind(ca+R,function(a){b.BD(a)}).bind(ea+R,function(a){b.CD(a)}),b.RB=!0)}function bb(a){var b=a;b.RB&&(b.RB=!1,A(x).unbind(ca+R).unbind(ea+R))}function cb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=A(Ca,b);r.removeClass(xa),c=a,d=ha(c.hS),e=c.kS,f=c.YR,c.lS&&(e=c.lS),g=fa.mS,h=ha(e),i=h.x,j=h.y,k=d[W]-h.y-h[W],l=d[V]-h.x-h[V],m=0,n=g+2,o=E(g/2+1),"function"==typeof f.borderWidth&&(p=f.borderWidth(),q=f.borderStyle(),f.nS(q)||(p=0),p>=o&&(m=p-o),k=d[W]-j-h[W]-p,l=d[V]-i-h[V]-p,i+=p,j+=p),i>0?(db(c,j>0,Ma,m,m,C,C,"nw"+_,t),db(c,d[W]>0,Na,m,(h[W]-n)/2+j,C,C,"w"+_,P),db(c,k>0,Oa,m,C,C,m,"ne"+_,T)):(eb(c,Ma),eb(c,Na),eb(c,Oa)),db(c,j>0,Pa,(h[V]-n)/2+i,m,C,C,"n"+_,w),db(c,k>0,Qa,(h[V]-n)/2+i,C,C,m,"n"+_,U),l>0?(db(c,j>0,Ra,C,m,m,C,"sw"+_,z),db(c,d[W]>0,Sa,C,(h[W]-n)/2+j,m,C,"w"+_,Q),db(c,k>0,Ta,C,C,m,m,"se"+_,Z)):(eb(c,Ra),eb(c,Sa),eb(c,Ta)),c.ZR=!0}function db(a,b,c,d,e,f,g,h,i){var k,l=a,n=A(c,l.hS);b?(k=fa.mS,n.css([j,r,m,S,V,W,aa],[d,e,f,g,k,k,h]).addClass(wa).attr("resizeDirection",i)):eb(l,c)}function eb(a,b){A(b,a.hS).removeClass(wa).addClass(xa)}function fb(a,b){A(Ca,b).removeClass(wa).addClass(xa),a.ZR=!1}function gb(a){var b,c,d,e,f,g=a,h=g.YR,i=h.src(),j=h.pictureStretch(),k=q.Om(h.sheet(),h.backColor()),l=g.kS;i&&l&&(b=A(l),g.XR!==i&&(g.XR=i,b.css([sa+"-image",sa+"-repeat"],["url('"+i+"')","no-repeat"])),b.css(sa+"-color",k),j!==B&&j!==C&&h.oS&&(c=h.getOriginalWidth(),d=h.getOriginalHeight(),e=b[V](),f=b[W](),s.ql(l,e,f,c,d,j)))}function hb(a,b,c){var d,e,f,g,h=a.lS,i=a.YR,k=i.borderWidth(),l=i.borderStyle(),n=q.Om(i.sheet(),i.borderColor()),o=i.borderRadius(),p=0,s=E(fa.mS/2+1);i.nS(l)||(k=0),k<s&&(p=s-k),d=p,e=p,f=p,g=p,s=F(k,s),b.x<0?d+=b.x-s:(d+=b.x<s?b.x-s:0,g=c[V]-d-b[V]-2-2*k),b.y<0?e+=b.y-s:(e+=b.y<s?b.y-s:0,f=c[W]-e-b[W]-2-2*k),A(h).css([qa,j,r,S,m,O+"-width",O+"-style",O+"-color",O+"-radius"],[ra,d,e,f,g,k,l,n,o])}return fa.prototype={AD:function(a){var b,c,d,e,f,g,h,i,j,l,m=this,n=m.kj,p=m.YR,q=n.comments,r=m.WE,s=m.aS;if(n.ER(p)&&n.endEdit()&&(b={e:a,r:B},fa.ao(m,"preProcessMouseDown",b),!b.r)){if(0===a.button||2===a.button){if(c=p.isSelected(),a.ctrlKey||a.shiftKey?p.isSelected(!c):c||(n.uQ(),p.isSelected(!0)),c||k.Vl.Zl(n),q&&q.vQ(),n.EJ(),2===a.button)return;if(d=n.mm,e=n.Vs(),f=new o(a.pageX-e.left,a.pageY-e.top),g=ja(m,a),!p.allowMove()&&(!p.allowResize()||g.inMoving))return;m.$F=f,m.pS=!0,m.bS=g,g.inMoving?(h={},h.startTopRow=n.getViewportTopRow(r),h.startLeftColumn=n.getViewportLeftColumn(s),h.startX=f.x,h.startY=f.y,m.eS=h):(_a(m),i={},j=ha(m.cS),i.startX=j.x,i.startY=j.y,i.startWidth=j[V],i.startHeight=j[W],i.startTopRow=n.getViewportTopRow(r),i.startLeftColumn=n.getViewportLeftColumn(s),i.cursor=a.target.style.cursor,i.direction=A(a.target).attr("resizeDirection"),m.$R=i),ab(m),l=n.hitTest(f.x,f.y),d.rG={KG:l.rowViewportIndex,MG:l.colViewportIndex,sG:l.hitTestType},d.$F=f,d.qG(),d.O3=!0}return!1}},BD:function(a){var b,c,d,e,f=this,g=f.kj,h=f.hS,i=f.iS;if(g.ER(f.YR)&&(b={e:a,r:B},fa.ao(f,"preProcessMouseMove",b),!b.r))return g.dG?(h&&A(h).css(aa,"default"),!0):(c=g.mm,d=g.Vs(),e=new o(a.pageX-d.left,a.pageY-d.top),f.pS&&(f.bS.inMoving?(f.qS=!0,_a(f),Wa(f,f.$F,e),A(i).css(aa,L)):f.YR.allowResize()&&(f.kv=!0,ma(f),A(i).css(aa,f.$R[aa])),(f.qS||f.kv)&&(f.$F=e,c.$F=e,c.NG(),A(x.body).addClass(ta).attr(M,J))),!1)},CD:function(a){var b,c,d,e,f,g=this,h=g.kj,i=h.mm,j=g.YR,k=g.hS,l=g.bS;if(h.ER(j)&&(b={e:a,r:B},fa.ao(g,"preProcessMouseUp",b),!b.r))return h.dG?(A(k).css(aa,L),!0):(i.O3=!1,i.RG(),c=h.Vs(),d=new o(a.pageX-c.left,a.pageY-c.top),e=g.eS,e&&(e.endX=d.x,e.endY=d.y),l&&(f=j.fixedPosition(),l.inMoving&&g.qS?(f&&Ya(g),a.ctrlKey?La(g):Ua(g)):g.kv&&(f&&Za(g),Va(g)),A(x.body).removeClass(ta)),g.rS(),!1)},rS:function(){var a=this;a.$R=B,a.eS=B,a.dS=B,A(a.iS).remove(),a.cS=B,a.pS=!1,bb(a),a.qS=!1,a.kv=!1},YR:function(){return this.YR},yl:function(a,b){var c,d,e,f,g,h,i,k=this,l=k.YR,m=k.kj;l&&(c=!1,k.sS=a,d=k.hS,d||(d=k.hS=$a(k),e=m.parent,e&&(f=k.Ks=e.xv(),f&&A(f).append(d))),g=k.kS,g||(g=k.kS=l.WR(),"function"==typeof l.borderWidth?(k.lS=u(I),A(k.lS).addClass(ta+" "+ya).attr(M,J),d.appendChild(k.lS),k.lS.appendChild(g)):(d.appendChild(g),c=!0)),k.lS&&(hb(k,b,a),b.x=0,b.y=0),h=A(g),A(d).css([r,j,V,W],[a.y,a.x,a[V],a[W]]),h.css([r,j,V,W,aa],[b.y,b.x,b[V],b[W],L]),l.refreshContent&&l.refreshContent(g),k.lS&&gb(k),l.isSelected()?(h.removeClass(va).addClass(ua),l.allowResize()?cb(k,d):k.ZR&&fb(k,d)):(h.removeClass(ua).addClass(va),fb(k,d)),c&&(i=g.firstChild,m.Wq(p.FloatingObjectLoaded,{sheet:m,sheetName:m.Cj,floatingObject:l,element:i})))},PR:function(a){var b,c=this.hS;if(c)if(isNaN(a)){if(b=parseInt(c.style.zIndex),!isNaN(b))return b}else c.style.zIndex=a;if(isNaN(a))return-1},no:function(){var a=this,b=a.YR,c=a.hS,d=a.iS,e=a.kS;fa.ao(a,"dispose"),e&&b.VR&&b.VR(e),c&&(A(c).remove(),a.hS=B),d&&(A(d).remove(),a.iS=B)}},fa.mS=7,fa}(),i=function(){function a(a){this.kj=a,this.jS=new w}function b(a){a.zR().forEach(function(a){a.dynamicMove()?ib(a):mb(a),a.dynamicSize()?qb(a):nb(a)})}function c(a,b,c){var d,e,f,g,h,i,j,k=a.kj,l=k.it(c),m=0,o=0,p=0,q=0;return l&&l.length>0&&(d=l[0],e=l[l.length-1],m=d.x,p=e.x+e[V]-m),f=k.jt(b),f&&f.length>0&&(g=f[0],h=f[f.length-1],o=g.y,q=h.y+h[W]-o),i=k.am(),j=i.Ft(b,c),j.getIntersect(m,o,p,q)||new n(0,0,0,0)}function d(a,c,d,e){var f,g,h,i,j,k,l,m,n=a,o=n.kj,p=new w,q=o.wr;return q.isNeedToUpdateLayout&&(b(q),q.isNeedToUpdateLayout=!1),f=o.am(),g=o.ss,h=o.it(d),i=o.jt(c),h.length<=0||i.length<=0?p:(j=h[0],k=h[h.length-1],l=i[0],m=i[i.length-1],q.zR().forEach(function(a){var b,c,d,n,o,q,r,s,t,u,v,w,x;if(a&&a.isVisible()){if(a.fixedPosition())d=a.position(),b=d.x*e+f.kt,c=d.y*e+f.nt;else{if(b=0,n=a[$](),o=h.findCol(n),o)b=o.x;else if(n<j.col)for(b=j.x,q=j.col-1;q>=n;q--)b-=g._m(q);else for(b=k.x+k[V],r=k.col+1;r<=n;r++)b+=g._m(r);if(b+=a[_]()*e,c=0,s=a[Y](),t=i.findRow(s),t)c=t.y;else if(s<l.row)for(c=l.y,u=l.row-1;u>=s;u--)c-=g.Sl(u);else for(c=m.y+m[W],v=m.row+1;v<=s;v++)c+=g.Sl(v);c+=a[Z]()*e}w=E(a[V]()*e),x=E(a[W]()*e),p.push({name:a.name(),x:b,y:c,width:w,height:x})}}),p)}return a.prototype={no:function(){var a=this.jS;a.each(function(a){a.no()}),a.empty()},yl:function(a,b,e){var f,g,i,j,k,l,m,o,p,q;if(!(a<0||b<0)){for(f=this,g=f.kj,i=f.jS,j=g.wr,k=d(f,a,b,e),l=[],i.each(function(a){k.find(a.name)||l.push(a)}),m=0,o=l.length;m<o;m++)p=l[m],p.gS=B,i.remove(p.name),p.no();q=g.parent&&g.parent.options.useTouchLayout,h.mS=q?11:7,k.each(function(d){var e,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B=j.NR(d.name),C=E(h.mS/2+1);B&&"function"==typeof B.borderWidth&&(e=B.borderWidth(),k=B.borderStyle(),B.nS(k)||(e=0),e>C&&(C=e)),l=c(f,a,b),m=1,o=d.x-C-m,p=d.y-C-m,q=d[V]+2*C+2*m,r=d[W]+2*C+2*m,s=F(l.y,p),t=F(l.x,o),u=r,v=q,w=C,x=C,y=-1*C-m,w=p-s+w,x=o-t+x,w<=0?(u+=w,u+=y):w<C&&w>0&&(u-=C-w),x<=0?(v+=x,v+=y):x<C&&x>0&&(v-=C-x),z=i.find(d.name),z||(z=new h(j.NR(d.name),g),z.gS=f,i.push(z)),z._R=d,z.WE=a,z.aS=b,A=new n(l.x,l.y,l[V],l[W]),z.yl(new n(t,s,v,u).getIntersectRect(A)||new n(t,s,0,0),new n(x,w,d[V],d[W]))})}},PR:function(a,b){var c=this.jS.find(a);return c?c.PR(b):isNaN(b)?-1:void 0},fS:function(){var a=this.jS;a.each(function(a){var b=a.PR();b!==-1&&a.PR(b-1)})}},a}(),j={FloatingObject:g,FloatingObjectCollection:pb,tS:h,uS:fb,vS:eb,wS:db},A.extend(j,m),a.exports=j},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){var d,e,f,g,h,i,j,k,l=c(2),m=c(3),n=l.GC$,o=l.Commands,p=m.k.ac,q=o.ActionBase,r=null,s=void 0,t=Math.min,u="unSelectAllFloatingObjects",v="deleteFloatingObjects",w="navigationNextFloatingObject",x="navigationPreviousFloatingObject",y="cutFloatingObjects",z="copyFloatingObjects",A="pasteFloatingObjects",B="dragCopyFloatingObjects",C="selectAllFloatingObjects",D="moveFloatingObjects",E="moveFloatingObjectsUp",F="moveFloatingObjectsDown",G="moveFloatingObjectsLeft",H="moveFloatingObjectsRight",I="resizeFloatingObjects",J="isSelected",K="name",L=o.h4;function M(a){var b=a.wr,c=!1;return b&&b.zR().forEach(function(a){a&&a[J]()&&(c=!0)}),c}d=function(a){n.inherit(b,a);function b(){a.call(this)}var c={init:function(a,b){var c=this;c.kj=a,c.VQ=b,b.yS=b.yS||[]},canExecute:function(){return!!M(this.kj)},canUndo:function(){var a=this.VQ.yS;return!!(a&&p(a)>0)},saveState:function(){var a,b,c,d,e=this,f=e.VQ.floatingObjects;if(f instanceof Array)for(a=e.kj.wr,b=0,c=p(f);b<c;b++)d=a.NR(f[b]),d&&e.VQ.yS.push(d)}};return n.extend(b.prototype,c),b}(q),e=function(a){n.inherit(b,a);function b(b,c){a.call(this),this.init(b,c)}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g=this,h=!1,i=g.kj,j=g.VQ,k=j.floatingObjects;if(g.canExecute()&&k instanceof Array){for(g.saveState(),g.Lz(i,!0),a=i.wr,b=0,c=p(k);b<c;b++)d=a.NR(k[b]),d&&(e=i.slicers,g.zS(d)&&e&&e.remove(d[K]()),f=a.Fb(k[b],!0),f||(j.yS[b]=s),d[J](!1));i.GJ(),g.Mz(i,!0),h=p(k)>0}return h},undo:function(){var a,b,c,d,e,f=this,g=f.VQ,h=g.yS,i=f.kj;if(f.canUndo()){for(f.Lz(i,!0),a=i.wr,b=0,c=p(h);b<c;b++)d=h[b],d&&(d[J](!0),a.Sb(d),e=i.slicers,f.zS(d)&&e&&e.Cz(d),d.position(g.AS[d[K]()]));return i.EJ(),h.length=0,f.Mz(i,!0),!0}return!1},init:function(b,c){a.prototype.init.call(this,b,c),c.AS=c.AS||{}},zS:function(a){return a&&"Slicer"===a.typeName},saveState:function(){var b,c,d,e,f,g,h;if(a.prototype.saveState.call(this),b=this,c=b.kj,d=b.VQ.floatingObjects,d instanceof Array)for(e=c.wr,f=0,g=p(d);f<g;f++)h=e.NR(d[f]),h&&h.position()&&(b.VQ.AS[h[K]()]=h.position())}};return n.extend(b.prototype,c),b}(d),f=function(a){n.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={constructor:b,canExecute:function(){return!0},execute:function(){var a,b,c,d,e,f=this,g=!1,h=f.VQ,i=h.floatingObjects,j=f.kj;if(f.canExecute()&&i instanceof Array){for(f.saveState(),f.Lz(j,!0),a=j.wr,b=0,c=p(i);b<c;b++)d=a.NR(i[b]),e=d.position(),d.position(new l.Point(e.x+h.offsetX,e.y+h.offsetY));f.Mz(j,!0),g=p(i)>0}return g},undo:function(){var a,b,c,d,e=this,f=e.VQ.yS,g=e.kj;if(e.canUndo()){for(e.Lz(g,!0),a=0,b=p(f);a<b;a++)c=f[a],d=c.position(),c.position(new l.Point(d.x-e.VQ.offsetX,d.y-e.VQ.offsetY));return f.length=0,e.Mz(g,!0),!0}return!1}};return n.extend(b.prototype,c),b}(d),g=function(a){n.inherit(b,a);function b(b,c){
var d=this;a.call(d),d.init(b,c)}var c={execute:function(){var a,b,c,d,e,f=this,g=!1,h=f.VQ,i=h.floatingObjects,j=f.kj;if(f.canExecute()&&i instanceof Array){for(f.saveState(),f.Lz(j,!0),a=j.wr,b=0,c=p(i);b<c;b++)d=a.NR(i[b]),e=d.position(),d.width(d.width()+h.offsetWidth),d.height(d.height()+h.offsetHeight),d.position(new l.Point(e.x+h.offsetX,e.y+h.offsetY));f.Mz(j,!0),g=p(i)>0}return g},undo:function(){var a,b,c,d,e=this,f=e.VQ.yS,g=e.kj;if(e.canUndo()){for(e.Lz(g,!0),a=0,b=p(f);a<b;a++)c=f[a],d=c.position(),c.position(new l.Point(d.x-e.VQ.offsetX,d.y-e.VQ.offsetY)),c.width(c.width()-e.VQ.offsetWidth),c.height(c.height()-e.VQ.offsetHeight);return f.length=0,e.Mz(g,!0),!0}return!1}};return n.extend(b.prototype,c),b}(d),h=function(a){n.inherit(b,a);function b(){var b=this;a.call(b),b.kj=r}var c={canExecute:function(){var a=this,b=a.VQ.floatingObjects;return!!(p(b)>0&&a.ES(b))},canUndo:function(){var a=this.VQ.DS;return!!(a&&p(a)>0)},ES:function(a){var b,c,d,e=this,f=e.kj,g=f.wr;for(b=0,c=p(a);b<c;b++)if(d=g.NR(a[b]),d&&!f.ER(d))return!1;return!0},zS:function(a){return a&&"Slicer"===a.typeName}};return n.extend(b.prototype,c),b}(q),i=function(a){n.inherit(b,a);function b(b,c){var d=this;a.call(d),d.OFFSET=15,d.kj=b,d.VQ=c,c.DS=c.DS||[],c.f6=c.f6||[]}var c={execute:function(){var a,b,c,d,e,f,g,h,i,j,k,m,n,o,q,r,s,u,v,w,x,y,z,A,B=this,C=B.VQ,D=C.floatingObjects;if(B.canExecute()){for(a=B.kj,b=C.fromSheet,B.Lz(a,!0),c=C.f6,d=a.wr,void 0===C.Jl&&(M(a)&&d.zR().forEach(function(a){a&&a[J]()&&c.push(a)}),C.Jl=B.kj.getActiveRowIndex(),C.GS=B.kj.getActiveColumnIndex()),M(a)&&d.zR().forEach(function(a){a&&a[J]()&&a[J](!1)}),e=[],h=Number.MAX_VALUE,i=h,j=h,k=[],f=0,g=p(D);f<g;f++)m=b.CR.find(D[f]).position(),i=t(i,m.x),j=t(j,m.y),k.push(new l.Point(m.x-i,m.y-j));if(n=0,o=0,c.length)q=h,r=h,c.forEach(function(a){if(a){var b=a.position();q=t(q,b.x),r=t(r,b.y)}}),n=q<h?q+B.OFFSET:0,o=r<h?r+B.OFFSET:0;else{for(s=0;s<C.Jl;s++)o+=a.Yr(s,3);for(u=0;u<C.GS;u++)n+=a.$r(u,3)}for(f=0,g=p(D);f<g;f++)v=k[f],e.push(new l.Point(n+v.x,o+v.y));for(w=C.isCutting,x=b.wr,f=0,g=p(D);f<g;f++)A=b.CR.find(D[f]),w&&!x.NR(D[f])?(y=A,y.sheet(a)):(y=A.clone(a),z=B.zS(y)?a.slicers.HS(y[K]()):d.FS()),z&&y[K](z),B.zS(y)&&(a.slicers.Cz(y),y.width(A.width()),y.height(A.height())),y.isVisible(!0),y.position(e[f]),y[J](!0),d.Sb(y),C.DS.push(y);return B.Mz(a,!0),!0}return!1},undo:function(){var a,b,c,d,e,f,g,h=this,i=h.VQ,j=i.DS;if(h.canUndo()){for(a=h.kj,b=a.wr,h.Lz(a,!0),c=0,d=p(j);c<d;c++)e=j[c],f=a.slicers,h.zS(e)&&f&&f.remove(e[K]()),b.Fb(e[K](),!0);return j.length=0,g=i.f6,g.forEach(function(a){a[J](!0)}),h.Mz(a,!0),!0}return!1}};return n.extend(b.prototype,c),b}(h),j=function(a){n.inherit(b,a);function b(a,b){var c=this;c.kj=a,c.VQ=b,b.DS=b.DS||[]}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g,h,i=this,j=!1,k=i.VQ,m=k.floatingObjects,n=i.kj;if(i.canExecute()){for(i.Lz(n,!0),a=n.wr,b=0,c=p(m);b<c;b++)d=a.NR(m[b]),d&&(e=d.clone(n),f=d.position(),e.position(new l.Point(f.x+k.offsetX,f.y+k.offsetY)),e[K](a.FS()),e[J](!0),d[J](!1),i.zS(e)&&n.slicers&&(g=e,h=n.slicers.HS(g.columnName()),g[K](h),n.slicers.Cz(g)),a.Sb(e),k.DS.push(e));i.Mz(n,!0),j=!0}return j},undo:function(){var a,b,c,d,e,f,g=this,h=g.VQ,i=h.DS,j=g.kj;if(g.canUndo()){for(g.Lz(j,!0),a=j.wr,b=0,c=p(i);b<c;b++)d=i[b][K](),e=j.slicers,f=a.NR(d),g.zS(f)&&e&&e.remove(d),a.Fb(d,!0);return i.length=0,g.Mz(j,!0),!0}return!1}};return n.extend(b.prototype,c),b}(h);function N(a){var b=[];return a.wr.zR().forEach(function(a){a[J]()&&b.push(a[K]())}),b}function O(a,b,c){var d,e,f,g,h=a.BR(),i=h.fromSheet;for(h.fromSheet=a,h.isCutting=c,d=new k,e=0,f=0;f<p(b);f++)g=a.wr.NR(b[f]),g&&(d.push(g),e++);return i&&(i.CR=r),a.CR=d,e>0}o[u]={canUndo:!1,execute:function(a,b){var c=o.bT(a,b);return!!M(c)&&(c.suspendPaint(),c.uQ(),c.GJ(),c.resumePaint(),!0)}},o[C]={canUndo:!1,execute:function(a,b){var c=o.bT(a,b);c.suspendPaint(),c.wr.zR().forEach(function(a){a[J](!0)}),c.resumePaint()}},o[v]={canUndo:!0,execute:function(a,b,c){var d,f;return b.floatingObjects?L(a,e,b,c):(d=a.sheets?a.getActiveSheet():a,f=N(d),p(f)>0?d.wu().execute({cmd:v,sheetName:d.name(),floatingObjects:f}):void 0)}},o[w]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i,j=o.bT(a,b);if(M(j)){for(j.suspendPaint(),g=j.wr.zR(),h=g.length,f=0;f<h;f++){if(i=g[f],d||(d=i),c){e=i;break}i&&i[J]()&&(c=i)}return j.uQ(),e||(e=d),e&&e[J](!0),j.resumePaint(),!0}return!1}},o[x]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i=o.bT(a,b);if(M(i)){for(i.suspendPaint(),f=i.wr.zR(),g=f.length,e=0;e<g;e++)if(h=f[e],c||(c=h),c[J]())d=h;else if(h[J]()||(d=h),h[J]())break;return i.uQ(),d[J](!0),i.resumePaint(),!0}return!1}},o[y]={canUndo:!1,execute:function(a,b){var c,d=o.bT(a,b),e=[];return d.wr.zR().forEach(function(a){a[J]()&&e.push(a[K]())}),p(e)>0&&(O(d,e,!0),c={cmd:v,sheetName:d.name(),floatingObjects:e},d.wu().execute(c))}},o[z]={canUndo:!1,execute:function(a,b){var c=o.bT(a,b),d=[];return c.wr.zR().forEach(function(a){a[J]()&&d.push(a[K]())}),O(c,d,!1)}},o[A]={canUndo:!0,execute:function(a,b,c){var d,e,f,g,h;if(b.floatingObjects)return L(a,i,b,c);if(d=o.bT(a,b),!d.isEditing()&&(e=d.BR(),f=e.fromSheet,g=f&&f.CR)){if(h=[],g.each(function(a){h.push(a[K]())}),0===p(h))return!1;if(!d.Js)return d.wu().execute({cmd:A,sheetName:d.name(),floatingObjects:h,fromSheet:f,isCutting:e.isCutting})}}},o[B]={canUndo:!0,execute:function(a,b,c){return L(a,j,b,c)}};function P(a){return function(b,c){var d,e,f=o.bT(b,c),g=0;return 0===a?g=-1:2===a&&(g=1),d=0,1===a?d=-1:3===a&&(d=1),e=N(f),p(e)>0&&f.wu().execute({cmd:D,sheetName:f.name(),floatingObjects:e,offsetX:g,offsetY:d})}}o[G]=P(0),o[E]=P(1),o[H]=P(2),o[F]=P(3),o[D]={canUndo:!0,execute:function(a,b,c){return L(a,f,b,c)}},o[I]={canUndo:!0,execute:function(a,b,c){return L(a,g,b,c)}},o.JR=function(a){var b=l.Ul.sl(),c=!b,d=b;a.register(u,o[u],27,!1,!1,!1,!1),a.register(C,o[C],65,c,!1,!1,d),a.register(v,o[v],46,!1,!1,!1,!1),a.register(w,o[w],9,!1,!1,!1,!1),a.register(x,o[x],9,!1,!0,!1,!1),a.register(y,o[y],88,c,!1,!1,d),a.register(z,o[z],67,c,!1,!1,d),a.register(B,o[B]),a.register(A,o[A],86,c,!1,!1,d),a.register(D,o[D]),a.register(E,o[E],38,!1,!1,!1,!1),a.register(F,o[F],40,!1,!1,!1,!1),a.register(G,o[G],37,!1,!1,!1,!1),a.register(H,o[H],39,!1,!1,!1,!1),a.register(I,o[I])},k=function(){function a(a){return"string"==typeof a[K]?a[K]:a[K]()}function b(){this.rM={}}return b.prototype={push:function(b){this.rM[a(b)]=b},remove:function(a){delete this.rM[a]},find:function(a){return this.rM[a]},empty:function(){delete this.rM,this.rM={}},each:function(a){var b,c=this.rM;for(b in c)c.hasOwnProperty(b)&&a(c[b])},isEmpty:function(){var a,b=this.rM;for(a in b)if(b.hasOwnProperty(a))return!1;return!0}},b}(),a.exports={yR:k,FloatingObjectUndoActionBase:d,DeleteFloatingObjectUndoAction:e,MovingFloatingObjectUndoAction:f,ResizingFloatingObjectUndoAction:g,FloatingObjectCopyPasteUndoAction:h,ClipboardPasteFloatingObjectUndoAction:i,DragCopyFloatingObjectUndoAction:j}},function(a,b,c){var d=c(2),e=c(1),f=d.Ul.Nl,g=d.Ul.Pl,h=e.FloatingObject,i=e.vS,j=e.wS,k=e.uS,l=d.GC$,m=null,n=void 0,o=function(a){var b,c,e,h,o,p,q,r,s,t;l.inherit(v,a);function u(a){return"number"==typeof a&&!isNaN(a)}b="src",c="backColor",e="pictureStretch",h="borderRadius",o="borderWidth",p="borderStyle",q="borderColor",r=[b,c,h,o,p,q,e],s=[[b,n,function(a){var c=this;c.oS=!1,w(c),c.srccallback||(c.srccallback=k(b)),c.srccallback.call(c,a)}],[c,m,k(c)],[h,-1,k(h),u],[o,1,k(o),u],[p,"none",function(a){var b=this;b.nS(a)||b.borderWidth(0),b.bscallback||(b.bscallback=k(p)),b.bscallback.call(b,a)}],[q,m,k(q)],[e,0,k(e)]];function v(b,c,d,e,f,g){var h=this;a.call(h,b,d,e,f,g),h.typeName="1",h.bt=m,h.oS=!1,h.JS=!1,"string"==typeof c&&(h.JS=!f||!g,h.src(c))}function w(a){var b,c,e=a,f=e.src(),g=e.sheet();e.bt||(e.bt=new d.oo(function(){w(e)})),b=e.bt;try{b.ko(f)?(e.oS=!0,c=b.lo(f),e.KS=c.width,e.LS=c.height,e.JS&&(e.width(c.width,!0),e.height(c.height,!0),e.JS=!1),g&&g.repaint()):b.fo(f)}catch(a){}}return t={onPropertyChanged:function(a,b){var c,d=this;d.TR||(c=d.sheet(),this.Wq({sheet:c,sheetName:c?c.Cj:"",picture:d,propertyName:a}))},toJSON:function(){var b=this,c=a.prototype.toJSON.call(this);return j.call(b,r,c),delete c.content,c},fromJSON:function(b,c){if(b){var d=this;d.TR=!0,a.prototype.fromJSON.call(d,b,c),i.call(d,r,b,c),d.oS=!1,w(d),d.TR=n}},clone:function(){var a=new v,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a},getOriginalWidth:function(){return this.KS},getOriginalHeight:function(){return this.LS},nS:function(a){var b=["dotted","dashed","solid","double","groove","ridge","inset","outset"];return b.indexOf(a)>=0},WR:function(){var a=f("div");return l(a).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(a),a},Wq:function(a){var b,c=this.sheet();c&&(c.Wq(d.Events.PictureChanged,a),"isSelected"===a.propertyName&&(b={sheet:a.sheet,sheetName:a.sheetName,picture:a.picture},c.Wq(d.Events.PictureSelectionChanged,b)))}},l.each(s,function(a,b){t[b[0]]=g(b[0],b[1],b[2],b[3])}),l.extend(v.prototype,t),v}(h);e.Picture=o,a.exports=e},function(a,b,c){var d=c(7);d&&!function(){var a=c(2),b=a.GC$,e=b.extend,f=a.Ul.nl,g=d.jR,h=d.kR;function i(a,b,c){var d,e,f=this;f.yM=new g(f),f.DQ=new h(a,"FL_"+b.name,f.yM,2,200),f.BQ=c,f.CQ=new j(a,b),d=f.CQ,e=f.DQ,e._M=function(){return b.YR.isSelected()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(i.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function j(a,b){var c=this;c.MS=b,c.YR=b.YR,c.NS=a,c.hQ=new d.TP(b.kj)}e(j.prototype,{OS:function(a){var c,e=new d.oP(a.X,a.Y),f=b(this.NS).offset();return f&&(c=document.body,e.X+=f.left+c.clientLeft||0,e.Y+=f.top+c.clientTop||0),e},jQ:function(a){a.DO=35},lQ:function(a){var b=this,c=b.OS(a.rN);b.MS.AD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},pQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?(e.mm.O3=!1,c.MS.rS(),c.hQ.PP(d)):(b=c.OS(a.rN),c.MS.BD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},qQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?c.hQ.SP(d):(b=c.OS(a.rN),this.MS.CD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},sQ:function(){var b,c;try{b=this,c=b.MS.kj,c.suspendPaint(),b.YR.isSelected()||(c.uQ(),b.YR.isSelected(!0),a.Vl.Zl(c)),c.clearSelection()}finally{c.resumePaint()}}}),c(1).tS.$n("touch",{init:function(a){var b=this,c=b.wR=new i(a,b,b.kj.parent.BQ);c.EQ()},dispose:function(){var a=this.wR;a&&a.FQ()},preProcessMouseDown:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.IQ(b)&&(f(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.HQ(b)&&(f(b),a.r=!0)}})}()},function(a,b){a.exports=GC.Spread.Sheets.Touch},function(a,b){a.exports={Exp_FloatingObjectHasSameNameError:"The current worksheet already has a floating object with the same name.",Exp_FloatingObjectNameEmptyError:"Floating object must have name"}}]);