/*!
 * 
 * Spread.Sheets Library 10.0.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/spreadjs/eula/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Touch=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){var b=c(1);b.SR={},b.SR.en=c(4),a.exports=b},function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u={},v=c(2),w=c(3),x=v.j.Fa,y=w.Go,z=w.GC$,A=z.extend,B=z.isEmptyObject,C=z.inherit,D=w.Ul,E=D.Nl,F=w.Im,G=w.Rect,H=w.Vl,I=w.En,J=w.kf,K=w.Events,L=w.zp,M=w.yp,N=D.nl,O=D.Ml.mozilla,P=D.rl(),Q=P.ipad||P.iphone,R=null,S=void 0,T=Math.abs,U=Math.min,V=Math.max,W=Math.pow,X=Math.atan2,Y=Math.PI,Z=Math.round,$=Math.sqrt,_=Math.atan,aa=Math.log,ba=Math.floor,ca=100,da="touch",ea="none",fa="MSPointerDown",ga="MSPointerMove",ha="MSPointerUp",ia="pointerdown",ja="pointermove",ka="pointerup",la="touchstart",ma="touchmove",na="touchend",oa="MSPOINTER_TYPE_TOUCH",pa=isNaN,qa=parseInt,ra=parseFloat,sa=window,ta=sa.navigator,ua=document,va=sa.Yl,wa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",xa="AAAAAElFTkSuQmCC",ya=w.Bn;function za(){return v.C(u.SR)()}function Aa(a){return a.height}function Ba(a){return a.width}function Ca(a){clearInterval(a)}function Da(){return(new Date).valueOf()}function Ea(a,b){var c,d,e,f,g,h,i,j;return!(!a||!b)&&(c=13,d=15,e=c,f=c,g=d,h=d,i=a.X-b.X,j=a.Y-b.Y,T(i)<e&&T(j)<f&&$(i*i+j*j)<U(g,h))}function Fa(a){return a.getActiveSheet()}function Ga(a){return a.getSelections()}function Ha(a){return a.frozenTrailingColumnCount()}function Ia(a){return a.frozenTrailingRowCount()}function Ja(a,b){return a.getColumnCount(b)}function Ka(a,b){return a.getRowCount(b)}d=400,e=1e3,f=20;function La(a){var b=z(a).offset(),c=ua.body,d=0,e=0;return b&&(d=b.top+c.clientTop||0,e=b.left+c.clientLeft||0),{FB:d,EB:e}}function Ma(){var a=this;a.rM=[],a.sM={length:0},a.tM=new Sa,a.uM=new Ta}A(Ma.prototype,{vM:function(a){this.tM.vM=a},wM:function(a){this.tM.wM=a},xM:function(a){var b=this;b.tM.xM=function(c){if(a){a(c);var d=b.yM;d&&d.zM()}}},AM:function(a){this.tM.AM=a},BM:function(a){this.tM.BM=a},CM:function(a){this.uM.CM=a},DM:function(a){this.uM.DM=a},EM:function(a){this.uM.EM=a},FM:function(a){this.GM=a},HM:function(a){this.IM=a},JM:function(a,b){var c=b?b.KM:this.LM.KM;return D.Z3(a,c)},MM:function(a,b){var c,d,e,f,g,h,i=this,j=b.pointerType,k=b.target,l=b.offsetX,m=b.offsetY;j!==b[oa]&&j!==da||(c=i.JM(k,a),d=c.EB,e=c.FB,f=i.NM(a,k,b.pointerId,new Ua(l+d,m+e),b.timeStamp),f&&N(b),"sheet"===i.LM.OM&&(g=b.pageX-(l+d),h=b.pageY-(m+e),va.canvasOffset={top:h,left:g}))},PM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[oa]||e===da){if(d.sM[f]===S)return!1;b=d.JM(a.target),c=d.aB(f,new Ua(a.offsetX+b.EB,a.offsetY+b.FB),a.timeStamp),c&&N(a)}},QM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[oa]||e===da){if(d.sM[f]===S)return!1;b=d.JM(a.target),c=d.RM(f,new Ua(a.offsetX+b.EB,a.offsetY+b.FB)),c&&N(a)}},SM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[oa]||e===da){if(d.sM[f]===S)return!1;b=d.JM(a.target),c=d.TM(f,new Ua(a.offsetX+b.EB,a.offsetY+b.FB)),c&&N(a)}},UM:function(a,b){var c,d,e,f=La(a.KM),g=b.changedTouches,h=!1;for(c=0;c<g.length;c++)d=g[c],e=O?Da():b.timeStamp,h=this.NM(a,b.target,d.identifier,new Ua(d.pageX-f.EB,d.pageY-f.FB),e)||h;h&&N(b)},VM:function(a){var b,c,d,e=this,f=La(e.LM.KM),g=a.changedTouches,h=!1;for(b=0;b<g.length;b++)c=g[b],d=O?Da():a.timeStamp,h=e.aB(c.identifier,new Ua(c.pageX-f.EB,c.pageY-f.FB),d)||h;h&&N(a)},WM:function(a){var b,c,d=this,e=La(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.RM(c.identifier,new Ua(c.pageX-e.EB,c.pageY-e.FB))||g;g&&N(a)},XM:function(a){var b,c,d=this,e=La(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.TM(c.identifier,new Ua(c.pageX-e.EB,c.pageY-e.FB))||g;g&&N(a)},YM:function(a){var b,c,d=this,e=d.LM,f=d.ZM;e!==f&&(b=z(e.KM).offset(),c=z(f.KM).offset(),a.X+=b.left-c.left,a.Y+=b.top-c.top)},$M:function(a){var b,c,d,e,f,g=this,h=g.rM;for(g.ZM=R,g.yM=R,c=0;c<h.length;c++)if(h[c]===a){if(d=h[c],e=R,f=R,d._M&&!d._M()){for(c=0;c<h.length;c++)if(b=h[c],b!==d&&b.aN>=0&&b.aN<d.aN&&(!b._M||b._M())){e=b;break}if(e===R)return!1}if(d.bN&&!d.bN()){for(c=0;c<h.length;c++)if(b=h[c],b!==d&&b.aN>=0&&b.aN<d.aN&&(!b.bN||b.bN())){f=b;break}if(f===R)return!1}e===R&&(e=d),f===R&&(f=d),g.LM=d,g.ZM=e,g.cN=f,g.vM(e.dN||R),g.wM(e.eN||R),g.BM(e.fN||R),g.AM(e.gN||R),g.xM(e.hN||R),g.CM(f.iN||R),g.DM(f.jN||R),g.EM(f.kN||R),g.FM(e.GM||R),g.HM(e.IM||R),e.lN&&(g.yM=d.lN);break}return!0},NM:function(a,b,c,d,e){var f=this;return f.sM[c]===S&&(!(0===f.sM.length&&!f.$M(a,b))&&(!!f.ZM&&(f.sM.length>=f.ZM.mN||(!f.yM||!f.yM.nN())&&(f.YM(d),f.yM&&0===f.sM.length&&f.yM.oN(),f.sM[c]={id:c,time:Da(),position:d},f.sM.length++,f.tM.pN(b,c,d,e),f.tM.qN(c,d,f.sM.length,e),1===f.sM.length&&f.uM.qN(d),1===f.sM.length&&f.GM&&f.GM({rN:d}),!0))))},aB:function(a,b,c){var d=this;return d.sM[a]!==S&&((!d.yM||!d.yM.sN())&&(d.YM(b),d.sM[a]={id:a,time:Da(),position:b},d.tM.tN(a,b,c),!0))},RM:function(a,b){var c=this;return c.sM[a]!==S&&(delete c.sM[a],c.sM.length--,(!c.yM||!c.yM.uN())&&(c.YM(b),c.tM.vN(a),c.tM.wN(a),0===c.sM.length&&(c.uM.vN(b),c.uM.wN(b)),0===c.sM.length&&c.IM&&c.IM({rN:b}),c.yM&&0===c.sM.length&&0===c.tM._process&&c.yM.zM(),!0))},TM:function(a,b){return this.RM(a,b)},xN:function(a,b){var c,d,e,f,g,h=this,i="."+a.OM,j=".gcSheet",k=fa+j,l=ga+j+i,m=ha+j+i,n="MSPointerCancel"+j+i,o="MSLostPointerCapture"+j+i,p=ia+j,q=ja+j+i,r=ka+j+i,s="LostPointerCapture"+j+i,t="pointercancel"+j+i,u=la+j,w=ma+j,y=na+j,A="touchcancel"+j;function B(){z(ua).bind(l,E).bind(m,F).bind(q,E).bind(r,F).bind(n,G).bind(o,G).bind(s,G).bind(t,G)}function C(){z(ua).unbind(l).unbind(q).unbind(m).unbind(r).unbind(n).unbind(t).unbind(o).unbind(s)}function D(b){B(j+i),h.MM(a,b)}function E(a){h.PM(a)}function F(a){h.QM(a),0===h.sM.length&&C()}function G(a){h.SM(a),0===h.sM.length&&C()}c=a.KM,d=h.rM,e=v.k.Cb(d,a),e>=0&&b||e<0&&!b||(f=ta.msPointerEnabled||ta.pointerEnabled,b?f?(g=c.style,x(g.msTouchAction)||(g.msTouchAction=ea),x(g.touchAction)||(g.touchAction=ea),z(c).bind(k,D).bind(p,D)):(z(c).bind(u,function(b){h.UM(a,b)}),z(c).bind(w,function(a){h.VM(a)}).bind(y,function(a){h.WM(a)}).bind(A,function(a){h.XM(a)})):f?z(c).unbind(k).unbind(p):z(c).unbind(u).unbind(w).unbind(y).unbind(A),b?d.push(a):d.splice(e,1))},no:function(){var a,b=this,c=b.rM;for(a=c.length-1;a>=0;a--)b.xN(c[a],!1)}});function Na(a,b){var c=X(b.Y,b.X)-X(a.Y,a.X);return c>Y?c-=2*Y:c<-Y&&(c+=2*Y),c}function Oa(a,b){return $((b.X-a.X)*(b.X-a.X)+(b.Y-a.Y)*(b.Y-a.Y))}function Pa(a,b,c){var d=new Ua(c._Center.X,c._Center.Y),e=new Ua(b.X-d.X,b.Y-d.Y),f=new Ua(a.X-d.X,a.Y-d.Y),g=U(1,W(Oa(b,d)/c._Radius,4)),h=Na(e,f);return pa(h)?0:h*g}function Qa(a){return T(a)<=2.220446049250313e-16}function Ra(a,b){var c=!1,d=!1,e;return 0!==a&&(e=_(b/a)/Y*180,e<20&&(c=!0)),0===a?d=!0:(e=_(b/a)/Y*180,e>75&&e<105&&(d=!0)),{yN:c,zN:d}}function Sa(){var a=this;a.AN=0,a.BN=0,a.CN=1,a.DN=0,a.EN=0,a._process=0,a.FN=511,a.GN=new ab,a.HN=20,a.IN=new Wa}A(Sa.prototype,{pN:function(a,b,c,d){var e,f=this;3===f._process&&f.JN(!0),f.KN=2===f._process&&1===f.GN.MN(),f.NN=a,e={},e.Np=b,e.ON=c,e.PN=c,f.GN.QN(e),f.RN=d,f.GN.MN()>1&&(f.SN=!1,f.TN=!1,1===f._process&&f.UN())},qN:function(a,b,c){0===this._process&&1===c&&this.VN(this.GN.WN(0).PN)},tN:function(a,b,c){var d,e,g,h,i,j,k,l=this;if(0!==l.FN&&l.GN.XN(a)){if(1===l._process&&1===l.GN.MN()){if(d=l.YN(),!l.ZN(1)&&!l.ZN(2)&&!d)return;if(e=l.GN.$N(a).PN,Ea(b,e))return;g=T(b.X-e.X),h=T(b.Y-e.Y),l._N(g,h)}if(!(c-l.RN<f)){if(l.GN.$N(a).aO=b,i=l.GN.MN(),i>1)for(j=0;j<i;j++)if(k=l.GN.WN(j),!k.aO)return;for(l.bO(c),l.RN=c,i=l.GN.MN(),j=0;j<i;j++)k=l.GN.WN(j),k.ON=k.aO,k.aO=R}}},wN:function(){var a=this;a.cO&&(a.dO(a.cO),a.cO=R)},vN:function(a){var b=this;b.GN.XN(a)&&(b.GN.eO(a),2===b._process?0===b.GN.MN()&&(b.ZN(64)||b.ZN(256)||b.ZN(128)?b.fO():b.JN(!0)):2===b._process||3===b._process?b.JN(!0):1===b._process&&b.JN(!1))},bO:function(a){var b,c,d,e,f,g=this,h=g.gO(),i=h.hO,j=h.iO,k=h.SH,l=g.jO(),m=l.kO,n=l.eb,o=l.lO;if(g.AN+=i,g.BN+=j,g.CN*=n,g.DN+=m,g.EN+=o,b={},b.lO=o,b.kO=m,b.mO=a-g.RN,b.hO=i,b.iO=j,g.IN.nO(b),g.oO=k,1===g._process||2===g._process){if(1===g._process&&(c=g.UN()))return;if(d=new _a,d.pO=o,d.qO=m,d.rO=n,d.sO=new Ua(i,j),e=new Xa(g.IN),f=new db(g.NN,g.tO(),d,(!1),k,e),g.uO(f),f.vO)return void g.JN(!0)}},UN:function(){var a,b=this;return b._process=2,a=new fb(b.NN,b.GN.MN(),b.tO(),b.GN.WN(0).PN),b.wO(a),!!a.vO&&(b.JN(!0),!0)},_N:function(a,b){var c=Ra(a,b);this.SN=c.yN,this.TN=c.zN},gO:function(){var a=0,b=0,c=this.xO(),d=c.yO,e=c.zO,f=new Ua(d.X,d.Y);return a=d.X-e.X,b=d.Y-e.Y,{hO:a,iO:b,SH:f}},jO:function(){var a,b=this,c=0,d=1,e=0;return b.ZN(16)&&1===b.GN.MN()&&b.YN()&&(c=Pa(b.GN.WN(0).aO,b.GN.WN(0).ON,b.AO)),b.GN.MN()>1&&(a=b.BO(),c=a.kO,d=a.eb,e=a.lO),c=c/Y*180,{kO:c,eb:d,lO:e}},BO:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.xO(),n=m.yO,o=m.zO,p=l.YN(),q=p?l.AO._Center:new Ua(0,0),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=l.GN.MN();for(a=0;a<y;a++)b=l.GN.WN(a),c=b.aO,d=b.ON,e=Oa(c,n),f=Oa(d,o),g=p?new Ua(d.X-q.X,d.Y-q.Y):new Ua(d.X-o.X,d.Y-o.Y),h=p?new Ua(c.X-q.X,c.Y-q.Y):new Ua(c.X-n.X,c.Y-n.Y),i=Oa(d,q),j=Oa(c,q),f>=l.HN&&e>=l.HN&&(v++,w+=e,x+=f,(!p||i>=l.HN)&&j>=l.HN&&(k=Na(g,h),r+=k,u++));return u>0&&l.ZN(16)?r/=u:r=0,v>0&&l.ZN(32)?(l.KN||(s=w/x),t=(w-x)/v,l.CO=w/v):l.CO=0,{kO:r,eb:s,lO:t}},ZN:function(a){return 0!==(this.FN&a)},xO:function(){var a,b,c,d,e,f,g=0,h=0,i=0,j=0,k=this.GN,l=k.MN();for(a=0;a<l;a++)b=k.WN(a),c=b.ON,d=b.aO,g+=c.X,h+=c.Y,i+=d.X,j+=d.Y;return e=new Ua(g/l,h/l),f=new Ua(i/l,j/l),{yO:f,zO:e}},YN:function(){var a=this.AO;return a&&!pa(a._Radius)},VN:function(a){var b=this,c=new gb(b.NN,b.FN,R,a);return c.DO=511,b.EO(c),b.FO=c.DO,0===c.DO?(b.JN(!1),!1):(b.FN=c.DO,b.AO=c.GO,b._process=1,!0)},JN:function(a){var b,c=this,d=3===c._process;c._process=0,c.HO&&(Ca(c.HO),c.HO=R),a&&(b=new cb(c.NN,c.tO(),d,Va(c.oO),new Xa(c.IN)),3===c._process?c.cO=b:c.dO(b)),c.IN.IO(),c.GN.IO(),c.AO=R,c.AN=0,c.BN=0,c.CN=1,c.DN=0,c.EN=0,c.SN=!1,c.TN=!1,c.FN=0},fO:function(){var a,b,c=this,d={},e=new Xa(c.IN);return d.JO=c.ZN(64)?e.KO().X:0,d.LO=c.ZN(64)?e.KO().Y:0,d.MO=c.ZN(256)?e.pO():0,d.NO=c.ZN(128)?e.OO():0,0===d.JO&&0===d.LO&&0===d.MO&&0===d.NO?void c.JN(!0):(d.PO=new $a(d.JO,d.LO),d.QO=new Ya(d.MO),d.RO=new Za(d.NO),e=new Xa(R,d.JO,d.LO,d.NO,d.MO),a=new eb(c.NN,c.tO(),new _a,e,d.QO,d.RO,d.PO),c.SO(a),d.PO=a.TO,d.QO=a.QO,d.RO=a.RO,d.PO.UO<=0&&d.PO.VO<=0&&d.PO.WO(.003),d.QO.XO()<=0&&d.QO.WO(.002),d.RO.XO()<=0&&d.RO.WO(.003),b=Da(),d.YO=b,d.ZO=b,d.$O=0,d._O=0,c._process=3,void(c.HO=setInterval(function(){try{c.aP(d)}catch(a){}},20)))},aP:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=Da(),q=p-a.ZO;if(0!==q){if(b=a.JO,c=a.LO,d=a.MO,e=a.NO,a.JO=o.bP(q,a.PO.UO,a.JO),a.LO=o.bP(q,a.PO.VO,a.LO),a.MO=o.bP(q,a.QO.XO(),a.MO),a.NO=o.bP(q,a.RO.XO(),a.NO),b=(b+a.JO)/2,c=(c+a.LO)/2,d=(d+a.MO)/2,e=(e+a.NO)/2,a.ZO=p,f=!1,Qa(b)&&Qa(c)&&Qa(d)&&Qa(e)&&(f=!0),g=q*b,h=q*c,i=q*d,j=q*e,k=1,o.CO>0&&(o.CO+2*i<0&&(i=-o.CO/2+1),0!==o.CO&&(k=(o.CO+2*i)/o.CO)),o.EN+=i,o.DN+=j,o.AN+=g,o.BN+=h,o.CN*=k,o.CO+=i,o.oO=new Ua(o.oO.X+g,o.oO.Y+h),a.$O+=g,a._O+=h,f){if(g=Z(a.$O),h=Z(a._O),Qa(g)&&Qa(h))return void o.JN(!0)}else T(a.$O)>=1&&(g=a.$O,a.$O-=g),T(a._O)>=1&&(h=a._O,a._O-=h);return l=new _a,l.sO=new Ua(g,h),l.rO=k,l.pO=i,l.qO=j,m=new Xa(R,a.JO,a.LO,a.NO,a.MO),n=new db(o.NN,o.tO(),l,(!0),Va(o.oO),m),o.uO(n),n.vO?void o.JN(!0):void(f&&o.JN(!0))}},bP:function(a,b,c){if(Qa(c))return 0;var d;return d=c<0?c+b*a:c-b*a,(d<0&&c>0||d>0&&c<0)&&(d=0),d},tO:function(){var a=this,b=new _a;return b.pO=a.EN,b.qO=a.DN,b.rO=a.CN,b.sO=new Ua(a.AN,a.BN),b},cP:function(a,b,c,d){var e,f=this,g=new _a,h=new _a,i=0,j=0,k=0,l=0,m=f.ZN(4)&&f.SN,n=f.ZN(8)&&f.TN;return!f.ZN(1)||n||a&&!f.ZN(64)||(g.sO.X=b.sO.X,h.sO.X=c.sO.X,i=d.KO().X),!f.ZN(2)||m||a&&!f.ZN(64)||(g.sO.Y=b.sO.Y,h.sO.Y=c.sO.Y,j=d.KO().Y),!f.ZN(32)||a&&!f.ZN(256)?(g.rO=b.rO,h.rO=1):(g.rO=b.rO,g.pO=b.pO,h.rO=c.rO,h.pO=c.pO,l=d.pO()),!f.ZN(16)||a&&!f.ZN(128)||(g.qO=b.qO,h.qO=c.qO,k=d.OO()),e=new Xa(R,i,j,k,l),new bb(g,h,e)},EO:function(a){this.vM&&a&&this.vM(a)},wO:function(a){this.wM&&a&&this.wM(a)},dO:function(a){var b,c=this;c.xM&&a&&(b=c.cP(!1,a.dP,a.dP,a.eP),a.dP=b.dP,a.eP=b.eP,c.xM(a))},SO:function(a){var b,c=this;c.AM&&a&&(b=c.cP(!1,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.AM(a))},uO:function(a){var b,c=this;c.BM&&a&&(b=c.cP(a.gP,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.BM(a))}});function Ta(){}A(Ta.prototype,{qN:function(a){var b,c=this;c._pointerCount++,c._pointerCount>1||(b=Da(),c.hP&&Ea(a,c.hP)&&b-c.iP<d?c.Jb++:(c.hP=a,c.Jb=1),c.jP=a,c.iP=b)},wN:function(){var a=this;a.cO&&(a.cO instanceof hb?a.kP(a.cO):a.cO instanceof ib&&a.lP(a.cO),a.cO=R)},vN:function(a){var b,c=this;c._pointerCount--,c._pointerCount>0||(b=Da(),Ea(a,c.jP)?b-c.iP>e?c.cO=new ib(c.jP):c.Jb>1?(c.Jb=0,c.mP(new jb(c.hP)),c.hP=R):c.cO=new hb(c.jP):c.hP=R)},nP:function(){this.hP=R},kP:function(a){this.CM&&a&&this.CM(a)},mP:function(a){this.DM&&a&&this.DM(a)},lP:function(a){this.EM&&a&&this.EM(a)}});function Ua(a,b){this.X=a,this.Y=b}function Va(a){return new Ua(a?Z(a.X):-1,a?Z(a.Y):-1)}u.oP=Ua;function Wa(){var a=this;a.Jb=0,a.oI=0,a.pP=10,a.qP=[]}A(Wa.prototype,{rP:function(a){var b,c,d,e,f,g,h=this;if(0===h.Jb)return 0;for(b=0,c=(1+h.Jb)*h.Jb/2,d=h.Jb-1;d>=0;d--)e=0,f=h.sP(d),0===a?e=f.hO:1===a?e=f.iO:2===a?e=f.lO:3===a&&(e=f.kO),g=h.tP(e,f.mO),g*=d+1,b+=g;return b/c},tP:function(a,b){return a/b},sP:function(a){return this.qP[this.uP(a)]},vP:function(){return this.qP[this.Jb-1]},nO:function(a){var b,c,d=this;for(10===d.Jb&&d.wP(),d.Jb++,d.qP[d.uP(d.Jb-1)]=a,b=f*d.pP,c=0;c<d.Jb;c++)a.mO-d.qP[c].mO>b&&(d.wP(),c--)},wP:function(){var a=this;a.oI++,a.oI===a.pP&&(a.oI=0),a.Jb--},IO:function(){this.Jb=0},uP:function(a){return(this.oI+a)%this.pP}});function Xa(a,b,c,d,e){var f=this;a?f.qP=a:(f.xP=new Ua(b,c),f.yP=d,f.lO=e)}A(Xa.prototype,{KO:function(){var a=this;return a.xP||(a.xP=new Ua(a.qP.rP(0),a.qP.rP(1))),a.xP},OO:function(){var a=this;return x(a.yP)&&(a.yP=a.qP.rP(3)),a.yP},pO:function(){var a=this;return x(a.lO)&&(a.lO=a.qP.rP(2)),a.lO}});function Ya(a){this.zP=a,this.AP=0}A(Ya.prototype,{XO:function(){var a=this,b=a._DesiredExpansion,c=a._DesiredDeceleration,d=a.zP;return pa(b)||0===b?pa(c)?a.AP:c:.5*d*d/b},WO:function(a){this.AP=a}});function Za(a){this.zP=a,this.AP=0}A(Za.prototype,{XO:function(){var a=this,b=a._DesiredRotation,c=a._DesiredDeceleration,d=a.zP;return pa(b)||0===b?pa(c)?a.AP:c:.5*d*d/b},WO:function(a){this.AP=a}});function $a(a,b){var c=this;c.BP=a,c.CP=b,c.UO=0,c.VO=0,c.AP=0,c.DP=$(a*a+b*b)}A($a.prototype,{EP:function(){var a=this,b=a._DesiredDisplacement,c=a.DP,d=a.BP,e=a.CP,f=a.XO();pa(b)||0===b?pa(f)||0===f?(a.UO=0,a.VO=0):(a.UO=f*T(d)/c,a.VO=f*T(e)/c):(a.UO=.5*c*T(d)/b,a.VO=.5*c*T(e)/b)},XO:function(){var a=this,b=a._DesiredDeceleration;return pa(b)&&pa(a._DesiredDisplacement)?a.AP:b},WO:function(a){this.AP=a,this.EP()}});function _a(){var a=this;a.sO=new Ua(0,0),a.rO=0,a.qO=0,a.pO=0}function ab(){this.FP=[]}A(ab.prototype,{XN:function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return!0;return!1},QN:function(a){this.FP.push(a)},eO:function(a){var b,c=this.FP;for(b=0;b<c.length;b++)if(c[b].Np===a){c.splice(b,1);break}},MN:function(){return this.FP.length},WN:function(a){return this.FP[a]},$N:function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return c;return R},IO:function(){var a=this.FP;a.splice(0,a.length)}});function bb(a,b,c){var d=this;d.dP=a,d.fP=b,d.eP=c}function cb(a,b,c,d,e){var f=this;f.GP=a,f.dP=b,f.gP=c,f.rN=d,f.eP=e}function db(a,b,c,d,e,f){var g=this;g.GP=a,g.dP=b,g.fP=c,g.gP=d,g.rN=e,g.eP=f}function eb(a,b,c,d,e,f,g){var h=this;h.GP=a,h.dP=b,h.fP=c,h.eP=d,h.QO=e,h.RO=f,h.TO=g}function fb(a,b,c,d){var e=this;e.GP=a,e.HP=b,e.dP=c,e.rN=d}function gb(a,b,c,d){var e=this;e.GP=a,e.DO=b,e.GO=c,e.rN=d}function hb(a){this.rN=a}function ib(a){this.rN=a}function jb(a){this.rN=a}function kb(a,b){var c=a*b;return c>4?c=4:c<.5&&(c=.5),c}function lb(a){this.kj=a}A(lb.prototype,{IP:function(a,b){var c=this.Xs;return c?a===I.Nn(c)&&b===I.On(c)||I.Pn(c,a,b):(c=E("canvas"),I.Kn(c,R,this.kj),I.Pn(c,a,b)),c},JP:function(a,b,c,d){var e=this,f=I.Nn(a),g=I.On(a),h=e.IP(f,g),i=h.getContext("2d"),j=I.Ln(h),k=I.Mn(h);ya.Cn(i,1,1),i.drawImage(a,0,0,Ba(h),Aa(h),0,0,Ba(h),Aa(h)),ya.Cn(i,j,k),e.Xs=h,e.KP=b,e.LP=c,e.MP=d},NP:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=I.Nn(a),q=I.On(a),r=Ha(o),s=Ia(o),t=r>0?1:0,u=s>0?1:0,v=n.LP,w=o.Gt&&o.Gt()||{x:0,y:0,width:0,height:0},x=n.KP,y=o.am(),z=b/n.MP,A=a.getContext("2d"),B=I.Ln(a),C=I.Mn(a),D=n.Xs;A.save(),A.fillStyle=c,A.fillRect(0,0,p,q),l=o.rowOutlines,m=o.columnOutlines,l&&l.jp(o,A,R,!0),m&&m.jp(o,A,R,!1),d=v.x+Ba(v),e=v.y+Aa(v),f=x.lt-d-t,g=x.ot-e-u,h=w.x+Ba(w),i=w.y+Aa(w),j=f*z,k=g*z,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,ya.Cn(A,1,1),A.drawImage(D,d,e,f,g,h,i,j,k),r>0&&(d=x.lt-t,e=v.y+Aa(v),f=x.js+t,g=x.ot-e-u,h=y.lt-t,i=w.y+Aa(w),j=y.js+t,k=g*z,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),s>0&&(d=v.x+Ba(v),e=x.ot-u,f=x.lt-d-t,g=x.gs+u,h=w.x+Ba(w),i=y.ot-u,j=f*z,k=y.gs+u,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),r>0&&s>0&&(d=x.lt-t,e=x.ot-u,f=x.js+t,g=x.gs+u,h=y.lt-t,i=y.ot-u,j=y.js+t,k=y.gs+u,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),ya.Cn(A,B,C),A.restore()},OP:function(){var a=this,b=a.kj,c=b._zoomFactor,d=b.yl.vI();d&&a.JP(d.canvas,b.am(),b.Gt&&b.Gt()||{x:0,y:0,width:0,height:0},c)},PP:function(a){var b,c,d,e=this,f=e.kj;f.endEdit()&&(b=kb(a,e.MP),f._zoomFactor!==b&&(f.Wq(K.UserZooming,{sheet:f,sheetName:f.Cj,oldZoomFactor:f._zoomFactor,newZoomFactor:b}),f._zoomFactor=b,f.invalidateLayout(),c=f.yl,d=c.bm(),d&&e.NP(d.canvas,b,c.zI(!1)),f.QP&&f.QP(R,b),f.RP&&f.RP(R)))},SP:function(a){var b=this,c=b.kj;c._zoomFactor=kb(a,b.MP),c.oq=!0,c.jq=!0,c.$p()}}),u.TP=lb,g=200,h=20;function mb(a,b,c){var d=c,e=0,f=0,g=a.ss,h,i,j=a.am().qt,k=a.jt(1).findRow(d);if(k)if(b>0){for(h=a.Rt(-1),e=j-k.y;d>h&&e<b;)d--,e+=g.Sl(d);f=b-e}else if(b<0){for(i=a.ns(),e=-(k.y+Aa(k)-j);d<i&&e>b;)d++,e-=g.Sl(d);f=b-e}return{cj:d,UP:f}}function nb(a,b,c){var d=c,e=0,f=0,g,h,i=a.ss,j=a.am().pt,k=a.it(1).findCol(d);if(k)if(b>0){for(g=a.Ot(-1),e=j-k.x;d>g&&e<b;)d--,e+=i._m(d);f=b-e}else if(b<0){for(h=a.ps(),e=-(k.x+Ba(k)-j);d<h&&e>b;)d++,e-=i._m(d);f=b-e}return{dj:d,UP:f}}function ob(a,b){return qa(-b/(a/b+1)+b)}function pb(a,b){return qa(b*(-b/(a-b)-1))}function qb(a,b,c,d,e,f){a.fillStyle=b,a.fillRect(c,d,e,f)}function rb(a,b,c,d,e){var f,g,h,i,j,k=F.Km(0,"gc-columnHeader-normal"),l=k&&k.backgroundImage,m=k&&k.backgroundColor;if(l&&l.indexOf("linear-gradient")!==-1)for(g=D.wl(l),f=a.createLinearGradient(b+d/2,c,b+d/2,c+e),h=0,i=g.length;h<i;h++)j=g[h],f.addColorStop(j.point,j.color);else m&&(f=m);return f}function sb(){var a=F.Km(0,"gc-rowHeader-normal");return a&&a.backgroundColor}function tb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.am(),q=a.yl,r=q.zI(!1),s=q.bm(),t=q.vI(),u=a.jt(1),v=p.zr,w=Ba(p),x=a.Rt(-1),y=u.findRow(x);y&&(c=p.qt,d=y.y-c-1,d>0&&(b?(e=p.Br,f=sb(s,v,c,e-1,d+1),qb(s,f,v,c,e-1,d+1),qb(t,f,v,c,e-1,d+1),qb(s,r,v+e,c,w-e,d),qb(t,r,v+e,c,w-e,d)):(qb(s,r,v,c,w,d),qb(t,r,v,c,w,d)))),g=a.Rt(Ka(a),!0),h=u.findRow(g),h&&(c=h.y+Aa(h),d=p.ot-c-1,d>0&&(qb(s,r,v,c,w,d),qb(t,r,v,c,w,d))),i=a.it(1),c=p.Ar,d=Aa(p),j=a.Ot(-1),k=i.findCol(j),k&&(v=p.pt,w=k.x-v-1,w>0&&(b?(l=p.Cr,m=rb(s,v,c,w+1,l-1),qb(s,m,v,c,w+1,l-1),qb(t,m,v,c,w+1,l-1),qb(s,r,v,c+l,w,d-l),qb(t,r,v,c+l,w,d-l)):(qb(s,r,v,c,w,d),qb(t,r,v,c,w,d)))),n=a.Ot(Ja(a),!0),o=i.findCol(n),o&&(v=o.x+Ba(o),w=p.lt-v-1,w>0&&(qb(s,r,v,c,w,d),qb(t,r,v,c,w,d)))}function ub(a,b,c,d,e,f){a.beginPath(),a.strokeStyle=b,a.moveTo(c,d),a.lineTo(e,f),a.stroke()}function vb(a,b){var c,d,e,f,g,h=a.am(),i=a.yl,j=a.options.gridline.color,k=F.Km(0,"gc-columnHeader-normal"),l=k&&k.borderBottomColor,m=i.bm(),n=a.jt(1),o=h.zr,p=Ba(h),q=a.Rt(-1),r=n.findRow(q);r&&(c=h.qt,d=r.y-c,d>0&&(ub(m,j,o,r.y-.5,o+p,r.y-.5),b&&ub(m,l,h.kt-.5,c,h.kt-.5,r.y))),e=a.it(1),c=h.Ar,d=Aa(h),f=a.Ot(-1),g=e.findCol(f),g&&(o=h.pt,p=g.x-o,p>0&&(ub(m,j,g.x-.5,c,g.x-.5,c+d),b&&ub(m,l,o,h.nt-.5,g.x,h.nt-.5)))}function wb(a,b){var c=0;return a||(c|=1),b||(c|=2),c}function xb(a){this.kj=a}A(xb.prototype,{VP:function(a){function b(a,b){for(var c,d=new M,e=a.ss,f=a.am(),g=V(a.frozenColumnCount(),a.qq),h=Ja(a)-Ha(a),i=f.pt+b,j=f.er-b;j>0&&g<h;g++)c=e._m(g),d.push(new L((-1),g,i,(-1),c,(-1))),i+=c,j-=c;return d}var c=this.kj,d=c.bs;d.viewport||(d.viewport={}),d.viewport[1]=b(c,a)},WP:function(a){function b(a,b){for(var c,d=new M,e=a.ss,f=a.am(),g=V(a.frozenRowCount(),a.lq),h=Ka(a)-Ia(a),i=f.qt+b,j=f.jr-b;j>0&&g<h;g++)c=e.Sl(g),d.push(new L(g,(-1),(-1),i,(-1),c)),i+=c,j-=c;return d}var c=this.kj,d=c.as;d.viewport||(d.viewport={}),d.viewport[1]=b(c,a)},XP:function(){var a=this.kj,b=a.bs.viewport,c=a.as.viewport;a.invalidateLayout(),a.bs.viewport=b,a.as.viewport=c},ju:function(a,b,c,d){var e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=v.kj,x=w.lq,y=mb(w,a,x),z=y.cj,A=y.UP;if(w.lq=z,w.Xq>0)return!1;if(e=w.Dr(),f=w.am(),i=f.qt,j=f.jr,k=e?e.x:f.x,l=Ba(f),a<0)v.YP=0,v.ZP=0,r=w.jt(1),r&&r.length>0&&(p=r.findRow(z)),p&&(q=r[r.length-1],q.row>=z&&(m=2,n=i+T(a),o=U(i+j,q.y+Aa(q))-n,o>=0&&(o-=m,v.WP(A-Aa(p)),c.x=k,c.y=n,c.width=l,c.height=o,c.tx=k,c.ty=i,d.x=k,d.y=i+o,d.width=l,d.height=j-o)));else if(a>0){if(s=w.Rt(-1),z===s&&A>0)if(v.YP>0&&v.ZP>0){if(t=v.YP+a,u=ob(t,g),a=u-v.ZP,A=u,a<=0)return b;if(b&&u>=h)return!0;v.YP=t,v.ZP=u}else{if(A>=g&&(a-=A-(g-1),A=g-1,a<=0))return b;if(t=pb(A,g),u=A,b&&u>=h)return!0;v.YP=t,v.ZP=u}else v.YP=0,v.ZP=0;a<j&&(m=2,n=i,o=j-a,Ia(w)>0&&(o-=1),v.WP(A),c.x=k,c.y=n,c.width=l,c.height=o,c.tx=k,c.ty=n+a,d.x=k,d.y=n,d.width=l,d.height=a+m)}return!1},lu:function(a,b,c,d){var e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=v.kj,x=w.qq,y=nb(w,a,x),z=y.dj,A=y.UP;if(w.qq=z,w.Xq>0)return!1;if(e=w.Dr(),f=w.am(),i=f.pt,j=f.er,k=e?e.y:f.y,l=Aa(f),a<0)v.$P=0,v._P=0,t=w.it(1),t&&t.length>0&&(r=t.findCol(z)),r&&(s=t[t.length-1],s.col>=z&&(m=2,n=i+T(a),o=U(i+j,s.x+Ba(s))-n,o>=0&&(o-=m,v.VP(A-Ba(r)),c.x=n,c.y=k,c.width=o,c.height=l,c.tx=i,c.ty=k,d.x=i+o,d.y=k,d.width=j-o,d.height=l)));else if(a>0){if(u=w.Ot(-1),z===u&&A>0)if(v.$P>0&&v._P>0){if(p=v.$P+a,q=ob(p,g),a=q-v._P,A=q,a<=0)return b;if(b&&q>=h)return!0;v.$P=p,v._P=q}else{if(A>=g&&(a-=A-(g-1),A=g-1,a<=0))return b;if(p=pb(A,g),q=A,b&&q>=h)return!0;v.$P=p,v._P=q}else v.$P=0,v._P=0;a<j&&(m=2,n=i,o=j-a,Ha(w)>0&&(o-=1),v.VP(A),c.x=n,c.y=k,c.width=o,c.height=l,c.tx=n+a,c.ty=k,d.x=n,d.y=k,d.width=a+m,d.height=l)}return!1},aQ:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.kj,t=!0,u=!0,v=s.yl,w=v.bm(),x=0!==(2&c),y=0!==(1&c);if(y||x)return i=s.Dr(),j=s.am(),k=i?i.y:j.y,l=Aa(j),m=i?i.x:j.x,n=Ba(j),x&&(f={},e={},t=r.ju(b,d,e,f),v.Ow(e.x,e.y,Ba(e),Aa(e),e.tx,e.ty)),y&&(g={},h={},u=r.lu(a,d,g,h),v.Ow(g.x,g.y,Ba(g),Aa(g),g.tx,g.ty),x||(e=g,f=h)),o=s.parent,o&&!o.options.scrollbarShowMax&&(y&&(s.oq=!0),x&&(s.jq=!0)),r.XP(),p=s.rowOutlines&&!s.rowOutlines.iT()?1:0,q=s.columnOutlines&&!s.columnOutlines.iT()?1:0,y&&x?v._l(w,new G(f.x,f.y,Ba(f),Aa(f)+p),new G(h.x,h.y,Ba(h)+q,Aa(h))):v._l(w,new G(f.x,f.y,Ba(f)+q,Aa(f)+p)),v.Pw(w,new G(m,k,n,l)),vb(s,!0),tb(s,!0),r.bQ(y,x),t&&u},bQ:function(a,b){var c,d=this.kj;b&&d.os(),a&&d.qs(),d.mm.Qw(),c=d.comments,c&&c.cQ()},dQ:function(a,b,c){function d(a,b,c,d){return a/=c,W(.75,a)*d*(b?1:-1)}function e(a,b,c){return a=T(a),a/=c,aa(a)/aa(.75)*b}var f=this,h=f.kj,i=g,j=10,k=20,l=100,m=e(a,j,i),n=e(b,j,i),o=a,p=b,q=0,r=0,s=!1,t=!1;f.jI=setInterval(function(){var e,g,u,v,w;return s&&t?(h.ss.jn(),e=h.parent,e&&!e.options.scrollbarShowMax&&(h.oq=!0,h.jq=!0),h.ss.kn(),h.$p(),h.qs(),h.os(),Ca(f.jI),void(f.jI=R)):(m+=k,n+=k,void(m>l&&n>l?(f.aQ(a-q,b-r,wb(s,t),c),s=!0,t=!0):(m>l&&!s&&(f.aQ(a-q,0,1,c),s=!0),n>l&&!t&&(f.aQ(0,b-r,2,c),t=!0),g=d(m,a>0,j,i),u=d(n,b>0,j,i),v=ba(o-g),w=ba(p-u),f.aQ(v,w,wb(s,t),c),o=g,p=u,q+=v,r+=w)))},k)},qG:function(a){var b=this,c=b.kj,d=c.ss;b.jI&&(d.kn(),Ca(b.jI),b.jI=R),b.$P=0,b._P=0,b.YP=0,b.ZP=0,b.eQ=c.lq,b.fQ=c.qq,a&&d.hn()},NG:function(a,b){var c,d,e;function f(a,b){var c=0;return c|=0!==a?1:0,c|=0!==b?2:0}return c=qa(a.X),d=qa(a.Y),e=f(c,d),this.aQ(c,d,e,b)},gQ:function(a){var b,c,d,e,f,g,h,i,j=this,k=j.kj,l=k.am(),m=l.pt,n=l.qt,o=k.lq,p=k.qq,q=k.it(1),r=k.ps();q&&q.length>0&&(b=q.findCol(p),p<r&&b&&b.x+Ba(b)-m<Ba(b)/2&&p++),c=k.jt(1),e=k.ns(),c&&c.length>0&&(d=c.findRow(o),o<e&&d&&d.y+Aa(d)-n<Aa(d)/2&&o++),f=0,g=0,q&&q.length>0&&(b=q.findCol(p),f=m-b.x),c&&c.length>0&&(d=c.findRow(o),g=n-d.y),h=j.eQ,o!==h&&k.mq(o),i=j.fQ,p!==i&&k.rq(p),j.dQ(f,g,a)}});function yb(a,b,c,d,e){var f,g,h,i,j,k=a.parent,l=a.mm,m=a.options,n=b.rowViewportIndex,o=b.colViewportIndex,p=Ga(a),q=R;return a.CH&&p.length>0&&(f=p[p.length-1],g=f.row,h=f.row+f.rowCount-1,i=f.col,j=f.col+f.colCount-1,k&&!k.options.allowUserResize||(g!==-1&&i===-1&&n>=0&&o<0&&m.rowHeaderVisible?(q=l.mH(a,b,e,2,d),!q||"sizeRow"!==q.action&&"sizeHiddenRow"!==q.action||2!==q.sheetArea||q.index===h||(q=R)):g===-1&&i!==-1&&n<0&&o>=0&&m.colHeaderVisible&&(q=l.oH(a,b,e,1,c),!q||"sizeCol"!==q.action&&"sizeHiddenCol"!==q.action||1!==q.sheetArea||q.index===j||(q=R)))),q}function zb(a,b,c,d){var e,f,g,h,i,j=b.hitTestType,k=Tb(a),l=Ga(a),m=3;for(a.CH&&l.length>0&&(e=l[l.length-1],e.row!==-1&&e.col!==-1?m=3:e.row!==-1?m=2:e.col!==-1&&(m=1)),f=0;f<k.length;f++)if(g=k[f],g&&(g.x-=Ba(g),g.y-=Aa(g),g.width*=3,g.height*=3,g.contains(c,d)))return x(b.row)&&(h=a.jt(1),h&&h.length>0&&(b.row=h[h.length-1].row)),x(b.col)&&(i=a.it(1),i&&i.length>0&&(b.col=i[i.length-1].col)),{x:c,y:d,type:m,isHeader:!1,isFirstIndicator:0===f};return 1===j?{x:c,y:d,type:1,isHeader:!0}:2===j?{x:c,y:d,type:2,isHeader:!0}:R}function Ab(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=R,r=b.rowViewportIndex,s=b.colViewportIndex;if(x(r)||x(s))return q;if(e=a.parent,f=a.Ix(),r>=0&&s>=0&&1===a.Uq.length){if(g=a.Tq(f),h=Ha(a),i=Ia(a),j=Ja(a)-h,k=Ka(a)-i,1===s&&h>0&&g.col<j&&g.col+g.colCount>j&&(l=a.Hr(s),l&&l.length>0&&(m=l[l.length-1],c>m.x+Ba(m))))return q;if(1===r&&i>0&&g.row<k&&g.row+g.rowCount>k&&(n=a.Gr(r),n&&n.length>0&&(o=n[n.length-1],d>o.y+Aa(o))))return q}return p=Qb(a),p&&(q||(p.x-=Ba(p),p.y-=Aa(p),p.width*=3,p.height*=3,p.contains(c,d)&&(q={action:"drag",side:"corner"})),e&&e.options.allowUserDragFill||q&&"corner"===q.side&&(q.side=R)),q}function Bb(a,b,c,d){var e,f,g,h,i,j,k,l,m=!1,n=a.Uq;for(e=0,f=n.length;e<f;e++){if(g=n[e],h=3===d||x(d),h&&(g=a.Tq(g)),i=g.row,j=g.col,k=g.rowCount,l=g.colCount,h)g=a.Tq(g),m=i<=b&&b<i+k&&j<=c&&c<j+l;else if(2===d)m=j===-1&&i<=b&&b<i+k;else if(1===d)m=i===-1&&j<=c&&c<j+l;else if(0===d)return m;if(m)break}return m}function Cb(a,b,c,d){if(!b){var e=Ga(a),f=e[e.length-1];c?3===d?(a.Jl=f.row+f.rowCount-1,a.Kl=f.col+f.colCount-1):2===d?(a.Jl=f.row+f.rowCount-1,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col+f.colCount-1):3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col)}}function Db(a,b,c,d){var e=Ga(a),f=e[e.length-1];(b||c)&&(3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col))}function Eb(a){var b=this;b.KN=!1,b.hQ=new lb(a),b.iQ=new xb(a),b.kj=a}A(Eb.prototype,{jQ:function(a){var b=this,c=b.kj,d=c.am(),e=d.pt,f=d.qt,g=d.lt,h=d.ot,i=a.rN,j=0,k=b.kQ(i.X,i.Y),l=k.dragInfo,m=k.x,n=k.y;k&&(k.resizeInfo||l&&"corner"===l.side||k.selectionHitInfo)?(j|=2,j|=1):(f<=n&&n<h&&(j|=2),e<=m&&m<g&&(j|=1),j|=96,c.parent&&(j|=12)),a.DO=j},lQ:function(a){var b,c,d,e,f=this,g=a.rN,h=f.kj,i=h.parent,j=h.mm,k=h.yl,l=f.kQ(g.X,g.Y),m=l.dragInfo,n=l.selectionHitInfo;if(h.yt=l,l.resizeInfo){if(!h.endEdit())return;j.fG(l)}else if(m&&"corner"===m.side)j.hG&&j.hG(l);else if(n){if(!h.endEdit())return;b=n.isHeader,c=n.isFirstIndicator,d=n.type,b&&j.ZG(l,!0),e=l.hitTestType,l.hitTestType=d,j.bH(l),l.hitTestType=e,Cb(h,b,c,d),h.mQ=!1,k.DH()}else h.nQ&&(h.nQ().oQ=!1),h.mQ=!1,k.DH(),a.HP>1&&i&&i.options.allowUserZoom?(f.KN=!1,f.hQ.OP()):(f.KN=!0,f.iQ.qG(1===a.HP))},pQ:function(a){var b,c,d,e,f=this,g=a.rN,h=f.kj,i=h.mm,j=h.yt,k=g.X,l=g.Y;if(j)if(b=j.dragInfo,c=j.selectionHitInfo,j.resizeInfo)i.$F={e:a,x:k,y:l},i.WG();else if(b&&"corner"===b.side)i.$F={e:a,x:k,y:l},i.CG&&i.CG();else if(c||i.xG){if(c){if(!i.rG||!i.OG)return;if(i.DA===!0)return;d=c.type,i.$F={e:a,x:k,y:l},3===d?i.cH():2===d?i.dH():1===d&&i.eH()}}else f.KN?a.vO=f.iQ.NG(a.fP.sO,a.gP):(e=a.dP.rO,f.hQ.PP(e))},qQ:function(a){var b,c,d,e=this,f=e.kj,g=f.mm;f.mQ=!0,b=f.yt,c=b.selectionHitInfo,b.resizeInfo?g.YG():b.dragInfo&&g.BG?(g.xH&&g.xH(),f.parent.touchToolStrip.rQ()):c||g.xG?(g.hH(),c&&Db(f,c.isHeader,c.isFirstIndicator,c.type),f.yl.im()):(f.nQ&&(f.nQ().oQ=!0),e.KN?e.iQ.gQ(a.gP):(d=a.dP.rO,e.hQ.SP(d)))},sQ:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,y,z,A,B,C=this,D=a.rN,E=C.kj,F=E.parent,G=!1;if(C.tQ(),E.uQ&&E.uQ(),b=E.comments,b&&b.vQ(),c=E.mm,e=C.kQ(D.X,D.Y,!0),f=e.filterButtonHitInfo,g=e.hitTestType,h=e.row,i=e.col,j=e.outlineHitInfo)E.isEditing()||(k=j.what,l=E.rowOutlines,m=E.columnOutlines,"rg"===k||"rgh"===k?l&&l.UL(E,j):"cg"!==k&&"cgh"!==k||m&&m.UL(E,j));else if(E.yt=e,f){if(!E.endEdit())return;n=f.rowFilter,n&&n.openFilterDialog(f)}else if(e.resizeInfo);else if(E.Qs(e.rowViewportIndex<0?-1:h,e.colViewportIndex<0?-1:i)){if(E.wQ&&!c.BG&&F.touchToolStrip.rQ(),o=E.getActiveRowIndex(),p=E.getActiveColumnIndex(),q=e.cellTypeHitInfo){if(r=q.sheetArea,!x(r)&&3!==r||h===o&&i===p)E.yl.DH();else{if(E.suspendPaint(),!E.endEdit())return;if(s={sheet:E,sheetName:E.Cj,row:o,col:p,cancel:!1},E.Wq(K.LeaveCell,s),s&&s.cancel===!0)return;t=E.Uq.toArray(),u=E.zl().get(h,i),v=[J(u.row,u.col,u.rowCount,u.colCount)],E.yu(t,v),w=q.isReservedLocation&&q.isFocusAware,E.Sr(h,i,S,S,w?0:1),y={sheet:E,sheetName:E.Cj,row:h,col:i},E.Wq(K.EnterCell,y),E.Wq(K.FormulatextboxEnterCell,y),E.Au(t),c.cs&&c.cs(h,i),E.resumePaint(),G=!0}z=E.getCellType(q.row,q.col,g),q.sheet||(q.sheet=E),z.processMouseDown(q),z.processMouseUp(q)}if(q&&q.isReservedLocation)return!0;E.Wq(K.CellClick,{sheet:E,sheetName:E.Cj,sheetArea:g,row:e.row,col:e.col});try{if(c.mG=e,E.isEditing()&&o===E.getActiveRowIndex()&&p===E.getActiveColumnIndex()&&!E.endEdit())return}finally{c.mG=R}if(x(h)||x(i))return;3===g&&c.cs&&c.cs(h,i),Bb(E,h,i,g)&&!G?C.xQ=setTimeout(function(){var a={x:e.x,y:e.y,handled:!1},b=F.touchToolStrip;E.Wq(K.TouchToolStripOpening,a),a.handled||b.open(e.x,e.y-ca),C.tQ()},d+20):(A=E.Uq.toArray(),c.ZG(e),B=E.Uq.toArray(),E.yu(A,B),c.hH())}},yQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this,n=m.kj,o=a.rN;if(m.tQ(),d=n.yt,d&&(n.Wq(K.CellDoubleClick,{sheet:n,sheetName:n.Cj,sheetArea:d.hitTestType,row:d.row,col:d.col}),e=d.resizeInfo))if("sizeRow"===e.action||"sizeHiddenRow"===e.action){if(f=[],n.tp(e.index)){for(b=0;b<n.Uq.length;b++)if(c=n.Uq[b],c.col===-1)for(c=n.Tq(c),g=0;g<c.rowCount;g++)f.push({row:c.row+g})}else f.push({row:e.index});n.wu().execute({cmd:"autoFitRow",sheetName:n.name(),rows:f,columnHeader:1===e.sheetArea})}else{if(h=[],n.sp(e.index)){for(b=0;b<n.Uq.length;b++)if(c=n.Uq[b],c.row===-1)for(c=n.Tq(c),i=0;i<c.colCount;i++)h.push({col:c.col+i})}else h.push({col:e.index});n.wu().execute({cmd:"autoFitColumn",sheetName:n.name(),columns:h,rowHeader:2===e.sheetArea})}else j=m.kQ(o.X,o.Y,!0),!(j&&j.row>=0&&j.col>=0&&j.rowViewportIndex>=0&&j.colViewportIndex>=0)||j.resizeInfo||n.options.isProtected&&n.tq(j.row,j.col,"locked")||(n.Tr(),k=n.Er(j.row),l=n.Fr(j.col),n.Kr(j.row,j.col,k,l,!0),n.addSelection(j.row,j.col,1,1),n.mm.dI(!1),n.EF(n.Ws(),j.row,j.col))},zQ:function(a){var b,c,d=this,e=d.kj,f=a.rN,g=d.kQ(f.X,f.Y);e.isEditing()?g.row===e.Jl&&g.col===e.Kl||e.mm.cI(g):(d._target=g,b=d.kQ(f.X,f.Y,!0),b&&(c=b.cellTypeHitInfo)&&c.isEditting||e.mm.cI(b))},AQ:function(){var a,b,c,d,e=this,f=e.kj;f.isEditing()||(a=e._target,b=!0,a&&(c=a.cellTypeHitInfo,c&&c.isReservedLocation?b=!1:(d=f.getCellType(a.row,a.col),d&&d.isEditting()&&(b=!1))),b&&f.mm.dI())},kQ:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kj;return t.am(),d={x:a,y:b,rowViewportIndex:R,colViewportIndex:R,
row:-1,col:-1,resizeInfo:R,hitTestType:R,outlineHitInfo:R,filterButtonHitInfo:R,dragInfo:R,cellTypeHitInfo:R,selectionHitInfo:R},e=t.rowOutlines,f=t.columnOutlines,e&&(g=e.hitTest(t,a,b)),!g&&f&&(g=f.hitTest(t,a,b)),g?d.outlineHitInfo=g:(h=t.nr(b),i=t.or(a),d.rowViewportIndex=h,d.colViewportIndex=i,d.row=t.pr(b,h),d.col=t.qr(a,i),h>=0&&h<=2&&i>=0&&(j=t.rr(h,i,S,d.row,d.col),j&&(d.row=j.row,d.col=j.col)),d.hitTestType=t.sr(h,i),k=yb(t,d,a,b,10),m=t.xr,n=m&&m.hitTest(d,a,b),n||(p=t.tables,q=p&&p.find(d.row,d.col),r=q&&q.xr,n=r&&r.hitTest(d,a,b)),t.wQ&&(l=Ab(t,d,a,b))?d.dragInfo=l:k?d.resizeInfo=k:n?d.filterButtonHitInfo=n:!c&&(o=zb(t,d,a,b))?d.selectionHitInfo=o:d.cellTypeHitInfo=t.yr(d,a,b)),d},tQ:function(){var a=this,b=a.xQ;b&&(clearTimeout(b),a.xQ=R)}});function Fb(a,b,c){var d=this;d.BQ=c,d.yM=new Jb(b),d.CQ=new Eb(b),d.DQ=new Kb(a,"sheet",d.yM,100,10),d.BQ.xN(d.DQ,!0)}A(Fb.prototype,{EQ:function(){var a=this,b=a.CQ,c=a.DQ;c.dN=function(a){return b.jQ(a)},c.eN=function(a){return b.lQ(a)},c.fN=function(a){return b.pQ(a)},c.hN=function(a){return b.qQ(a)},c.iN=function(a){return b.sQ(a)},c.jN=function(a){return b.yQ(a)},c.GM=function(a){return b.zQ(a)},c.IM=function(a){return b.AQ(a)}},FQ:function(){var a=this,b=a.DQ;b&&(a.BQ.xN(b,!1),b.dN=R,b.eN=R,b.fN=R,b.gN=R,b.hN=R,b.iN=R,b.jN=R,b.kN=R,b.GM=R,b.IM=R,a.DQ=R)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}}),i="gc-toolstrip-button",j="gc-toolstrip-text",k="gc-toolstrip-image",l="gc-toolstrip-item",m="gc-touch-sperate-line",n="height",o="width",p="px",q="button",C(Gb,y);function Gb(a,b){var c,d=this;y.call(d,b,D.vl(a.qo)),d.JQ=32,d.KQ=45,d.LQ={},d.MQ=!1,d.OC=a,c=d.yo(),d.NQ=c,c.addClass("gc-toolstrip-default ui-state-default well"),c.appendTo(d.zo()),c.hide(),d.OQ(),d.PQ(),d.QQ()}A(Gb.prototype,{open:function(a,b){var c,d,e,f,g=this,h=Fa(g.OC);if(h&&(H.Zl(R,!0),g.NQ.css({left:a,top:b}),g.Ao(),g.MQ=!0,g.Do(),!B(g.LQ))){c=g.LQ;for(d in c)c.hasOwnProperty(d)&&(e=c[d],f=!e.RQ||e.RQ.call(g),f?z("#"+d).show():z("#"+d).hide())}},add:function(a){var b,c,d,e;a&&(b=this,c=b.LQ,a instanceof Ib?(d=a.name(),d&&(c[d]=a,b.SQ(a.TQ(m,b.KQ+p)))):a instanceof Hb&&(e=a.name(),b.getItem(e)||(c[e]=a,b.SQ(a.TQ(k,b.JQ+p,j,i)))))},getItem:function(a){return this.LQ[a]},getItems:function(){var a,b=this,c=[],d=b.LQ;if(!B(d)){for(a in d)d.hasOwnProperty(a)&&c.push(d[a]);return c}return R},remove:function(a){var b,c=this;return c.getItem(a)?(z("#"+a).parent().remove(),b=c.LQ[a],delete c.LQ[a],b):R},clear:function(){var a=this;a.NQ&&(a.NQ.find("td."+l).remove(),a.LQ={})},close:function(){var a,b,c=this;va.Hm(),c.NQ&&c.NQ.hide(),c.MQ=!1,c.Eo(),a=Fa(c.OC),a&&(a.zt(),b=Ga(a),b.length>0&&!a.wQ&&b[0].row===-1&&b[0].col===-1&&a.Tr())},imageAreaHeight:function(a){var b=this;return 0===arguments.length?b.JQ:(a>0&&(b.JQ=a,b.NQ.find("span."+k).css(n,a+p)),b)},itemHeight:function(a){var b=this,c=b.NQ.find("button."+i);return 0===arguments.length?ra(c.css(n)):(a>0&&c.css(n,a+p),b)},itemWidth:function(a){var b,c,d=this,e=d.NQ.find("button."+i);return 0===arguments.length?ra(e.css(o)):(a>0&&(b="min-width",c=ra(e.css(b)),c>a&&e.css(b,a+p),e.css(o,a+p)),d)},separatorHeight:function(a){var b=this;return 0===arguments.length?b.KQ:(a>0&&(b.KQ=a,b.NQ.find("div."+m).css(n,a+p)),b)},OQ:function(){var a="table",b=this,c=z(E(a)).css({padding:0,display:a}).attr({cellspacing:0,cellpadding:0});b.UQ=z(E("tr")).appendTo(c),c.appendTo(b.NQ)},no:function(){var a=this,b=a.NQ;b&&(a.MQ&&va.Hm(),b.remove(),a.Eo(),b=R)},QQ:function(){var a=this;a.NQ.bind("click",function(b){var c,d,e,f=b.target,g=f.tagName.toLowerCase();g===q?c=f.id:(d=f.parentElement,d&&d.tagName.toLowerCase()===q&&(c=d.id)),e=a.LQ[c],c&&e&&e.VQ.call(a)})},SQ:function(a){this.NQ&&a&&z(E("td")).append(a).appendTo(this.UQ).addClass(l)},PQ:function(){var a,b,c,d,e,f,g;function h(a){for(var b=0,c=a+b;ua.getElementById(c);)b++,c=a+b;return c}a="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA",b={0:wa+a+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+xa,1:wa+a+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+xa,2:wa+a+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:wa+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="},c=this,d=b[0],e=b[1],f=b[2],g=b[3],c.WQ=new Hb(h("wijspread_toolstrip_paste"),za().ToolStrip_PasteText,d,c.XQ),c.YQ=new Hb(h("wijspread_toolstrip_cut"),za().ToolStrip_CutText,e,c.ZQ),c.$Q=new Hb(h("wijspread_toolstrip_copy"),za().ToolStrip_CopyText,f,c._Q),c.aR=new Hb(h("wijspread_toolstrip_autofill"),za().ToolStrip_AutoFillText,g,c.bR,c.cR),c.add(c.WQ),c.add(c.YQ),c.add(c.$Q),c.add(new Ib(c.cR)),c.add(c.aR)},cR:function(){var a,b,c,d=Fa(this.OC);if(!d)return!1;for(a=Ga(d),b=0;b<a.length;b++)if(c=a[b],c.row===-1&&c.col===-1)return!1;return!0},bR:function(){var a,b;this.close(),a=Fa(this.OC),a&&(b=Ga(a).length,b<=1&&(a.wQ=!0,a.yl.im()))},rQ:function(){var a=Fa(this.OC);a&&(a.wQ=!1,a.yl.im())},_Q:function(){var a=Fa(this.OC);a&&(this.dR=a.ux(!0)),this.close()},ZQ:function(){var a=Fa(this.OC);a&&(this.dR=a.sx(!0)),this.close()},XQ:function(){var a=this,b=a.dR,c=Fa(a.OC);c&&(x(b)||c.vx({pasteHtml:b.copyHtml,pasteText:b.copyText})),a.close()},eR:function(){var a=this,b="span."+j;z("#"+a.WQ.Cj).find(b).text(za().ToolStrip_PasteText),z("#"+a.YQ.Cj).find(b).text(za().ToolStrip_CutText),z("#"+a.$Q.Cj).find(b).text(za().ToolStrip_CopyText),z("#"+a.aR.Cj).find(b).text(za().ToolStrip_AutoFillText)}}),u.TouchToolStrip=Gb;function Hb(a,b,c,d,e){this.MC="normal 12px Arial";var f=this;f.Cj=a,f._text=b,f.fR=c,d&&(f.VQ=d),e&&(f.RQ=e)}A(Hb.prototype,{name:function(a){var b=this;return 0===arguments.length?b.Cj:(z("#"+b.Cj).attr("id",a),z("#"+b.Cj+"Text").attr("id",a+"Text"),z("#"+b.Cj+"Image").attr("id",a+"Image"),b.Cj=a,b)},text:function(a){var b=this;return 0===arguments.length?b._text:(b._text=a,z("#"+b.name()+"Text").text(a),b)},font:function(a){var b=this,c=z("#"+b.name()+"Text");return 0===arguments.length?b.MC:(b.MC=a,c.css("font",a),b)},foreColor:function(a){var b=this,c=z("#"+b.name()+"Text");return 0===arguments.length?b._foreColor?b._foreColor:c.css("color"):(c.css("color",a),b)},image:function(a){var b=this;return 0===arguments.length?b.fR:(b.fR=a,z("#"+b.name()+"Image").css("background-image","url("+a+")"),b)},TQ:function(a,b,c,d){var e,f,g,h,i,j,k,l,m;function n(a,b,c){var d,e=E("span"),f=ua.body;return e.className=c,e.style.font=a,e.style.cssFloat="left",e.textContent=b,f.insertBefore(e,R),d=z(e).width(),f.removeChild(e),d}return e=this,f=e.name(),g=e.font(),h=e.text(),i=z(E("span")),i.attr("id",f+"Image"),i.addClass(a),i.css({"background-image":"url("+e.image()+")","background-repeat":"no-repeat",display:"block",height:b,"background-position-x":"50%"}),j=z(E("span")),j.attr("id",f+"Text"),j.addClass(c),j.css("font",g),j.text(h),k=n(g,h,c),l=60,k>l&&(l=k),m=z(E(q)),m.attr("type",q),m.attr("id",f),m.addClass(d+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),m.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:l+p}),m.append(i),m.append(j),m[0]}}),u.TouchToolStripItem=Hb;function Ib(a){function b(){for(var a="separator",b=0,c=a+b;ua.getElementById(c);)b++,c=a+b;return c}this.Cj=b(),a&&(this.RQ=a)}A(Ib.prototype,{name:function(){return this.Cj},TQ:function(a,b){var c=z(E("div"));return c.attr("id",this.name()),c.addClass(a),c.css({width:"1px",height:b,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),c[0]}}),u.TouchToolStripSeparator=Ib;function Jb(a){this.tc=a}A(Jb.prototype,{oN:function(){this.gR=2,this.tc.CH=!0},zM:function(){this.gR=0,this.hR=Da()},nN:function(){return 1===this.gR},uN:function(){return 1===this.gR},sN:function(){return 1===this.gR},GQ:function(){var a=this;if(2===a.gR)return!0;if(a.hR){if(Da()-a.hR<=200)return a.iR++,!0;a.hR=0,a.iR=0,a.gR=1}else a.gR=1;return a.tc.CH=!1,!1},HQ:function(){var a=this;return a.iR?(a.iR--,!0):2===a.gR||(a.gR=0,!1)},IQ:function(){return 2===this.gR}}),u.jR=Jb;function Kb(a,b,c,d,e){var f=this;f.KM=a,f.lN=c,f.OM=b,f.mN=d,f.aN=e}u.kR=Kb;function Lb(){}A(Lb.prototype,{lR:function(a,b){var c,d,e=a,f=e.touches,g=e.targetTouches,h=e.changedTouches;e.isPrimary!==!1&&(f&&f.length>=1&&g&&g.length>=1&&(f[0].clientX!==g[0].clientX||f[0].clientY!==g[0].clientY)||(N(a),c=x(h)?e:h[0],d=ua.createEvent("MouseEvents"),d.initMouseEvent(b,!0,!0,sa,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,R),a.target.dispatchEvent(d)))},NM:function(a){var b,c=a.pointerType;if(!c||c===a[oa]||c===da){if(b=a.data,b.mR)return;b.mR=!0,b.nR=!1,b.lR(a,"mouseover"),b.lR(a,"mousemove"),b.lR(a,"mousedown")}},aB:function(a){var b,c=a.pointerType;if(!c||c===a[oa]||c===da){if(b=a.data,!b.mR)return;b.nR=!0,b.lR(a,"mousemove")}},RM:function(a){var b,c=a.pointerType;if(!c||c===a[oa]||c===da){if(b=a.data,!b.mR)return;b.lR(a,"mouseup"),b.lR(a,"mouseout"),b.nR||b.lR(a,"click"),b.mR=!1}},oR:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=c.charAt(0);"."!==p&&(c="."+c),d=fa+c,e=ga+c,f=ha+c,g=ia+c,h=ja+c,i=ka+c,j=la+c,k=ma+c,l=na+c,m=ta.msPointerEnabled||ta.pointerEnabled,b?m?(n=a.style,x(n.msTouchAction)||(n.msTouchAction=ea),x(n.touchAction)||(n.touchAction=ea),z(a).bind(d,o,o.NM).bind(g,o,o.NM),z(ua).bind(e,o,o.aB).bind(h,o,o.aB).bind(f,o,o.RM).bind(i,o,o.RM)):z(a).bind(j,o,o.NM).bind(k,o,o.aB).bind(l,o,o.RM):m?(z(a).unbind(d).unbind(g),z(ua).unbind(e).unbind(h).unbind(f).unbind(i)):z(a).unbind(j).unbind(k).unbind(l)}}),u.pR=Lb,r="tab",s="newTab";function Mb(a){this.hq=a}A(Mb.prototype,{lQ:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=a.rN,n=l.hq,o=Fa(n.OC);n.FD&&n.GD(o,!1),b="resizeBar",c=n.hitTest(m.X,m.Y),d=c.element,d===b?(n.HD=!0,n.ID=m.X):d!==r&&d!==s&&""!==d||(e=n.Xs,f=I.Nn(e),g=I.On(e),h=l.IP(f,g),i=h.getContext("2d"),j=I.Ln(h),k=I.Mn(h),ya.Cn(i,1,1),i.drawImage(e,0,0,Ba(h),Aa(h),0,0,Ba(h),Aa(h)),ya.Cn(i,j,k),l.Xs=h,l.qR=n.gq,l.rR=n.VC(),l.sR=n.UC(),l.KC=n.TC(),n.SC=!0),l.tR=n.jw(-1),l.uR=n.rD(n.sD())},pQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,y,z,A,B,C,D,E,H=this,J=a.rN.X,K=H.hq;if(K.HD)b=J-K.ID,c=K.OC,d=c.options,e=c.xs.clientWidth,d.tabStripRatio=c.Iv()+b/e,f=K.kw/e,g=1,c.Iv()<f?(d.tabStripRatio=f,K.ID=K.kw):c.Iv()>=g?(d.tabStripRatio=g,K.ID=e):K.ID=J;else{if(h=H.Xs,i=H.qR,!h||x(i))return;j=H.tR,k=H.uR,l=H.KC,m=H.rR,n=H.sR,o=a.dP.sO.X,p=H.vR(o,i),K.gq=p.gq,q=p.Vo,o>0&&i===j&&K.gq===j?q=0:o<0&&i===k&&K.gq===k&&(q=0),o>0&&o>q+l?o=q+l:o<0&&o<q-l&&(o=q-l),0!==o&&(r=K.Xs,s=r.getContext("2d"),t=I.Ln(r),u=I.Mn(r),s.save(),s.clearRect(0,0,I.Nn(r),I.On(r)),v=K.Dr(),K.dD(s,v),y=0,A=Aa(v),o>0?(w=m,B=w+o,z=n-B,z>0&&(ya.Cn(s,1,1),s.drawImage(h,w*t,y,z*t,A*u,B*t,y,z*t,A*u),ya.Cn(s,t,u)),C=o-q,n-m<=o&&(C=0),z=q,w=m,z>0&&(ya.Dn(s,C,0),K.iE(s,new G(w,y,z,A)),ya.Dn(s,-C,0))):o<0&&(B=m,w=B+T(o),z=n-w,z>0&&(ya.Cn(s,1,1),s.drawImage(h,w*t,y,z*t,A*u,B*t,y,z*t,A*u),ya.Cn(s,t,u)),C=o-q,n-m<=T(o)&&(C=0),z=T(q),w=n-z,z>0&&(ya.Dn(s,C,0),K.iE(s,new G(w,y,z,A)),ya.Dn(s,-C,0))),ya.Cn(s,1,1),w=0,z=m,s.drawImage(h,w*t,y,z*t,A*u,w*t,y,z*t,A*u),D=F.Lm(""),E=qa(D.zIndex),E>2007&&(w=n,z=v.x+Ba(v)-K.kw-w,s.drawImage(h,w*t,y,z*t,A*u,w*t,y,z*t,A*u)),w=Ba(v)-K.kw,z=K.kw,s.drawImage(h,w*t,y,z*t,A*u,w*t,y,z*t,A*u),ya.Cn(s,t,u),s.restore())}},qQ:function(){var a=this.hq;a.HD?(a.HD=!1,a.OC.aq()):(a.SC=S,a.repaint())},sQ:function(a){var b,c,d,e,f=this.hq,g=f.OC,h=a.rN,i=Fa(g);f.FD&&f.GD(i,!1),b="navButton",c=f.hitTest(h.X,h.Y),d=c.element,g.mv=!0;try{d===b?f.JD(c.index,!0):d===r?f.KD(c.index,c.position):d===s&&f.MD(c.position)}finally{g.mv=!1,e=Fa(g),e!==i&&(e.CH=!0,e.zt())}},yQ:function(a){return this.hq.cE(a.rN.X,a.rN.Y)},IP:function(a,b){var c=this.Xs;return c?a===I.Nn(c)&&b===I.On(c)||I.Pn(c,a,b):(c=E("canvas"),I.Kn(c,this.hq.OC),I.Pn(c,a,b)),c},vR:function(a,b){var c=this,d=c.hq,e=d.WC,f=c.tR,g=c.uR,h=b,i=0;if(a>0){for(;h>=f&&!(i>a);)i+=e[h],h--;h<f&&(h=f)}else if(a<0&&g!==-1){for(;h<=g&&!(i<a);)i-=e[h],h++;h>g&&(h=g)}return{gq:h,Vo:i}}});function Nb(a,b,c){var d,e,f=this;f.yM=new Jb(f),f.DQ=new Kb(a,"tabStrip",f.yM,1,(-1)),f.BQ=c,f.CQ=new Mb(b),d=f.CQ,e=f.DQ,e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)},e.jN=function(a){return d.yQ(a)}}A(Nb.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function Ob(a,b,c,d){var e=a.vu();e.ko(b)?c.drawImage(e.lo(b),d.x,d.y,Ba(d),Aa(d)):e.fo(b)}function Pb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.am(),q=16,r=Ga(a);a.CH&&r.length>0&&(g=r[r.length-1],h=g.row,i=g.row+g.rowCount-1,j=g.col,k=g.col+g.colCount-1,l=a.parent,m="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",l&&!l.options.allowUserResize||(h!==-1&&j===-1&&a.getRowResizable(i)?(n=a.Er(i),c=wa+m+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",d=a.getCellRect(i,Ja(a,2)-1,n,-1),f=p.fm(n),f.y<=d.y&&d.y+Aa(d)<=f.y+Aa(f)&&(e=new G(p.kt-q,d.y+Aa(d)-q/2,q,q))):h===-1&&j!==-1&&a.getColumnResizable(k)&&(o=a.Fr(k),c=wa+m+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+xa,d=a.getCellRect(Ka(a,1)-1,k,-1,o),f=p.gm(o),f.x<=d.x&&d.x+Ba(d)<=f.x+Ba(f)&&(e=new G(d.x+Ba(d)-q/2,p.nt-q,q,q))),c&&e&&Ob(a,c,b,e)))}function Qb(a){var b,c,d,e,f=R,g=Ga(a),h=g.length;return a.CH&&h>0&&(b=g[h-1],c=a.cm(b),d=17,e=20,f=new G(c.x+Ba(c)-d,c.y+Aa(c),d,e)),f}function Rb(a,b,c){var d=a.Er(b),e=a.Fr(c),f=a.jt(d),g=a.it(e),h=0,i=0,j=0,k=0;return f.length>0&&(h=f[0].row,i=f[f.length-1].row),g.length>0&&(j=g[0].col,k=g[g.length-1].col),J(h,j,i-h+1,k-j+1)}function Sb(a,b,c){var d,e,f,g=a.Er(b),h=a.Fr(c),i=a.am(),j=i.Ft(g,h),k=!1,l=a.it(h),m=c===-1?l[0]:l.findCol(c);return m&&(k=j.x<=m.x&&m.x+Ba(m)<=j.x+Ba(j)),d=!1,e=a.jt(g),f=b===-1?e[0]:e.findRow(b),f&&(d=j.y<=f.y&&f.y+Aa(f)<=j.y+Aa(j)),k&&d}function Tb(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,H,I=Ga(a),J=[];if(a.CH&&I.length>0)for(b=I[I.length-1],c=a.cm(b),d=8,e=a.am(),f=b.row,g=b.row+b.rowCount-1,h=b.col,i=b.col+b.colCount-1,j=Rb(a,f,h),k=Rb(a,g,i),l=j.row,m=k.row+k.rowCount-1,n=j.col,o=k.col+k.colCount-1,r=g===m&&Sb(a,m,-1),s=i===o&&Sb(a,-1,o),b.row!==-1&&b.col!==-1?(n<=h&&h<=o&&l<=f&&f<=m&&(J[0]=new G(c.x-d,c.y-d,2*d,2*d)),(n<=i&&i<o||s)&&(l<=g&&g<m||r)&&(J[1]=new G(c.x+Ba(c)-d,c.y+Aa(c)-d,2*d,2*d))):b.row!==-1?(p=e.Ft(1,0),q=e.Ft(1,1),t=p.x+(Ba(p)+Ba(q))/2-d,u=Ja(a)-1-Ha(a),v=a.it(1),w=v.findCol(u),w&&(x=a.it(0),y=x[0]||v[0],y&&(t=y.x+(w.x+Ba(w)-y.x)/2-d)),l<=f&&f<=m&&(J[0]=new G(t,c.y-d,2*d,2*d)),(l<=g&&g<m||r)&&(J[1]=new G(t,c.y+Aa(c)-d,2*d,2*d))):b.col!==-1&&(p=e.Ft(0,1),q=e.Ft(1,1),z=p.y+(Aa(p)+Aa(q))/2-d,A=Ka(a)-1-Ia(a),B=a.jt(1),C=B.findRow(A),C&&(D=a.jt(0),E=D[0]||B[0],E&&(z=E.y+(C.y+Aa(C)-E.y)/2-d)),n<=h&&h<=o&&(J[0]=new G(c.x-d,z,2*d,2*d)),(n<=i&&i<o||s)&&(J[1]=new G(c.x+Ba(c)-d,z,2*d,2*d))),H=J.length-1;H>=0;H--)F=J[H],(!F||F.x<0||F.y<0)&&(J[H]=R);return J}function Ub(a,b,c){var d,e,f,g,h=a.parent;if(H.Wl(a)||h&&!h.options.hideSelection){if(a.isEditing()||!b)return;if(d=Tb(a),e=d.length,e>0){for(c.save(),c.fillStyle="white",c.strokeStyle=a.getSelectionBorderColor(),g=0;g<e;g++)f=d[g],f&&(c.beginPath(),c.arc(f.x+Ba(f)/2,f.y+Aa(f)/2,Ba(f)/2,0,2*Math.PI,!1),c.fill(),c.stroke());c.restore()}}}function Vb(a,b){var c,d=Qb(a);d&&(c=wa+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+xa,Ob(a,c,b,d))}w.oJ.prototype.DH=function(){var a=this,b=a.kj,c=Ga(b),d=c.length;b.Xq<=0&&d>0&&a.im(c[d-1],S,S,!0)},w.Worksheet.$n(da,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(a){var b=this,c=b.parent,d=c&&c.BQ||new Ma,e=new Fb(a[0],b,d);e.EQ(),b.wR=e},dispose:function(a){var b=this;b.wR&&b.wR.FQ(),a!==!1&&(b.wR=R)},startEdit:function(){this.yl.DH()},paintAdornment:function(a){var b=this,c=a.ctx;b.CH&&(Pb(b,c),b.wQ?Vb(b,c):Ub(b,b.mQ,c))},preProcessMouseDown:function(a){var b=a.e,c=this.wR;(Q||c.GQ(b))&&(N(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;(Q||c.IQ(b))&&(N(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;(Q||c.HQ(b))&&(N(b),a.r=!0)},preProcessMouseDbClick:function(a){(Q||this.CH)&&(a.r=!0)},preProcessMouseOut:function(a){Q&&(a.r=!0)},preProcessMouseWheel:function(a){Q&&(a.r=!0)}}),w.Workbook.$n(da,{init:function(){this.BQ=new Ma},setHost:function(){var a=this;a.touchToolStrip=new Gb(a,a.xv())},dispose:function(){var a=this,b=a.BQ,c=a.touchToolStrip;b&&b.no(),c&&(c.no(),a.touchToolStrip=R)},onCultureChanged:function(){var a=this.touchToolStrip;a&&a.eR()}}),w.DC.$n(da,{setHost:function(){var a=this,b=new Nb(a.Xs,a,a.OC.BQ);b.EQ(),a.wR=b},dispose:function(){var a=this,b=a.wR;b&&(b.FQ(),a.wR=R)},preProcessMouseDown:function(a){var b=this.wR,c=a.e;(Q||b.GQ(c))&&(N(c),a.r=!1)},preProcessMouseMove:function(a){var b=this.wR,c=a.e;(Q||b.IQ(c))&&(N(c),a.r=!1)},preProcessMouseUp:function(a){var b=this.wR,c=a.e;(Q||b.HQ(c))&&(N(c),a.r=!1)},preProcessMouseDbClick:function(a){var b=Fa(this.OC);(Q||b.CH)&&(a.r=!1)},preProcessMouseOut:function(a){Q&&(a.r=!1)}}),t=".gcScrollbar",w.hv.$n(da,{initEvents:function(a){var b=this.xR=new Lb;b.oR(a,!0,t)},dispose:function(a){var b=this.xR;b&&b.oR(a,!1,t)}}),a.exports=u},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports={ToolStrip_PasteText:"Paste",ToolStrip_CutText:"Cut",ToolStrip_CopyText:"Copy",ToolStrip_AutoFillText:"AutoFill"}}]);